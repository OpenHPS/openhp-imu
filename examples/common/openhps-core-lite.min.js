/*! For license information please see openhps-core-lite.min.js.LICENSE.txt */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("OpenHPS",[],e):"object"==typeof exports?exports.OpenHPS=e():(t.OpenHPS=t.OpenHPS||{},t.OpenHPS.core=e())}("undefined"!=typeof self?self:this,(()=>(()=>{var __webpack_modules__={25:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{C:()=>DataSerializer});var events__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(187),events__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(events__WEBPACK_IMPORTED_MODULE_0__),typedjson__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(606),_DataSerializerUtils__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(434),_Deserializer__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(446),_Serializer__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(141);typedjson__WEBPACK_IMPORTED_MODULE_1__.WR.getFromConstructor=function(t){if(!t)return;const e=t.prototype;if(null==e)return;let r;if(Object.prototype.hasOwnProperty.call(e,_DataSerializerUtils__WEBPACK_IMPORTED_MODULE_2__.jL.META_FIELD))r=e[_DataSerializerUtils__WEBPACK_IMPORTED_MODULE_2__.jL.META_FIELD];else{const e=Object.getPrototypeOf(t.prototype);if(!e)return;r=typedjson__WEBPACK_IMPORTED_MODULE_1__.WR.getFromConstructor(e.constructor)}if(!0===(null==r?void 0:r.isExplicitlyMarked))return r;if(typedjson__WEBPACK_IMPORTED_MODULE_1__.WR.doesHandleWithoutAnnotation(t)){const e=new typedjson__WEBPACK_IMPORTED_MODULE_1__.WR(t);return e.isExplicitlyMarked=!0,e}};class DataSerializer{static registerType(t,e){if(DataSerializer.knownTypes.set(t.name,t),e&&(DataSerializer.serializer.setSerializationStrategy(t,(t=>e.serializer(t,{fallback:(t,e)=>DataSerializer.serializer.convertSingleValue(t,e)}))),DataSerializer.deserializer.setDeserializationStrategy(t,(t=>e.deserializer(t,{fallback:(t,e)=>DataSerializer.deserializer.convertSingleValue(t,e,DataSerializer.knownTypes)}))),"Object"!==t.name)){const e=new typedjson__WEBPACK_IMPORTED_MODULE_1__.WR(t);e.isExplicitlyMarked=!0,t.prototype[_DataSerializerUtils__WEBPACK_IMPORTED_MODULE_2__.jL.META_FIELD]=e}DataSerializer.eventEmitter.emit("registerType",t,e)}static getMetadata(t){return _DataSerializerUtils__WEBPACK_IMPORTED_MODULE_2__.jL.getMetadata(t)}static getRootMetadata(t){return _DataSerializerUtils__WEBPACK_IMPORTED_MODULE_2__.jL.getRootMetadata(t)}static findRootMetaInfo(t){return _DataSerializerUtils__WEBPACK_IMPORTED_MODULE_2__.jL.getRootMetadata(t)}static unregisterType(t){DataSerializer.knownTypes.delete(t.name),DataSerializer.eventEmitter.emit("unregisterType",t)}static findTypeByName(t){return DataSerializer.knownTypes.get(t)}static clone(t,e){return DataSerializer.deserialize(DataSerializer.serialize(t),e)}static serialize(t,e={}){var r;if(null==t)return;const i=Object.getPrototypeOf(t).constructor;if(!DataSerializer.findTypeByName(i.name)&&Array.isArray(t))return t.map(DataSerializer.serialize.bind(DataSerializer));return(null!==(r=e.serializer)&&void 0!==r?r:DataSerializer.serializer).convertSingleValue(t,_DataSerializerUtils__WEBPACK_IMPORTED_MODULE_2__.jL.ensureTypeDescriptor(i),void 0,void 0,e)}static deserialize(t,e,r={}){var i;if("object"!=typeof t&&"function"!=typeof t||!t)return t;if(Array.isArray(t))return t.map((t=>DataSerializer.deserialize(t)));const n=null!==(i=r.deserializer)&&void 0!==i?i:DataSerializer.deserializer,s=null!=e?e:n.getTypeResolver()(t,DataSerializer.knownTypes);return n.convertSingleValue(t,_DataSerializerUtils__WEBPACK_IMPORTED_MODULE_2__.jL.ensureTypeDescriptor(s),DataSerializer.knownTypes,void 0,void 0,r)}}DataSerializer.knownTypes=new Map,DataSerializer.serializer=new _Serializer__WEBPACK_IMPORTED_MODULE_3__.e,DataSerializer.deserializer=new _Deserializer__WEBPACK_IMPORTED_MODULE_4__.Z,DataSerializer.eventEmitter=new events__WEBPACK_IMPORTED_MODULE_0__.EventEmitter,(()=>{DataSerializer.registerType(Object,{serializer:t=>Object.assign(Object.assign({},Object.keys(t).map((e=>({[e]:"function"==typeof t[e]?{function:t[e].toString(),__type:"Function"}:DataSerializer.serialize(t[e])}))).reduce(((t,e)=>Object.assign(Object.assign({},t),e)),{})),{__type:"Object"}),deserializer:objectJson=>Object.keys(objectJson).map((key=>"__type"===key?{}:{[key]:"object"==typeof objectJson[key]&&"Function"===objectJson[key].__type?eval(objectJson[key].function):DataSerializer.deserialize(objectJson[key])})).reduce(((t,e)=>Object.assign(Object.assign({},t),e)),{})})})()},434:(t,e,r)=>{"use strict";r.d(e,{eh:()=>TypeDescriptor,h2:()=>ConcreteTypeDescriptor,jL:()=>DataSerializerUtils});var i=r(606);class DataSerializerUtils{static get META_FIELD(){return"__typedJsonJsonObjectMetadataInformation__"}static getOwnMetadata(t){return i.WR.getFromConstructor(t instanceof Function?t:t.constructor)}static getMetadata(t){var e;return null!==(e=DataSerializerUtils.getOwnMetadata(t))&&void 0!==e?e:DataSerializerUtils.getRootMetadata(t)}static createMetadata(t){if(Object.prototype.hasOwnProperty.call(t,this.META_FIELD))return t[this.META_FIELD];const e=new i.WR(t.constructor),r=t[this.META_FIELD];return void 0!==r&&(r.dataMembers.forEach(((t,r)=>{e.dataMembers.set(r,t)})),r.knownTypes.forEach((r=>{r!==t.constructor&&r.prototype instanceof t.constructor&&e.knownTypes.add(r)})),r.knownTypes.add(e.classType),e.typeResolver=r.typeResolver,e.typeHintEmitter=r.typeHintEmitter),Object.defineProperty(t,this.META_FIELD,{enumerable:!1,configurable:!1,writable:!1,value:e}),e}static getRootMetadata(t){const e=t instanceof Function?t.prototype:Object.getPrototypeOf(t);return e&&e[DataSerializerUtils.META_FIELD]?DataSerializerUtils.getRootMetadata(e):t[DataSerializerUtils.META_FIELD]}static ensureTypeDescriptor(t){return t instanceof TypeDescriptor?t:new ConcreteTypeDescriptor(t)}static getMemberOptions(t,e){const r=DataSerializerUtils.getMetadata(t);if(!r)return;const i=r.dataMembers.get(e);return i?i.options:void 0}static getIdentifierMemberOptions(t){const e=DataSerializerUtils.getMetadata(t);if(e)return Array.from(e.dataMembers.values()).filter((t=>t&&t.primaryKey))[0]}}class TypeDescriptor{constructor(t){this.ctor=t}getTypes(){return[this.ctor]}hasFriendlyName(){return"Object"!==this.ctor.name}}class ConcreteTypeDescriptor extends TypeDescriptor{constructor(t){super(t)}}},446:(t,e,r)=>{"use strict";r.d(e,{Z:()=>Deserializer});var i=r(188),n=r(665),s=r(606),o=r(651),a=r(77),c=r(750);class Deserializer extends i.Z{typeResolver(t,e){var r;return void 0!==t.__type?e.get(t.__type):null!==(r=t.constructor)&&void 0!==r?r:Object}constructor(){super(),this.errorHandler=t=>{throw t.message=t.message.replace("@jsonObject","@SerializableObject()"),t.message=t.message.replace("@jsonMember","@SerializableMember()"),t.message=t.message.replace("@jsonSetMember","@SerializableSetMember()"),t.message=t.message.replace("@jsonMapMember","@SerializableMapMember()"),t.message=t.message.replace("@jsonArrayMember","@SerializableArrayMember()"),t},this.setDeserializationStrategy(Map,this.convertAsMap.bind(this)),this.setDeserializationStrategy(Array,this.convertAsArray.bind(this)),this.setDeserializationStrategy(Set,this.convertAsSet.bind(this)),this.setDeserializationStrategy(Uint8Array,c.o.fromHexString)}convertSingleValue(t,e,r,i,n,s){return this._convertSingleValue.bind(this)(t,e,r,i,n,s)}_convertSingleValue(t,e,r,i,n,s){if(this.retrievePreserveNull(n)&&null===t)return null;if(!(0,a.Jf)(t))return;const o=this.deserializationStrategy.get(e.ctor);if(void 0!==o)return o(t,e,r,i,this,n,s);if("object"==typeof t)return this.convertAsObject(t,e,r,i,this,n,s);let c=`Could not deserialize '${i}'; don't know how to deserialize type`;e.hasFriendlyName()&&(c+=` '${e.ctor.name}'`),this.errorHandler(new TypeError(`${c}.`))}convertAsObject(t,e,r,i,c,h,u){if("object"!=typeof t||null===t)return void c.getErrorHandler()(new TypeError(`Cannot deserialize ${i}: 'sourceObject' must be a defined object.`));let l=e.ctor,p=s.WR.getFromConstructor(l),d=c.getTypeResolver();void 0!==p&&null!=p.typeResolver&&(d=p.typeResolver);const y=d(t,r);if(null!=y&&(0,a.me)(y,l)&&(l=y,p=s.WR.getFromConstructor(y)),!0===(null==p?void 0:p.isExplicitlyMarked)){const e=p,s={},h=(0,o.JH)(c.options,e.options);let d;if(e.dataMembers.forEach(((i,l)=>{const p=t[l],d=`${(0,a.$0)(e.classType)}.${l}`,y=(0,o.JH)(h,i.options);let f;if(null!=i.deserializer)f=i.deserializer(p,{fallback:(t,e)=>c.convertSingleValue(t,(0,n._k)(e),r)});else{if(null==i.type)throw new TypeError(`Cannot deserialize ${d} there is no constructor nor deserialization function to use.`);f=c.convertSingleValue(p,i.type(),r,d,y,u)}(0,a.Jf)(f)||c.retrievePreserveNull(y)&&null===f?s[i.key]=f:!0===i.isRequired&&c.getErrorHandler()(new TypeError(`Missing required member '${d}'.`))})),"function"==typeof p.initializerCallback)try{if(d=p.initializerCallback(s,t),null==d)throw new TypeError(`Cannot deserialize ${i}: 'initializer' function returned undefined/null, but '${(0,a.$0)(p.classType)}' was expected.`);if(!(d instanceof p.classType))throw new TypeError(`Cannot deserialize ${i}:'initializer' returned '${(0,a.$0)(d.constructor)}', but '${(0,a.$0)(p.classType)}' was expected, and '${(0,a.$0)(d.constructor)}' is not a subtype of '${(0,a.$0)(p.classType)}'`)}catch(t){return void c.getErrorHandler()(t)}else d=c.instantiateType(l);Object.assign(d,s);const y=p.onDeserializedMethodName;return null!=y&&("function"==typeof d[y]?d[y]():"function"==typeof d.constructor[y]?d.constructor[y]():c.getErrorHandler()(new TypeError(`onDeserialized callback'${(0,a.$0)(p.classType)}.${y}' is not a method.`))),d}{const e={};return Object.keys(t).forEach((i=>{e[i]=c.convertSingleValue(t[i],new n.h2(t[i].constructor),r,i,h,u)})),e}}convertAsArray(t,e,r,i,s,o,a){if(!(e instanceof n.GJ))throw new TypeError(`Could not deserialize ${i} as Array: incorrect TypeDescriptor detected, please use proper annotation or function for this type`);return Array.isArray(t)?null==e.elementType?(s.getErrorHandler()(new TypeError(`Could not deserialize ${i} as Array: missing constructor reference of Array elements.`)),[]):t.map(((t,n)=>{try{return s.convertSingleValue(t,e.elementType,r,`${i}[${n}]`,o,a)}catch(t){return void s.getErrorHandler()(t)}})):(s.getErrorHandler()(new TypeError(this.makeTypeErrorMessage(Array,t.constructor,i))),[])}convertAsSet(t,e,r,i,s,o,a){if(!(e instanceof n.do))throw new TypeError(`Could not deserialize ${i} as Set: incorrect TypeDescriptor detected, please use proper annotation or function for this type`);if(!Array.isArray(t))return s.getErrorHandler()(new TypeError(this.makeTypeErrorMessage(Array,t.constructor,i))),new Set;if(null==e.elementType)return s.getErrorHandler()(new TypeError(`Could not deserialize ${i} as Set: missing constructor reference of Set elements.`)),new Set;const c=new Set;return t.forEach(((t,n)=>{try{c.add(s.convertSingleValue(t,e.elementType,r,`${i}[${n}]`,o,a))}catch(t){s.getErrorHandler()(t)}})),c}convertAsMap(t,e,r,i,s,o,c){if(!(e instanceof n.br))throw new TypeError(`Could not deserialize ${i} as Map: incorrect TypeDescriptor detected,please use proper annotation or function for this type`);const h=e.getCompleteOptions().shape;if(!this.isExpectedMapShape(t,h)){const e=0===h?Array:Object;return s.getErrorHandler()(new TypeError(this.makeTypeErrorMessage(e,t.constructor,i))),new Map}if(null==e.keyType)return s.getErrorHandler()(new TypeError(`Could not deserialize ${i} as Map: missing key constructor.`)),new Map;if(null==e.valueType)return s.getErrorHandler()(new TypeError(`Could not deserialize ${i} as Map: missing value constructor.`)),new Map;const u=`${i}[].key`,l=`${i}[].value`,p=new Map;return"OBJECT"===h.name?Object.keys(t).forEach((i=>{try{const n=s.convertSingleValue(i,e.keyType,r,u,o,c);(0,a.Jf)(n)&&p.set(n,s.convertSingleValue(t[i],e.valueType,r,l,o,c))}catch(t){s.getErrorHandler()(t)}})):t.forEach((t=>{try{const i=s.convertSingleValue(t.key,e.keyType,r,u,o,c);(0,a.Jf)(i)&&p.set(i,s.convertSingleValue(t.value,e.valueType,r,l,o,c))}catch(t){s.getErrorHandler()(t)}})),p}isExpectedMapShape(t,e){return 0===e&&Array.isArray(t)||1===e&&"object"==typeof t}makeTypeErrorMessage(t,e,r){return`Could not deserialize ${r}: expected '${"function"==typeof t?(0,a.$0)(t):t}', got '${"function"==typeof e?(0,a.$0)(e):e}'.`}}},141:(t,e,r)=>{"use strict";r.d(e,{e:()=>Serializer});var i=r(844),n=r(665),s=r(606),o=r(77),a=r(651),c=r(750);class Serializer extends i.e{constructor(){super(),this.errorHandler=t=>{throw t.message=t.message.replace("@jsonObject","@SerializableObject()"),t.message=t.message.replace("@jsonMember","@SerializableMember()"),t.message=t.message.replace("@jsonSetMember","@SerializableSetMember()"),t.message=t.message.replace("@jsonMapMember","@SerializableMapMember()"),t.message=t.message.replace("@jsonArrayMember","@SerializableArrayMember()"),t},this.setSerializationStrategy(Map,this.convertAsMap.bind(this)),this.setSerializationStrategy(Array,this.convertAsArray.bind(this)),this.setSerializationStrategy(Set,this.convertAsSet.bind(this)),this.setSerializationStrategy(Uint8Array,c.o.toHexString)}convertSingleValue(t,e,r,i,n){const s=this._convertSingleValue.bind(this)(t,e,r,i,n);return void 0===r&&"object"==typeof s&&(s.__type=e.ctor.name),s}_convertSingleValue(t,e,r,i,n){if(this.retrievePreserveNull(i)&&null===t)return null;if(!(0,o.Jf)(t))return;if(!(0,o.V9)(t,e.ctor)){const i=(0,o.$0)(e.ctor),n=(0,o.$0)(t.constructor);return void this.errorHandler(new TypeError(`Could not serialize '${r}': expected '${i}', got '${n}'.`))}const s=this.serializationStrategy.get(e.ctor);if(void 0!==s)return s(t,e,r,this,i,n);if("object"==typeof t)return this.convertAsObject(t,e,r,this,i,n);let a=`Could not serialize '${r}'; don't know how to serialize type`;e.hasFriendlyName()&&(a+=` '${e.ctor.name}'`),this.errorHandler(new TypeError(`${a}.`))}convertAsObject(t,e,r,i,c,h){let u,l,p=i.getTypeHintEmitter();if(u=t.constructor!==e.ctor&&t instanceof e.ctor?s.WR.getFromConstructor(t.constructor):s.WR.getFromConstructor(e.ctor),void 0===u)l=Object.assign({},t);else{const e=u.beforeSerializationMethodName;null!=e&&("function"==typeof t[e]?t[e]():"function"==typeof t.constructor[e]?t.constructor[e]():i.getErrorHandler()(new TypeError(`beforeSerialization callback '${(0,o.$0)(u.classType)}.${e}' is not a method.`)));const r=u;l={};const s=(0,a.JH)(i.options,r.options);null!=r.typeHintEmitter&&(p=r.typeHintEmitter),r.dataMembers.forEach((e=>{const c=(0,a.JH)(s,e.options);let u;if(null!=e.serializer)u=e.serializer(t[e.key],{fallback:(t,e)=>i.convertSingleValue(t,(0,n._k)(e))});else{if(null==e.type)throw new TypeError(`Could not serialize ${e.name}, there is no constructor nor serialization function to use.`);u=i.convertSingleValue(t[e.key],e.type(),`${(0,o.$0)(r.classType)}.${e.key}`,c,h)}(i.retrievePreserveNull(c)&&null===u||(0,o.Jf)(u))&&(l[e.name]=u)}))}return p(l,t,e.ctor,u),l}convertAsArray(t,e,r,i,s,a){if(!(e instanceof n.GJ))throw new TypeError(`Could not serialize ${r} as Array: incorrect TypeDescriptor detected, please use proper annotation or function for this type`);if(null==e.elementType)throw new TypeError(`Could not serialize ${r} as Array: missing element type definition.`);return t.forEach(((t,n)=>{if(!(i.retrievePreserveNull(s)&&null===t||(0,o.V9)(t,e.elementType.ctor))){const i=(0,o.$0)(e.elementType.ctor),s=t&&(0,o.$0)(t.constructor);throw new TypeError(`Could not serialize ${r}[${n}]: expected '${i}', got '${s}'.`)}})),t.map(((t,n)=>i.convertSingleValue(t,e.elementType,`${r}[${n}]`,s,a)))}convertAsSet(t,e,r,i,s,a){if(!(e instanceof n.do))throw new TypeError(`Could not serialize ${r} as Set: incorrect TypeDescriptor detected, please use proper annotation or function for this type`);if(null==e.elementType)throw new TypeError(`Could not serialize ${r} as Set: missing element type definition.`);r+="[]";const c=[];return t.forEach((t=>{const n=i.convertSingleValue(t,e.elementType,r,s,a);(0,o.Jf)(t)&&!(0,o.Jf)(n)||c.push(n)})),c}convertAsMap(t,e,r,i,s,a){if(!(e instanceof n.br))throw new TypeError(`Could not serialize ${r} as Map: incorrect TypeDescriptor detected, please use proper annotation or function for this type`);if(null==e.valueType)throw new TypeError(`Could not serialize ${r} as Map: missing value type definition.`);if(null==e.keyType)throw new TypeError(`Could not serialize ${r} as Map: missing key type definition.`);const c=`${r}[].key`,h=`${r}[].value`,u=e.getCompleteOptions().shape,l=1===u?{}:[],p=i.retrievePreserveNull(s);return t.forEach(((t,r)=>{const n={key:i.convertSingleValue(r,e.keyType,c,s,a),value:i.convertSingleValue(t,e.valueType,h,s,a)},d=(0,o.Jf)(n.key),y=null===n.value&&p||(0,o.Jf)(n.value);d&&y&&(1===u?l[n.key]=n.value:l.push(n))})),l}}},318:(t,e,r)=>{"use strict";r.d(e,{_:()=>s});r(660);var i=r(255),n=r(337);function s(t){return(e,r)=>{const s=(0,n.W5)(e,r,t);(0,i.R)(s)(e,r),(0,n.EB)(e,r,s)}}},120:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{X:()=>SerializableMemberFunction});var _SerializableMember__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(318),_utils__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(337);function SerializableMemberFunction(options={}){return(target,propertyKey)=>{options.serializer=t=>t.toString(),options.deserializer=fnStr=>eval(fnStr);const finalOptions=(0,_utils__WEBPACK_IMPORTED_MODULE_0__.W5)(target,propertyKey,options);(0,_SerializableMember__WEBPACK_IMPORTED_MODULE_1__._)(finalOptions)(target,propertyKey),(0,_utils__WEBPACK_IMPORTED_MODULE_0__.EB)(target,propertyKey,finalOptions)}}},337:(t,e,r)=>{"use strict";r.d(e,{Cn:()=>d,EB:()=>c,W5:()=>l,hs:()=>h});var i=r(606),n=r(665),s=r(25),o=r(434);const a=r(465);function c(t,e,r){var a,c;const h=Reflect.getMetadata("design:type",t,e);if(r){const n=i.WR.ensurePresentInPrototype(t),s=o.jL.getRootMetadata(t.constructor),h=n.dataMembers.get(e)||n.dataMembers.get(r.name),u=s.dataMembers.get(e)||s.dataMembers.get(r.name);if(!h)throw new Error(`Unable to get member metadata for ${t} on property ${e}!`);h.options=p(null!==(a=h.options)&&void 0!==a?a:{},r),u&&(h.options=p(null!==(c=u.options)&&void 0!==c?c:{},h.options)),s.knownTypes.forEach((n=>{var s,a;if(n===t||t instanceof n)return;const c=null!==(s=o.jL.getMetadata(n))&&void 0!==s?s:i.WR.ensurePresentInPrototype(n),u=c.dataMembers.get(e)||c.dataMembers.get(r.name);u&&(u.options=p(null!==(a=h.options)&&void 0!==a?a:{},u.options))}))}const u=i.WR.ensurePresentInPrototype(t).dataMembers.get(r&&r.name||e);h!==Object||r&&(r.deserializer||Object.keys(r).includes("constructor"))?u&&"object"!=typeof r&&u.type()instanceof o.h2&&(u.type=()=>new o.h2(h)):(u.serializer=t=>s.C.serialize(t),u.deserializer=t=>s.C.deserialize(t),u.type=()=>n.IK)}function h(t,e){var r,i,n;const a=o.jL.getMetadata(t),c=o.jL.getRootMetadata(t.prototype);c.knownTypes.add(t),c.initializerCallback&&!a.initializerCallback&&(a.initializerCallback=c.initializerCallback),e&&(a.options=p(a===c?null!==(r=a.options)&&void 0!==r?r:{}:null!==(n=null!==(i=a.options)&&void 0!==i?i:c.options)&&void 0!==n?n:{},e),c.knownTypes.forEach((e=>{var r;if(e===t||!(e.prototype instanceof t))return;const i=o.jL.getMetadata(e);i.options=p(null!==(r=a.options)&&void 0!==r?r:{},i.options),!i.initializerCallback&&a.initializerCallback&&(i.initializerCallback=a.initializerCallback)}))),c.knownTypes.forEach((e=>{if(e===t||!(t.prototype instanceof e))return;const r=o.jL.getMetadata(e);r&&r.initializerCallback&&!a.initializerCallback&&(a.initializerCallback=r.initializerCallback)})),s.C.registerType(t)}function u(t){return t&&"object"==typeof t&&!Array.isArray(t)}function l(t,e,r){var i;if("function"==typeof r)return r;return p(r,null!==(i=o.jL.getMemberOptions(t.constructor,e))&&void 0!==i?i:{})}function p(t,e){const r=a(t);return u(t)&&u(e)&&Object.keys(e).forEach((i=>{if(Array.isArray(e[i])){r[i]=e[i];const n=void 0!==t[i]?Array.isArray(t[i])?t[i]:[t[i]]:[];r[i].push(...n.filter((t=>!e[i].includes(t))))}else u(e[i])?i in t?r[i]=p(t[i],e[i]):Object.assign(r,{[i]:e[i]}):Object.assign(r,{[i]:e[i]})})),r}const d={cloneDeep:a,mergeDeep:p}},496:(t,e,r)=>{"use strict";r.r(e),r.d(e,{Absolute2DPosition:()=>ye,Absolute3DPosition:()=>fe,AbsoluteOrientationSensor:()=>he,AbsolutePosition:()=>Dt,Acceleration:()=>ne,AccelerationUnit:()=>kt,Accelerometer:()=>se,Accuracy:()=>K,Accuracy1D:()=>J,Accuracy2D:()=>Te,Accuracy3D:()=>De,AccuracyModifierNode:()=>AccuracyModifierNode,AngleUnit:()=>U,AngularVelocity:()=>Z,AngularVelocityUnit:()=>I,AxisAngle:()=>vt,BufferUtils:()=>Xt.o,CANBERRA:()=>Nt,CHEBYSHEV:()=>Tt,CalibrationNode:()=>CalibrationNode,CalibrationService:()=>CalibrationService,CallbackNode:()=>CallbackNode,CallbackSinkNode:()=>CallbackSinkNode,CallbackSourceNode:()=>CallbackSourceNode,CellIdentificationNode:()=>CellIdentificationNode,ConcreteTypeDescriptor:()=>l.h2,DataFrame:()=>te,DataFrameService:()=>DataFrameService,DataObject:()=>Rt,DataObjectService:()=>DataObjectService,DataSerializer:()=>u.C,DataSerializerUtils:()=>l.jL,DataService:()=>He,DataServiceDriver:()=>$e,DerivedUnit:()=>C,Deserializer:()=>Oe.Z,DummyDataService:()=>DummyDataService,DummyService:()=>DummyService,EMAFilterNode:()=>EMAFilterNode,EUCLIDEAN:()=>At,Edge:()=>Edge,Euler:()=>gt,FilterProcessingNode:()=>FilterProcessingNode,GCS:()=>Mt,GeographicalPosition:()=>ge,GraphBuilder:()=>GraphBuilder,GraphShapeBuilder:()=>GraphShapeBuilder,GraphShapeNode:()=>GraphShapeNode,GravitySensor:()=>oe,Gyroscope:()=>ae,HAVERSINE:()=>St,HPFilterNode:()=>HPFilterNode,HistorySourceNode:()=>HistorySourceNode,Humidity:()=>ze,KalmanFilter:()=>KalmanFilter,KalmanFilterNode:()=>KalmanFilterNode,KeyValueDataService:()=>KeyValueDataService,LPFilterNode:()=>LPFilterNode,LengthUnit:()=>R,LinearAccelerationSensor:()=>ce,LinearVelocity:()=>tt,LinearVelocitySensor:()=>de,LinearVelocityUnit:()=>X,ListSourceNode:()=>ListSourceNode,LocationBasedService:()=>LocationBasedService,LoggingSinkNode:()=>LoggingSinkNode,LuminanceIntensityUnit:()=>$t,LuminanceUnit:()=>Gt,MANHATTAN:()=>zt,Magnetism:()=>le,MagnetismUnit:()=>Lt,Magnetometer:()=>pe,Matrix3:()=>Zt,Matrix4:()=>ft,MemoryDataService:()=>MemoryDataService,MemoryQueryEvaluator:()=>MemoryQueryEvaluator,ModelBuilder:()=>ModelBuilder,ModelSerializer:()=>ModelSerializer,MultilaterationNode:()=>MultilaterationNode,Node:()=>A,NodeData:()=>Ye,NodeDataService:()=>NodeDataService,NumberType:()=>$,ObjectProcessingNode:()=>ObjectProcessingNode,Orientation:()=>xt,Pose:()=>Ee,Pressure:()=>Ne,PressureUnit:()=>Wt,ProcessingNode:()=>rr,PropertyFilterProcessingNode:()=>PropertyFilterProcessingNode,PushError:()=>PushError,Quaternion:()=>wt,ReferenceSpace:()=>ee,ReferenceSpaceConversionNode:()=>ReferenceSpaceConversionNode,RelativeAngle:()=>_e,RelativeAngularVelocity:()=>we,RelativeDistance:()=>ve,RelativeLinearVelocity:()=>be,RelativeOrientationSensor:()=>ue,RelativePosition:()=>Pt,RelativePositionFilter:()=>RelativePositionFilter,RelativePositionProcessing:()=>RelativePositionProcessing,RemoteNode:()=>RemoteNode,RemoteService:()=>Xe,RemoteServiceProxy:()=>RemoteServiceProxy,RemoteSinkNode:()=>RemoteSinkNode,RemoteSourceNode:()=>RemoteSourceNode,SMAFilterNode:()=>SMAFilterNode,SensorCalibrationData:()=>re,SensorObject:()=>ie,SensorValue:()=>Q,SerializableArrayMember:()=>yt,SerializableMapMember:()=>D,SerializableMember:()=>s._,SerializableMemberFunction:()=>F.X,SerializableObject:()=>d,SerializableSetMember:()=>Se,SerializationUtils:()=>p.Cn,Serializer:()=>Pe.e,Service:()=>L,SinkNode:()=>er,SourceNode:()=>Ct,Temperature:()=>Ae,TemperatureUnit:()=>Ft,TimeService:()=>B,TimeUnit:()=>m,Trajectory:()=>xe,TrajectoryService:()=>TrajectoryService,TriangulationNode:()=>TriangulationNode,TypeDescriptor:()=>l.eh,TypedJSON:()=>Le,UUID:()=>Be,Unit:()=>y,UnitPrefix:()=>UnitPrefix,UnitValue:()=>jt,Vector2:()=>Kt,Vector3:()=>W,Vector4:()=>Jt,Velocity:()=>et,WorkerServiceProxy:()=>WorkerServiceProxy,mergeMemberOptions:()=>p.W5,updateSerializableMember:()=>p.EB,updateSerializableObject:()=>p.hs});var i={};r.r(i),r.d(i,{AnyT:()=>N.IK,ArrayT:()=>N.AJ,ArrayTypeDescriptor:()=>N.GJ,JsonObjectMetadata:()=>o.WR,MapT:()=>N.mY,MapTypeDescriptor:()=>N.br,SetT:()=>N.zc,SetTypeDescriptor:()=>N.do,TypedJSON:()=>je,defaultTypeEmitter:()=>Ce.C,defaultTypeResolver:()=>Re.m,jsonArrayMember:()=>pt,jsonMapMember:()=>T,jsonMember:()=>Ue.R,jsonObject:()=>c,jsonSetMember:()=>Me,toJson:()=>ke});r(660);var n=r(582),s=r(318),o=r(606),a=r(651);function c(t){var e;function r(t){var r=o.WR.ensurePresentInPrototype(t.prototype);r.isExplicitlyMarked=!0,r.onDeserializedMethodName=e.onDeserialized,r.beforeSerializationMethodName=e.beforeSerialization,null!=e.typeResolver&&(r.typeResolver=e.typeResolver),null!=e.typeHintEmitter&&(r.typeHintEmitter=e.typeHintEmitter),r.initializerCallback=e.initializer,null!=e.name&&(r.name=e.name);var i=(0,a.M3)(e);void 0!==i&&(r.options=i),null!=e.knownTypes&&e.knownTypes.filter((function(t){return Boolean(t)})).forEach((function(t){return r.knownTypes.add(t)}))}if(e="function"==typeof t?{}:null!=t?t:{},"function"!=typeof t)return r;r(t)}var h,u=r(25),l=r(434),p=r(337);function d(t){return e=>{l.jL.createMetadata(e.prototype),c(t)(e),u.C.eventEmitter.emit("updateSerializableObject",e,t),(0,p.hs)(e,t)}}class UnitPrefix{constructor(t,e,r){this.name=t,this.abbrevation=e,this.magnitude=r}get namePattern(){return new RegExp(`/^${this.name}/g`)}get abbrevationPattern(){return new RegExp(`/^${this.abbrevation}/g`)}}UnitPrefix.DECA=new UnitPrefix("deca","da",10),UnitPrefix.HECTO=new UnitPrefix("hecto","h",100),UnitPrefix.KILO=new UnitPrefix("kilo","k",1e3),UnitPrefix.MEGA=new UnitPrefix("mega","M",1e6),UnitPrefix.GIGA=new UnitPrefix("giga","G",1e9),UnitPrefix.TERA=new UnitPrefix("tera","T",1e12),UnitPrefix.PETA=new UnitPrefix("peta","P",1e15),UnitPrefix.EXA=new UnitPrefix("exa","E",1e18),UnitPrefix.ZETTA=new UnitPrefix("zetta","Z",1e21),UnitPrefix.YOTTA=new UnitPrefix("yotta","Y",1e24),UnitPrefix.DECI=new UnitPrefix("deci","d",.1),UnitPrefix.CENTI=new UnitPrefix("centi","c",.01),UnitPrefix.MILLI=new UnitPrefix("milli","m",.001),UnitPrefix.MICRO=new UnitPrefix("micro","u",1e-6),UnitPrefix.NANO=new UnitPrefix("nano","n",1e-9),UnitPrefix.PICO=new UnitPrefix("pico","p",1e-12),UnitPrefix.FEMTO=new UnitPrefix("femto","f",1e-15),UnitPrefix.ATTO=new UnitPrefix("atto","a",1e-18),UnitPrefix.ZEPTO=new UnitPrefix("zepto","z",1e-21),UnitPrefix.YOCTO=new UnitPrefix("yocto","y",1e-24),UnitPrefix.DECIMAL=[UnitPrefix.DECA,UnitPrefix.HECTO,UnitPrefix.KILO,UnitPrefix.MEGA,UnitPrefix.GIGA,UnitPrefix.TERA,UnitPrefix.PETA,UnitPrefix.EXA,UnitPrefix.ZETTA,UnitPrefix.YOTTA,UnitPrefix.DECI,UnitPrefix.CENTI,UnitPrefix.MILLI,UnitPrefix.MICRO,UnitPrefix.NANO,UnitPrefix.PICO,UnitPrefix.FEMTO,UnitPrefix.ATTO,UnitPrefix.ZEPTO,UnitPrefix.YOCTO];let y=h=class Unit{constructor(t,e){this._definitions=new Map,this._prefixType="none",this._aliases=[];const r=e||{baseName:void 0};r.aliases=r.aliases||[],r.prefixes=r.prefixes||"none",r.definitions=r.definitions||[],this._name=t||r.name,this._baseName=r.baseName,this._aliases=r.aliases,this._prefixType=r.prefixes,r.definitions.forEach(this._initDefinition.bind(this)),this.name&&h.registerUnit(this,r.override)}static fromJSON(t){if(void 0!==t.name){const e=h.findByName(t.name);if(!e)throw new Error(`Unit with name '${t.name}' not found! Unable to deserialize!`);return e}throw new Error("Unit does not define a serialization name! Unable to deserialize!")}_initDefinition(t){const e=h.findByName(t.unit,this.baseName),r=e?e.name:t.unit;"toUnit"in t?this._initFunctionDefinition(t,r):this._initBasicDefinition(t,r)}_initFunctionDefinition(t,e){const r=t;this._definitions.set(e,r)}_initBasicDefinition(t,e){const r=Object.keys(t),i=t,n=r.indexOf("magnitude"),s=r.indexOf("offset"),o=i.magnitude||1,a=void 0!==i.offset?i.offset:0;let c,h;-1===n||s<n?(c=t=>(t+a)*o,h=t=>t/o-a):(c=t=>t*o+a,h=t=>(t-a)/o),this._definitions.set(e,{unit:i.unit,toUnit:c,fromUnit:h})}get name(){return this._name}set name(t){this._name=t;const e=h.findByName(t);e&&(this._baseName=e.baseName,this._definitions=e._definitions,this._prefixType=e._prefixType,this._aliases=e._aliases)}get aliases(){return this._aliases}get baseName(){return this._baseName}get prefixType(){return this._prefixType}get definitions(){return Array.from(this._definitions.values())}get prefixes(){switch(this._prefixType){case"decimal":return UnitPrefix.DECIMAL;case"none":return[]}}createBaseDefinition(){let t;const e=h.UNIT_BASES.get(this.baseName);if(this._definitions.has(e)){const r=this._definitions.get(e);t=r}else this._definitions.forEach((e=>{const r=h.findByName(e.unit,this.baseName).createBaseDefinition();r&&(t={unit:r.unit,toUnit:t=>r.toUnit(e.toUnit(t)),fromUnit:t=>e.fromUnit(r.fromUnit(t))})}));return t}createDefinition(t){let e;const r=h.UNIT_BASES.get(this.baseName),i=h.findByName(r);if(this._definitions.has(t.name)){e=this._definitions.get(t.name)}else if(t._definitions.has(this.name)){const r=t._definitions.get(this.name);e={unit:t.name,toUnit:r.fromUnit,fromUnit:r.toUnit},this._definitions.set(t.name,e)}else if(i.name!==this.name){const n=this._definitions.get(r),s=i.createDefinition(t);n&&s&&(e={unit:t.name,toUnit:t=>s.toUnit(n.toUnit(t)),fromUnit:t=>n.fromUnit(s.fromUnit(t))},this._definitions.set(t.name,e))}return e}specifier(t){const e=`${t.name}${this.name}`;if(h.UNITS.has(e))return h.UNITS.get(e);if(!this.prefixes.includes(t))throw new Error(`Prefix '${t.name}' is not allowed for this unit!`);const r=new(0,Object.getPrototypeOf(this).constructor);r._name=e,r._baseName=this.baseName;const i=[];return this.aliases.forEach((e=>{i.push(`${t.name}${e}`),i.push(`${t.abbrevation}${e}`)})),r._aliases=i,r._definitions.set(this.name,{unit:this.name,toUnit:e=>e*t.magnitude,fromUnit:e=>e/t.magnitude}),h.registerUnit(r)}findByName(t){for(const e of this.aliases.concat(this.name)){if(t===e)return this;if(t.endsWith(e))for(const e of this.prefixes)if(t.match(e.abbrevationPattern)||t.match(e.namePattern))return this.specifier(e)}}static findByName(t,e){if(void 0!==t){if(h.UNITS.has(t))return h.UNITS.get(t);for(const[,r]of h.UNITS){if(e&&e!==r.baseName)continue;const i=r.findByName(t);if(i)return i}}}convert(t,e){const r=e instanceof h?e:h.findByName(e,this.baseName);if(!r||r.name===this.name)return t;const i=this.createDefinition(r);if(i)return i.toUnit(t);throw new Error(`No conversion definition found from '${this.name}' to '${r.name}'!`)}static convert(t,e,r){return("string"==typeof e?h.findByName(e):e).convert(t,r)}static registerUnit(t,e=!1){if(!t.name)return t;h.UNITS.has(t.name)&&!e||h.UNITS.set(t.name,t);const r=t.baseName?t.baseName:t.name,i=h.UNIT_BASES.get(r);if(i){const e=h.findByName(i,r).createDefinition(t),n=t.createBaseDefinition();e||t._definitions.set(i,n)}else h.UNIT_BASES.set(r,t.name);return t}};var f;y.UNIT_BASES=new Map,y.UNITS=new Map,y.UNKNOWN=new h("unknown"),(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",String),(0,n.w6)("design:paramtypes",[String])],y.prototype,"name",null),y=h=(0,n.gn)([d({initializer:h.fromJSON}),(0,n.w6)("design:paramtypes",[String,Object])],y);let m=f=class TimeUnit extends y{};m.SECOND=new f("second",{baseName:"time",aliases:["s","sec","seconds"],prefixes:"decimal"}),m.MILLISECOND=f.SECOND.specifier(UnitPrefix.MILLI),m.MICROSECOND=f.SECOND.specifier(UnitPrefix.MICRO),m.NANOSECOND=f.SECOND.specifier(UnitPrefix.NANO),m.MINUTE=new f("minute",{baseName:"time",aliases:["m","min","minutes"],definitions:[{magnitude:60,unit:"s"}]}),m.HOUR=new f("hour",{baseName:"time",aliases:["h","hr","hrs","hours"],definitions:[{magnitude:3600,unit:"s"},{magnitude:60,unit:"min"}]}),m=f=(0,n.gn)([d()],m);const g={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let _;const v=new Uint8Array(16);function w(){if(!_&&(_="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!_))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return _(v)}const b=[];for(let t=0;t<256;++t)b.push((t+256).toString(16).slice(1));function x(t,e=0){return(b[t[e+0]]+b[t[e+1]]+b[t[e+2]]+b[t[e+3]]+"-"+b[t[e+4]]+b[t[e+5]]+"-"+b[t[e+6]]+b[t[e+7]]+"-"+b[t[e+8]]+b[t[e+9]]+"-"+b[t[e+10]]+b[t[e+11]]+b[t[e+12]]+b[t[e+13]]+b[t[e+14]]+b[t[e+15]]).toLowerCase()}const E=function(t,e,r){if(g.randomUUID&&!e&&!t)return g.randomUUID();const i=(t=t||{}).random||(t.rng||w)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,e){r=r||0;for(let t=0;t<16;++t)e[r+t]=i[t];return e}return x(i)};var M=r(187);class AsyncEventEmitter extends M.EventEmitter{emitAsync(t,...e){return new Promise(((r,i)=>{const n=this.listeners(t);if(0===n.length)return r(!1);const s=[];n.forEach((t=>{s.push(t(...e))})),Promise.all(s).then((()=>{r(!0)})).catch(i)}))}}let S=class GraphNode extends AsyncEventEmitter{constructor(){super(),this.uid=E(),this._ready=!1,this._available=!0,this.prependOnceListener("ready",(()=>{this._ready=!0})),this.on("error",this._onError.bind(this)),this.on("completed",this._onCompleted.bind(this))}logger(t,e,r){"object"==typeof e?this.graph.logger(t,JSON.stringify(e)):this.graph.logger(t,e,r)}isReady(){return this._ready}isAvailable(){return this._available}get outlets(){return this.graph.edges.filter((t=>t.inputNode.uid===this.uid))}get inlets(){return this.graph.edges.filter((t=>t.outputNode.uid===this.uid))}emit(t,...e){return super.emit(t,...e)}on(t,e){return super.on(t,e)}once(t,e){return super.once(t,e)}pull(t){return new Promise(((e,r)=>{const i=[];this.listeners("pull").forEach((e=>{i.push(e(t))})),0===i.length&&this.inlets.forEach((e=>{i.push(e.pull(t))})),Promise.all(i).then((()=>{e()})).catch(r)}))}push(t,e={}){return new Promise(((r,i)=>{if(null==t)return i(new Error("Node received null data frame!"));const n=this.listeners("push");0===n.length?(this.outlets.forEach((r=>r.push(t,e))),r()):(this._available=!1,Promise.all(n.map((r=>r(t,e)))).then((()=>{this._available=!0,this.emit("available"),r()})).catch(i))}))}onceAvailable(){return new Promise((t=>{this.isAvailable()?t():this.once("available",(()=>{t()}))}))}onceCompleted(t){return new Promise(((e,r)=>{const i=function(n){n.frameUID===t&&(this.removeListener("completed",i),this.removeListener("error",i),n.error?r(n):e(n))};this.on("completed",i.bind(this)),this.on("error",i.bind(this))}))}_onError(t){this.inlets.forEach((e=>e.emit("error",t)))}_onCompleted(t){this.inlets.forEach((e=>e.emit("completed",t)))}};(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",String)],S.prototype,"name",void 0),(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",String)],S.prototype,"uid",void 0),S=(0,n.gn)([d(),(0,n.w6)("design:paramtypes",[])],S);let A=class Node extends S{constructor(t){super(),this.setOptions(t||{}),this.uid=this.options.uid||this.uid}setOptions(t){return this.options=Object.assign(Object.assign({},t),this.options||[]),this.name=this.options.name||this.constructor.name,this}getOptions(){return this.options}get model(){return this.graph}};(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",Object)],A.prototype,"options",void 0),A=(0,n.gn)([d(),(0,n.w6)("design:paramtypes",[Object])],A);class BroadcastNode extends A{}class PushError extends Error{constructor(t,e,r){super(),this.frameUID=t,this.nodeUID=e,this.name=r.name,this.message=r.message,this.stack=r.stack}}class Edge extends M.EventEmitter{constructor(t,e){super(),this.inputNode=t,this.outputNode=e,this.on("push",this._onPush.bind(this)),this.on("pull",this._onPull.bind(this))}_onPush(t,e){return this.outputNode.push(t,e)}_onPull(t){return this.inputNode.pull(t)}push(t,e={}){return new Promise((r=>{const i=Object.assign(Object.assign({},e),{lastNode:this.inputNode.uid}),n=this.listeners("push");Promise.all(n.map((e=>e(t,i)))).then((()=>{r()})).catch((e=>{Array.isArray(t)?t.forEach((t=>{this.inputNode.emit("error",new PushError(t.uid,this.outputNode.uid,e))})):this.inputNode.emit("error",new PushError(t.uid,this.outputNode.uid,e))}))}))}pull(t){return new Promise(((e,r)=>{const i=this.listeners("pull");Promise.all(i.map((e=>e(t)))).then((()=>{e()})).catch(r)}))}emit(t,e){return this.inputNode.emit(t,e)}on(t,e){return this.removeAllListeners(t),super.on(t,e)}}var z=r(77),N=r(665);function T(t,e,r){return void 0===r&&(r={}),function(i,n){var s,c="@jsonMapMember on "+(0,z.$0)(i.constructor)+"."+String(n),h=(0,N.JD)(t,c),u=(0,N.JD)(e,c),l=z.df?Reflect.getMetadata("design:type",i,n):null;null==l||l===Map||l===Object?(0,o.d3)(i,n,{type:function(){return(0,N.mY)(h(),u(),{shape:r.shape})},emitDefaultValue:r.emitDefaultValue,isRequired:r.isRequired,options:(0,a.M3)(r),key:n.toString(),name:null!==(s=r.name)&&void 0!==s?s:n.toString(),deserializer:r.deserializer,serializer:r.serializer}):(0,z.H)(c+": property is not a Map. "+z.AZ)}}function D(t,e,r){return(i,n)=>{e===Object&&void 0===r&&((r={}).deserializer=t=>{const e=new Map;return Object.keys(t).forEach((r=>{e.set(r,JSON.parse(t[r]))})),e},r.serializer=t=>{const e={};return t.forEach(((t,r)=>{e[r]=JSON.stringify(t)})),e});const s=(0,p.W5)(i,n,r);T(t,e,s)(i,n),(0,p.EB)(i,n,s)}}let P=class GraphShape extends A{constructor(){super(),this._nodes=new Map,this._edges=new Map,this.internalSource=new BroadcastNode,this.internalSink=new BroadcastNode,this.logger=()=>{},this.addNode(this.internalSource),this.addNode(this.internalSink),this.once("build",this._onBuild.bind(this)),this.once("destroy",this._onDestroy.bind(this)),this.removeAllListeners("error"),this.internalSource.on("error",this.onError.bind(this)),this.internalSink.on("error",this.onError.bind(this)),this.removeAllListeners("completed"),this.internalSource.on("completed",this.onCompleted.bind(this)),this.internalSink.on("completed",this.onCompleted.bind(this))}_onDestroy(){this.nodes.forEach((t=>{t.emit("destroy")}))}_onBuild(t){return new Promise(((e,r)=>{Promise.all(this.nodes.map((e=>e.emitAsync("build",t)))).then((()=>{this.emit("ready"),e()})).catch((t=>{r(t)}))}))}get edges(){return this._edges?Array.from(this._edges.values()):[]}set edges(t){t.forEach(this.addEdge)}get nodes(){return this._nodes?Array.from(this._nodes.values()):[]}set nodes(t){t.forEach(this.addNode)}findNodeByUID(t){return this._nodes.get(t)}findNodeByName(t){let e;return this._nodes.forEach((r=>{r.name!==t||(e=r)})),e}addNode(t){t.graph=void 0===this.graph?this:this.model,this._nodes.set(t.uid,t)}addEdge(t){this._edges.set(t.inputNode.uid+t.outputNode.uid,t)}deleteEdge(t){this._edges.delete(t.inputNode.uid+t.outputNode.uid)}deleteNode(t){this._nodes.delete(t.uid)}findEdge(t,e){return this._edges.get(t+e)}pull(t){return this.internalSink.pull(t)}push(t,e){return this.internalSource.push(t,e)}onError(t){this.listenerCount("error")>0&&this.emit("error",t)}onCompleted(t){this.emit("completed",t)}};(0,n.gn)([D(String,S,{name:"nodes"}),(0,n.w6)("design:type",Map)],P.prototype,"_nodes",void 0),(0,n.gn)([D(String,Edge,{serializer:t=>Array.from(t.values()).map((t=>({input:t.inputNode.uid,output:t.outputNode.uid}))),name:"edges"}),(0,n.w6)("design:type",Map)],P.prototype,"_edges",void 0),(0,n.gn)([(0,s._)({serializer:t=>t.uid,deserializer:()=>{}}),(0,n.w6)("design:type",S)],P.prototype,"internalSource",void 0),(0,n.gn)([(0,s._)({serializer:t=>t.uid,deserializer:()=>{}}),(0,n.w6)("design:type",S)],P.prototype,"internalSink",void 0),P=(0,n.gn)([d({initializer:(t,e)=>{const r=new(u.C.findTypeByName(e.__type));return Object.assign(r,t),e.edges.forEach((e=>{r._edges.set(e.input+e.output,new Edge(t._nodes.get(e.input),t._nodes.get(e.output)))})),r}}),(0,n.w6)("design:paramtypes",[])],P);class PlaceholderNode extends A{constructor(t,e){super(Object.assign({name:t},e))}}var O;let R=O=class LengthUnit extends y{};R.METER=new O("meter",{baseName:"length",aliases:["m","meters"],prefixes:"decimal"}),R.CENTIMETER=O.METER.specifier(UnitPrefix.CENTI),R.MILLIMETER=O.METER.specifier(UnitPrefix.MILLI),R.KILOMETER=O.METER.specifier(UnitPrefix.KILO),R.MILE=new O("mile",{baseName:"length",aliases:["mil","miles"],definitions:[{unit:"meter",magnitude:1609.344}]}),R=O=(0,n.gn)([d()],R);let C=class DerivedUnit extends y{constructor(){super(...arguments),this._units=new Map,this._unitPower=new Map}addUnit(t,e){if(this._units.has(t.baseName))throw new Error(`A unit with base name '${t.baseName}' already exists for this unit!`);return this._units.set(t.baseName,t),this._unitPower.set(t.baseName,e),this}swap(t,e){if(y.UNITS.has(e.name))return y.UNITS.get(e.name);const r=new(0,Object.getPrototypeOf(this).constructor);r._name=e.name,r._baseName=this.baseName,r._aliases=e.aliases?e.aliases:[];const i={unit:this.name,toUnit:void 0,fromUnit:void 0};return t.forEach((t=>{const e=this._units.get(t.baseName),r=this._unitPower.get(t.baseName),n=t.createDefinition(e),s=t=>Math.pow(n.toUnit(t),r),o=t=>Math.pow(n.fromUnit(t),r),a=i.toUnit,c=i.fromUnit;a&&c?(i.toUnit=t=>a(s(t)),i.fromUnit=t=>c(o(t))):(i.toUnit=s,i.fromUnit=o)})),r._definitions.set(this.name,i),y.registerUnit(r)}};var j;C=(0,n.gn)([d()],C);let U=j=class AngleUnit extends y{};var k;U.RADIAN=new j("radian",{baseName:"angle",aliases:["rad","rads","radians"]}),U.DEGREE=new j("degree",{baseName:"angle",aliases:["deg","degs","degrees"],definitions:[{magnitude:Math.PI/180,unit:"rad"}]}),U=j=(0,n.gn)([d()],U);let I=k=class AngularVelocityUnit extends C{};I.RADIAN_PER_SECOND=new k("radian per second",{baseName:"angularvelocity",aliases:["rad/s","radians per second"]}).addUnit(U.RADIAN,1).addUnit(m.SECOND,-1),I.DEGREE_PER_SECOND=k.RADIAN_PER_SECOND.swap([U.DEGREE],{baseName:"angularvelocity",name:"degree per second",aliases:["deg/s","degrees per second"]}),I.RADIAN_PER_MINUTE=k.RADIAN_PER_SECOND.swap([m.MINUTE],{baseName:"angularvelocity",name:"radian per minute",aliases:["rad/min","radian per minute"]}),I.DEGREE_PER_MINUTE=k.RADIAN_PER_SECOND.swap([U.DEGREE,m.MINUTE],{baseName:"angularvelocity",name:"degree per minute",aliases:["deg/min","degrees per minute"]}),I=k=(0,n.gn)([d()],I);let L=class Service extends AsyncEventEmitter{constructor(){super(),this._ready=!1,this.uid=this.constructor.name,this.prependOnceListener("ready",(()=>{this._ready=!0}))}generateUUID(){return E()}setUID(t){return this.uid=t,this}isReady(){return this._ready}emit(t,...e){return super.emit(t,...e)}once(t,e){return"ready"===t&&this.isReady()?(e(),this):super.once(t,e)}logger(t,e,r){this.model&&this.model.logger(t,e,r)}};(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",String)],L.prototype,"uid",void 0),L=(0,n.gn)([d(),(0,n.w6)("design:paramtypes",[])],L);var V,F=r(120);let B=V=class TimeService extends L{constructor(t,e=m.MILLISECOND){super(),this._timeCallback=t,this._timeUnit=e,this.uid=this.constructor.name,V._defaultTimeCallback||V.initialize(),this._timeCallback?(V._defaultTimeCallback=t,V._defaultUnit=e):(this._timeCallback=V.now,this._timeUnit=V.getUnit())}get isDefault(){return V._defaultTimeCallback===this._timeCallback}set isDefault(t){t&&(V._defaultTimeCallback=this._timeCallback,V._defaultUnit=this._timeUnit)}static initialize(){V._defaultTimeCallback=Date.now,V._defaultUnit=m.MILLISECOND;try{const t=r(801);t.now&&(V._defaultTimeCallback=t.now,V._defaultUnit=m.MICROSECOND)}catch(t){return}}getTime(){return this._timeCallback()}getUnit(){return this._timeUnit}static now(){return V._defaultTimeCallback||V.initialize(),V._defaultTimeCallback()}static getUnit(){return V._defaultTimeCallback||V.initialize(),V._defaultUnit}};var $;(0,n.gn)([(0,F.X)(),(0,n.w6)("design:type",Function)],B.prototype,"_timeCallback",void 0),(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",m)],B.prototype,"_timeUnit",void 0),(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",Boolean),(0,n.w6)("design:paramtypes",[Boolean])],B.prototype,"isDefault",null),B=V=(0,n.gn)([d(),(0,n.w6)("design:paramtypes",[Function,m])],B),function(t){t[t.INTEGER=0]="INTEGER",t[t.FLOAT=1]="FLOAT",t[t.DOUBLE=2]="DOUBLE",t[t.DECIMAL=3]="DECIMAL",t[t.LONG=4]="LONG",t[t.SHORT=5]="SHORT"}($||($={}));Math.PI,Math.PI;function H(t,e,r){return Math.max(e,Math.min(r,t))}class Quaternion_Quaternion{constructor(t=0,e=0,r=0,i=1){this.isQuaternion=!0,this._x=t,this._y=e,this._z=r,this._w=i}static slerpFlat(t,e,r,i,n,s,o){let a=r[i+0],c=r[i+1],h=r[i+2],u=r[i+3];const l=n[s+0],p=n[s+1],d=n[s+2],y=n[s+3];if(0===o)return t[e+0]=a,t[e+1]=c,t[e+2]=h,void(t[e+3]=u);if(1===o)return t[e+0]=l,t[e+1]=p,t[e+2]=d,void(t[e+3]=y);if(u!==y||a!==l||c!==p||h!==d){let t=1-o;const e=a*l+c*p+h*d+u*y,r=e>=0?1:-1,i=1-e*e;if(i>Number.EPSILON){const n=Math.sqrt(i),s=Math.atan2(n,e*r);t=Math.sin(t*s)/n,o=Math.sin(o*s)/n}const n=o*r;if(a=a*t+l*n,c=c*t+p*n,h=h*t+d*n,u=u*t+y*n,t===1-o){const t=1/Math.sqrt(a*a+c*c+h*h+u*u);a*=t,c*=t,h*=t,u*=t}}t[e]=a,t[e+1]=c,t[e+2]=h,t[e+3]=u}static multiplyQuaternionsFlat(t,e,r,i,n,s){const o=r[i],a=r[i+1],c=r[i+2],h=r[i+3],u=n[s],l=n[s+1],p=n[s+2],d=n[s+3];return t[e]=o*d+h*u+a*p-c*l,t[e+1]=a*d+h*l+c*u-o*p,t[e+2]=c*d+h*p+o*l-a*u,t[e+3]=h*d-o*u-a*l-c*p,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,r,i){return this._x=t,this._y=e,this._z=r,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e){const r=t._x,i=t._y,n=t._z,s=t._order,o=Math.cos,a=Math.sin,c=o(r/2),h=o(i/2),u=o(n/2),l=a(r/2),p=a(i/2),d=a(n/2);switch(s){case"XYZ":this._x=l*h*u+c*p*d,this._y=c*p*u-l*h*d,this._z=c*h*d+l*p*u,this._w=c*h*u-l*p*d;break;case"YXZ":this._x=l*h*u+c*p*d,this._y=c*p*u-l*h*d,this._z=c*h*d-l*p*u,this._w=c*h*u+l*p*d;break;case"ZXY":this._x=l*h*u-c*p*d,this._y=c*p*u+l*h*d,this._z=c*h*d+l*p*u,this._w=c*h*u-l*p*d;break;case"ZYX":this._x=l*h*u-c*p*d,this._y=c*p*u+l*h*d,this._z=c*h*d-l*p*u,this._w=c*h*u+l*p*d;break;case"YZX":this._x=l*h*u+c*p*d,this._y=c*p*u+l*h*d,this._z=c*h*d-l*p*u,this._w=c*h*u-l*p*d;break;case"XZY":this._x=l*h*u-c*p*d,this._y=c*p*u-l*h*d,this._z=c*h*d+l*p*u,this._w=c*h*u+l*p*d;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return!1!==e&&this._onChangeCallback(),this}setFromAxisAngle(t,e){const r=e/2,i=Math.sin(r);return this._x=t.x*i,this._y=t.y*i,this._z=t.z*i,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(t){const e=t.elements,r=e[0],i=e[4],n=e[8],s=e[1],o=e[5],a=e[9],c=e[2],h=e[6],u=e[10],l=r+o+u;if(l>0){const t=.5/Math.sqrt(l+1);this._w=.25/t,this._x=(h-a)*t,this._y=(n-c)*t,this._z=(s-i)*t}else if(r>o&&r>u){const t=2*Math.sqrt(1+r-o-u);this._w=(h-a)/t,this._x=.25*t,this._y=(i+s)/t,this._z=(n+c)/t}else if(o>u){const t=2*Math.sqrt(1+o-r-u);this._w=(n-c)/t,this._x=(i+s)/t,this._y=.25*t,this._z=(a+h)/t}else{const t=2*Math.sqrt(1+u-r-o);this._w=(s-i)/t,this._x=(n+c)/t,this._y=(a+h)/t,this._z=.25*t}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let r=t.dot(e)+1;return r<Number.EPSILON?(r=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=r):(this._x=0,this._y=-t.z,this._z=t.y,this._w=r)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=r),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(H(this.dot(t),-1,1)))}rotateTowards(t,e){const r=this.angleTo(t);if(0===r)return this;const i=Math.min(1,e/r);return this.slerp(t,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t){return this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){const r=t._x,i=t._y,n=t._z,s=t._w,o=e._x,a=e._y,c=e._z,h=e._w;return this._x=r*h+s*o+i*c-n*a,this._y=i*h+s*a+n*o-r*c,this._z=n*h+s*c+r*a-i*o,this._w=s*h-r*o-i*a-n*c,this._onChangeCallback(),this}slerp(t,e){if(0===e)return this;if(1===e)return this.copy(t);const r=this._x,i=this._y,n=this._z,s=this._w;let o=s*t._w+r*t._x+i*t._y+n*t._z;if(o<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,o=-o):this.copy(t),o>=1)return this._w=s,this._x=r,this._y=i,this._z=n,this;const a=1-o*o;if(a<=Number.EPSILON){const t=1-e;return this._w=t*s+e*this._w,this._x=t*r+e*this._x,this._y=t*i+e*this._y,this._z=t*n+e*this._z,this.normalize(),this._onChangeCallback(),this}const c=Math.sqrt(a),h=Math.atan2(c,o),u=Math.sin((1-e)*h)/c,l=Math.sin(e*h)/c;return this._w=s*u+this._w*l,this._x=r*u+this._x*l,this._y=i*u+this._y*l,this._z=n*u+this._z*l,this._onChangeCallback(),this}slerpQuaternions(t,e,r){return this.copy(t).slerp(e,r)}random(){const t=Math.random(),e=Math.sqrt(1-t),r=Math.sqrt(t),i=2*Math.PI*Math.random(),n=2*Math.PI*Math.random();return this.set(e*Math.cos(i),r*Math.sin(n),r*Math.cos(n),e*Math.sin(i))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this}toJSON(){return this.toArray()}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Vector3_Vector3{constructor(t=0,e=0,r=0){Vector3_Vector3.prototype.isVector3=!0,this.x=t,this.y=e,this.z=r}set(t,e,r){return void 0===r&&(r=this.z),this.x=t,this.y=e,this.z=r,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return this.applyQuaternion(q.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(q.setFromAxisAngle(t,e))}applyMatrix3(t){const e=this.x,r=this.y,i=this.z,n=t.elements;return this.x=n[0]*e+n[3]*r+n[6]*i,this.y=n[1]*e+n[4]*r+n[7]*i,this.z=n[2]*e+n[5]*r+n[8]*i,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const e=this.x,r=this.y,i=this.z,n=t.elements,s=1/(n[3]*e+n[7]*r+n[11]*i+n[15]);return this.x=(n[0]*e+n[4]*r+n[8]*i+n[12])*s,this.y=(n[1]*e+n[5]*r+n[9]*i+n[13])*s,this.z=(n[2]*e+n[6]*r+n[10]*i+n[14])*s,this}applyQuaternion(t){const e=this.x,r=this.y,i=this.z,n=t.x,s=t.y,o=t.z,a=t.w,c=a*e+s*i-o*r,h=a*r+o*e-n*i,u=a*i+n*r-s*e,l=-n*e-s*r-o*i;return this.x=c*a+l*-n+h*-o-u*-s,this.y=h*a+l*-s+u*-n-c*-o,this.z=u*a+l*-o+c*-s-h*-n,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const e=this.x,r=this.y,i=this.z,n=t.elements;return this.x=n[0]*e+n[4]*r+n[8]*i,this.y=n[1]*e+n[5]*r+n[9]*i,this.z=n[2]*e+n[6]*r+n[10]*i,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this}clampLength(t,e){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(t,Math.min(e,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,r){return this.x=t.x+(e.x-t.x)*r,this.y=t.y+(e.y-t.y)*r,this.z=t.z+(e.z-t.z)*r,this}cross(t){return this.crossVectors(this,t)}crossVectors(t,e){const r=t.x,i=t.y,n=t.z,s=e.x,o=e.y,a=e.z;return this.x=i*a-n*o,this.y=n*s-r*a,this.z=r*o-i*s,this}projectOnVector(t){const e=t.lengthSq();if(0===e)return this.set(0,0,0);const r=t.dot(this)/e;return this.copy(t).multiplyScalar(r)}projectOnPlane(t){return G.copy(this).projectOnVector(t),this.sub(G)}reflect(t){return this.sub(G.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;const r=this.dot(t)/e;return Math.acos(H(r,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,r=this.y-t.y,i=this.z-t.z;return e*e+r*r+i*i}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,r){const i=Math.sin(e)*t;return this.x=i*Math.sin(r),this.y=Math.cos(e)*t,this.z=i*Math.cos(r),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,r){return this.x=t*Math.sin(e),this.y=r,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length(),r=this.setFromMatrixColumn(t,1).length(),i=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=r,this.z=i,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,4*e)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,3*e)}setFromEuler(t){return this.x=t._x,this.y=t._y,this.z=t._z,this}setFromColor(t){return this.x=t.r,this.y=t.g,this.z=t.b,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const t=2*(Math.random()-.5),e=Math.random()*Math.PI*2,r=Math.sqrt(1-t**2);return this.x=r*Math.cos(e),this.y=r*Math.sin(e),this.z=t,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const G=new Vector3_Vector3,q=new Quaternion_Quaternion;let W=class Vector3 extends Vector3_Vector3{static fromArray(t){return(new this).fromArray(t)}static fromVector(t){return new this(t.x,t.y,t.z)}clone(){return(new this.constructor).copy(this)}};(0,n.gn)([(0,s._)({numberType:$.DECIMAL}),(0,n.w6)("design:type",Number)],W.prototype,"x",void 0),(0,n.gn)([(0,s._)({numberType:$.DECIMAL}),(0,n.w6)("design:type",Number)],W.prototype,"y",void 0),(0,n.gn)([(0,s._)({numberType:$.DECIMAL}),(0,n.w6)("design:type",Number)],W.prototype,"z",void 0),W=(0,n.gn)([d()],W);let K=class Accuracy{constructor(t,e){this.value=t,this._unit=e}to(t){if(!t)throw new Error(`${this.constructor.name} does not have a unit to convert from!`);const e=this.value;if(!(e instanceof W)&&"number"!=typeof e)throw new Error(`${this.constructor.name} can not be converted!`);const r=this.unit.convert(e,t);return new this.constructor(r,t)}get unit(){return this._unit}clone(){const t=new this.constructor;return t.value=this.value,t._unit=this._unit,t}};(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",Object)],K.prototype,"value",void 0),(0,n.gn)([(0,s._)({name:"unit"}),(0,n.w6)("design:type",y)],K.prototype,"_unit",void 0),K=(0,n.gn)([d(),(0,n.w6)("design:paramtypes",[Object,Object])],K);let J=class Accuracy1D extends K{constructor(t,e){super(t,e)}valueOf(){return this.value.valueOf()}toString(){return this.valueOf().toString()}};(0,n.gn)([(0,s._)({numberType:$.DECIMAL}),(0,n.w6)("design:type",Number)],J.prototype,"value",void 0),J=(0,n.gn)([d(),(0,n.w6)("design:paramtypes",[Number,Object])],J);let Q=class SensorValue extends W{constructor(t,e,r,i,n,s){var o;i&&n?(super(i.convert(t||0,n),i.convert(e||0,n),i.convert(r||0,n)),this._defaultUnit=n):super(t,e,r),this.unit=null!==(o=null!=n?n:i)&&void 0!==o?o:y.UNKNOWN,this.timestamp=B.now(),this.accuracy=s||new J(1,this._defaultUnit||y.UNKNOWN)}setAccuracy(t){return this.accuracy="number"==typeof t?new J(t,this._defaultUnit):t,this}toTuple(t){return t?this.unit.convert(this,t).toArray():this.toArray()}clone(){const t=super.clone();return t.accuracy=this.accuracy,t.timestamp=this.timestamp,t}};(0,n.gn)([(0,s._)({isRequired:!1,numberType:$.LONG}),(0,n.w6)("design:type",Number)],Q.prototype,"timestamp",void 0),(0,n.gn)([(0,s._)({isRequired:!1}),(0,n.w6)("design:type",K)],Q.prototype,"accuracy",void 0),(0,n.gn)([(0,s._)((()=>y)),(0,n.w6)("design:type",Object)],Q.prototype,"unit",void 0),Q=(0,n.gn)([d(),(0,n.w6)("design:paramtypes",[Number,Number,Number,y,Object,K])],Q);let Z=class AngularVelocity extends Q{constructor(t,e,r,i=I.RADIAN_PER_SECOND){super(t,e,r,i,I.RADIAN_PER_SECOND)}static fromArray(t,e=I.RADIAN_PER_SECOND){return new this(t[0],t[1],t[2],e)}};var Y;(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",I)],Z.prototype,"unit",void 0),Z=(0,n.gn)([d(),(0,n.w6)("design:paramtypes",[Number,Number,Number,Object])],Z);let X=Y=class LinearVelocityUnit extends C{};X.METER_PER_SECOND=new Y("meter per second",{baseName:"linearvelocity",aliases:["m/s","meters per second"]}).addUnit(R.METER,1).addUnit(m.SECOND,-1),X.CENTIMETER_PER_SECOND=Y.METER_PER_SECOND.swap([R.CENTIMETER],{baseName:"linearvelocity",name:"centimeter per minute",aliases:["cm/min","centimeters per minute"]}),X=Y=(0,n.gn)([d()],X);let tt=class LinearVelocity extends Q{constructor(t,e,r,i=X.METER_PER_SECOND){super(t,e,r,i,X.METER_PER_SECOND)}static fromArray(t,e=X.METER_PER_SECOND){return new this(t[0],t[1],t[2],e)}};(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",X)],tt.prototype,"unit",void 0),tt=(0,n.gn)([d(),(0,n.w6)("design:paramtypes",[Number,Number,Number,Object])],tt);let et=class Velocity{constructor(t,e){this.linear=t,this.angular=e}clone(){return new this.constructor(this.linear?this.linear.clone():void 0,this.angular?this.angular.clone():void 0)}};(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",tt)],et.prototype,"linear",void 0),(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",Z)],et.prototype,"angular",void 0),et=(0,n.gn)([d(),(0,n.w6)("design:paramtypes",[tt,Z])],et);const rt=2e3;class Matrix4_Matrix4{constructor(t,e,r,i,n,s,o,a,c,h,u,l,p,d,y,f){Matrix4_Matrix4.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==t&&this.set(t,e,r,i,n,s,o,a,c,h,u,l,p,d,y,f)}set(t,e,r,i,n,s,o,a,c,h,u,l,p,d,y,f){const m=this.elements;return m[0]=t,m[4]=e,m[8]=r,m[12]=i,m[1]=n,m[5]=s,m[9]=o,m[13]=a,m[2]=c,m[6]=h,m[10]=u,m[14]=l,m[3]=p,m[7]=d,m[11]=y,m[15]=f,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Matrix4_Matrix4).fromArray(this.elements)}copy(t){const e=this.elements,r=t.elements;return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],this}copyPosition(t){const e=this.elements,r=t.elements;return e[12]=r[12],e[13]=r[13],e[14]=r[14],this}setFromMatrix3(t){const e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(t,e,r){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(t,e,r){return this.set(t.x,e.x,r.x,0,t.y,e.y,r.y,0,t.z,e.z,r.z,0,0,0,0,1),this}extractRotation(t){const e=this.elements,r=t.elements,i=1/it.setFromMatrixColumn(t,0).length(),n=1/it.setFromMatrixColumn(t,1).length(),s=1/it.setFromMatrixColumn(t,2).length();return e[0]=r[0]*i,e[1]=r[1]*i,e[2]=r[2]*i,e[3]=0,e[4]=r[4]*n,e[5]=r[5]*n,e[6]=r[6]*n,e[7]=0,e[8]=r[8]*s,e[9]=r[9]*s,e[10]=r[10]*s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){const e=this.elements,r=t.x,i=t.y,n=t.z,s=Math.cos(r),o=Math.sin(r),a=Math.cos(i),c=Math.sin(i),h=Math.cos(n),u=Math.sin(n);if("XYZ"===t.order){const t=s*h,r=s*u,i=o*h,n=o*u;e[0]=a*h,e[4]=-a*u,e[8]=c,e[1]=r+i*c,e[5]=t-n*c,e[9]=-o*a,e[2]=n-t*c,e[6]=i+r*c,e[10]=s*a}else if("YXZ"===t.order){const t=a*h,r=a*u,i=c*h,n=c*u;e[0]=t+n*o,e[4]=i*o-r,e[8]=s*c,e[1]=s*u,e[5]=s*h,e[9]=-o,e[2]=r*o-i,e[6]=n+t*o,e[10]=s*a}else if("ZXY"===t.order){const t=a*h,r=a*u,i=c*h,n=c*u;e[0]=t-n*o,e[4]=-s*u,e[8]=i+r*o,e[1]=r+i*o,e[5]=s*h,e[9]=n-t*o,e[2]=-s*c,e[6]=o,e[10]=s*a}else if("ZYX"===t.order){const t=s*h,r=s*u,i=o*h,n=o*u;e[0]=a*h,e[4]=i*c-r,e[8]=t*c+n,e[1]=a*u,e[5]=n*c+t,e[9]=r*c-i,e[2]=-c,e[6]=o*a,e[10]=s*a}else if("YZX"===t.order){const t=s*a,r=s*c,i=o*a,n=o*c;e[0]=a*h,e[4]=n-t*u,e[8]=i*u+r,e[1]=u,e[5]=s*h,e[9]=-o*h,e[2]=-c*h,e[6]=r*u+i,e[10]=t-n*u}else if("XZY"===t.order){const t=s*a,r=s*c,i=o*a,n=o*c;e[0]=a*h,e[4]=-u,e[8]=c*h,e[1]=t*u+n,e[5]=s*h,e[9]=r*u-i,e[2]=i*u-r,e[6]=o*h,e[10]=n*u+t}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(st,t,ot)}lookAt(t,e,r){const i=this.elements;return ht.subVectors(t,e),0===ht.lengthSq()&&(ht.z=1),ht.normalize(),at.crossVectors(r,ht),0===at.lengthSq()&&(1===Math.abs(r.z)?ht.x+=1e-4:ht.z+=1e-4,ht.normalize(),at.crossVectors(r,ht)),at.normalize(),ct.crossVectors(ht,at),i[0]=at.x,i[4]=ct.x,i[8]=ht.x,i[1]=at.y,i[5]=ct.y,i[9]=ht.y,i[2]=at.z,i[6]=ct.z,i[10]=ht.z,this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const r=t.elements,i=e.elements,n=this.elements,s=r[0],o=r[4],a=r[8],c=r[12],h=r[1],u=r[5],l=r[9],p=r[13],d=r[2],y=r[6],f=r[10],m=r[14],g=r[3],_=r[7],v=r[11],w=r[15],b=i[0],x=i[4],E=i[8],M=i[12],S=i[1],A=i[5],z=i[9],N=i[13],T=i[2],D=i[6],P=i[10],O=i[14],R=i[3],C=i[7],j=i[11],U=i[15];return n[0]=s*b+o*S+a*T+c*R,n[4]=s*x+o*A+a*D+c*C,n[8]=s*E+o*z+a*P+c*j,n[12]=s*M+o*N+a*O+c*U,n[1]=h*b+u*S+l*T+p*R,n[5]=h*x+u*A+l*D+p*C,n[9]=h*E+u*z+l*P+p*j,n[13]=h*M+u*N+l*O+p*U,n[2]=d*b+y*S+f*T+m*R,n[6]=d*x+y*A+f*D+m*C,n[10]=d*E+y*z+f*P+m*j,n[14]=d*M+y*N+f*O+m*U,n[3]=g*b+_*S+v*T+w*R,n[7]=g*x+_*A+v*D+w*C,n[11]=g*E+_*z+v*P+w*j,n[15]=g*M+_*N+v*O+w*U,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){const t=this.elements,e=t[0],r=t[4],i=t[8],n=t[12],s=t[1],o=t[5],a=t[9],c=t[13],h=t[2],u=t[6],l=t[10],p=t[14];return t[3]*(+n*a*u-i*c*u-n*o*l+r*c*l+i*o*p-r*a*p)+t[7]*(+e*a*p-e*c*l+n*s*l-i*s*p+i*c*h-n*a*h)+t[11]*(+e*c*u-e*o*p-n*s*u+r*s*p+n*o*h-r*c*h)+t[15]*(-i*o*h-e*a*u+e*o*l+i*s*u-r*s*l+r*a*h)}transpose(){const t=this.elements;let e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,r){const i=this.elements;return t.isVector3?(i[12]=t.x,i[13]=t.y,i[14]=t.z):(i[12]=t,i[13]=e,i[14]=r),this}invert(){const t=this.elements,e=t[0],r=t[1],i=t[2],n=t[3],s=t[4],o=t[5],a=t[6],c=t[7],h=t[8],u=t[9],l=t[10],p=t[11],d=t[12],y=t[13],f=t[14],m=t[15],g=u*f*c-y*l*c+y*a*p-o*f*p-u*a*m+o*l*m,_=d*l*c-h*f*c-d*a*p+s*f*p+h*a*m-s*l*m,v=h*y*c-d*u*c+d*o*p-s*y*p-h*o*m+s*u*m,w=d*u*a-h*y*a-d*o*l+s*y*l+h*o*f-s*u*f,b=e*g+r*_+i*v+n*w;if(0===b)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const x=1/b;return t[0]=g*x,t[1]=(y*l*n-u*f*n-y*i*p+r*f*p+u*i*m-r*l*m)*x,t[2]=(o*f*n-y*a*n+y*i*c-r*f*c-o*i*m+r*a*m)*x,t[3]=(u*a*n-o*l*n-u*i*c+r*l*c+o*i*p-r*a*p)*x,t[4]=_*x,t[5]=(h*f*n-d*l*n+d*i*p-e*f*p-h*i*m+e*l*m)*x,t[6]=(d*a*n-s*f*n-d*i*c+e*f*c+s*i*m-e*a*m)*x,t[7]=(s*l*n-h*a*n+h*i*c-e*l*c-s*i*p+e*a*p)*x,t[8]=v*x,t[9]=(d*u*n-h*y*n-d*r*p+e*y*p+h*r*m-e*u*m)*x,t[10]=(s*y*n-d*o*n+d*r*c-e*y*c-s*r*m+e*o*m)*x,t[11]=(h*o*n-s*u*n-h*r*c+e*u*c+s*r*p-e*o*p)*x,t[12]=w*x,t[13]=(h*y*i-d*u*i+d*r*l-e*y*l-h*r*f+e*u*f)*x,t[14]=(d*o*i-s*y*i-d*r*a+e*y*a+s*r*f-e*o*f)*x,t[15]=(s*u*i-h*o*i+h*r*a-e*u*a-s*r*l+e*o*l)*x,this}scale(t){const e=this.elements,r=t.x,i=t.y,n=t.z;return e[0]*=r,e[4]*=i,e[8]*=n,e[1]*=r,e[5]*=i,e[9]*=n,e[2]*=r,e[6]*=i,e[10]*=n,e[3]*=r,e[7]*=i,e[11]*=n,this}getMaxScaleOnAxis(){const t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],r=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],i=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,r,i))}makeTranslation(t,e,r){return t.isVector3?this.set(1,0,0,t.x,0,1,0,t.y,0,0,1,t.z,0,0,0,1):this.set(1,0,0,t,0,1,0,e,0,0,1,r,0,0,0,1),this}makeRotationX(t){const e=Math.cos(t),r=Math.sin(t);return this.set(1,0,0,0,0,e,-r,0,0,r,e,0,0,0,0,1),this}makeRotationY(t){const e=Math.cos(t),r=Math.sin(t);return this.set(e,0,r,0,0,1,0,0,-r,0,e,0,0,0,0,1),this}makeRotationZ(t){const e=Math.cos(t),r=Math.sin(t);return this.set(e,-r,0,0,r,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){const r=Math.cos(e),i=Math.sin(e),n=1-r,s=t.x,o=t.y,a=t.z,c=n*s,h=n*o;return this.set(c*s+r,c*o-i*a,c*a+i*o,0,c*o+i*a,h*o+r,h*a-i*s,0,c*a-i*o,h*a+i*s,n*a*a+r,0,0,0,0,1),this}makeScale(t,e,r){return this.set(t,0,0,0,0,e,0,0,0,0,r,0,0,0,0,1),this}makeShear(t,e,r,i,n,s){return this.set(1,r,n,0,t,1,s,0,e,i,1,0,0,0,0,1),this}compose(t,e,r){const i=this.elements,n=e._x,s=e._y,o=e._z,a=e._w,c=n+n,h=s+s,u=o+o,l=n*c,p=n*h,d=n*u,y=s*h,f=s*u,m=o*u,g=a*c,_=a*h,v=a*u,w=r.x,b=r.y,x=r.z;return i[0]=(1-(y+m))*w,i[1]=(p+v)*w,i[2]=(d-_)*w,i[3]=0,i[4]=(p-v)*b,i[5]=(1-(l+m))*b,i[6]=(f+g)*b,i[7]=0,i[8]=(d+_)*x,i[9]=(f-g)*x,i[10]=(1-(l+y))*x,i[11]=0,i[12]=t.x,i[13]=t.y,i[14]=t.z,i[15]=1,this}decompose(t,e,r){const i=this.elements;let n=it.set(i[0],i[1],i[2]).length();const s=it.set(i[4],i[5],i[6]).length(),o=it.set(i[8],i[9],i[10]).length();this.determinant()<0&&(n=-n),t.x=i[12],t.y=i[13],t.z=i[14],nt.copy(this);const a=1/n,c=1/s,h=1/o;return nt.elements[0]*=a,nt.elements[1]*=a,nt.elements[2]*=a,nt.elements[4]*=c,nt.elements[5]*=c,nt.elements[6]*=c,nt.elements[8]*=h,nt.elements[9]*=h,nt.elements[10]*=h,e.setFromRotationMatrix(nt),r.x=n,r.y=s,r.z=o,this}makePerspective(t,e,r,i,n,s,o=2e3){const a=this.elements,c=2*n/(e-t),h=2*n/(r-i),u=(e+t)/(e-t),l=(r+i)/(r-i);let p,d;if(o===rt)p=-(s+n)/(s-n),d=-2*s*n/(s-n);else{if(2001!==o)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+o);p=-s/(s-n),d=-s*n/(s-n)}return a[0]=c,a[4]=0,a[8]=u,a[12]=0,a[1]=0,a[5]=h,a[9]=l,a[13]=0,a[2]=0,a[6]=0,a[10]=p,a[14]=d,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(t,e,r,i,n,s,o=2e3){const a=this.elements,c=1/(e-t),h=1/(r-i),u=1/(s-n),l=(e+t)*c,p=(r+i)*h;let d,y;if(o===rt)d=(s+n)*u,y=-2*u;else{if(2001!==o)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+o);d=n*u,y=-1*u}return a[0]=2*c,a[4]=0,a[8]=0,a[12]=-l,a[1]=0,a[5]=2*h,a[9]=0,a[13]=-p,a[2]=0,a[6]=0,a[10]=y,a[14]=-d,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(t){const e=this.elements,r=t.elements;for(let t=0;t<16;t++)if(e[t]!==r[t])return!1;return!0}fromArray(t,e=0){for(let r=0;r<16;r++)this.elements[r]=t[r+e];return this}toArray(t=[],e=0){const r=this.elements;return t[e]=r[0],t[e+1]=r[1],t[e+2]=r[2],t[e+3]=r[3],t[e+4]=r[4],t[e+5]=r[5],t[e+6]=r[6],t[e+7]=r[7],t[e+8]=r[8],t[e+9]=r[9],t[e+10]=r[10],t[e+11]=r[11],t[e+12]=r[12],t[e+13]=r[13],t[e+14]=r[14],t[e+15]=r[15],t}}const it=new Vector3_Vector3,nt=new Matrix4_Matrix4,st=new Vector3_Vector3(0,0,0),ot=new Vector3_Vector3(1,1,1),at=new Vector3_Vector3,ct=new Vector3_Vector3,ht=new Vector3_Vector3,ut=new Matrix4_Matrix4,lt=new Quaternion_Quaternion;class Euler_Euler{constructor(t=0,e=0,r=0,i=Euler_Euler.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=e,this._z=r,this._order=i}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,e,r,i=this._order){return this._x=t,this._y=e,this._z=r,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,e=this._order,r=!0){const i=t.elements,n=i[0],s=i[4],o=i[8],a=i[1],c=i[5],h=i[9],u=i[2],l=i[6],p=i[10];switch(e){case"XYZ":this._y=Math.asin(H(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-h,p),this._z=Math.atan2(-s,n)):(this._x=Math.atan2(l,c),this._z=0);break;case"YXZ":this._x=Math.asin(-H(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(o,p),this._z=Math.atan2(a,c)):(this._y=Math.atan2(-u,n),this._z=0);break;case"ZXY":this._x=Math.asin(H(l,-1,1)),Math.abs(l)<.9999999?(this._y=Math.atan2(-u,p),this._z=Math.atan2(-s,c)):(this._y=0,this._z=Math.atan2(a,n));break;case"ZYX":this._y=Math.asin(-H(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(l,p),this._z=Math.atan2(a,n)):(this._x=0,this._z=Math.atan2(-s,c));break;case"YZX":this._z=Math.asin(H(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-h,c),this._y=Math.atan2(-u,n)):(this._x=0,this._y=Math.atan2(o,p));break;case"XZY":this._z=Math.asin(-H(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(l,c),this._y=Math.atan2(o,n)):(this._x=Math.atan2(-h,p),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,!0===r&&this._onChangeCallback(),this}setFromQuaternion(t,e,r){return ut.makeRotationFromQuaternion(t),this.setFromRotationMatrix(ut,e,r)}setFromVector3(t,e=this._order){return this.set(t.x,t.y,t.z,e)}reorder(t){return lt.setFromEuler(this),this.setFromQuaternion(lt,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}function pt(t,e){return void 0===e&&(e={}),function(r,i){var n,s="@jsonArrayMember on "+(0,z.$0)(r.constructor)+"."+String(i),c=(0,N.JD)(t,s),h=null==e.dimensions?1:e.dimensions;if(!isNaN(h)&&h<1)(0,z.H)(s+": 'dimensions' option must be at least 1.");else{var u=z.df?Reflect.getMetadata("design:type",r,i):null;null==u||u===Array||u===Object?(0,o.d3)(r,i,{type:function(){return dt((0,N._k)(c()),h)},emitDefaultValue:e.emitDefaultValue,isRequired:e.isRequired,options:(0,a.M3)(e),key:i.toString(),name:null!==(n=e.name)&&void 0!==n?n:i.toString(),deserializer:e.deserializer,serializer:e.serializer}):(0,z.H)(s+": property is not an Array. "+z.AZ)}}}function dt(t,e){for(var r=new N.GJ(t),i=1;i<e;++i)r=new N.GJ(r);return r}function yt(t,e){return(r,i)=>{const n=(0,p.W5)(r,i,e);pt(t,n)(r,i),(0,p.EB)(r,i,n)}}Euler_Euler.DEFAULT_ORDER="XYZ";let ft=class Matrix4 extends Matrix4_Matrix4{static round(t,e=0){const r=Math.pow(10,e);return t.elements.forEach(((e,i)=>{t.elements[i]=Math.round(e*r)/r})),t}static fromArray(t){const e=new this;return e.fromArray([].concat(...t)),e.transpose(),e}static rotationFromQuaternion(t){const e=new this;return e.makeRotationFromQuaternion(t),e}static rotationFromEuler(t){const e=new this;return e.makeRotationFromEuler(t),e}static rotationFromAxisAngle(t,e){const r=new this;return r.makeRotationAxis(t,e),r}clone(){return(new this.constructor).fromArray(this.elements)}};var mt;(0,n.gn)([yt(Number,{numberType:$.DECIMAL}),(0,n.w6)("design:type",Array)],ft.prototype,"elements",void 0),ft=(0,n.gn)([d()],ft);let gt=mt=class Euler extends Euler_Euler{constructor(t,e,r,i,n){super(t,e,r,i),n&&(this.x=n.convert(this.x,U.RADIAN),this.y=n.convert(this.y,U.RADIAN),this.z=n.convert(this.z,U.RADIAN))}static fromQuaternion(t,e="XYZ"){const r=new mt;return r.setFromQuaternion(t,e),r}static fromRotationMatrix(t,e="XYZ"){const r=new mt;return r.setFromRotationMatrix(t,e),r}toVector(t=U.RADIAN){return new W(U.RADIAN.convert(this.x,t),U.RADIAN.convert(this.y,t),U.RADIAN.convert(this.z,t))}toVector3(t){return this.toVector(t)}toRotationMatrix(){return ft.rotationFromEuler(this)}get pitch(){return U.RADIAN.convert(this.y,U.DEGREE)}get roll(){return U.RADIAN.convert(this.x,U.DEGREE)}get yaw(){return U.RADIAN.convert(this.z,U.DEGREE)}clone(){return(new this.constructor).copy(this)}};var _t;(0,n.gn)([(0,s._)({numberType:$.DECIMAL}),(0,n.w6)("design:type",Number)],gt.prototype,"x",void 0),(0,n.gn)([(0,s._)({numberType:$.DECIMAL}),(0,n.w6)("design:type",Number)],gt.prototype,"y",void 0),(0,n.gn)([(0,s._)({numberType:$.DECIMAL}),(0,n.w6)("design:type",Number)],gt.prototype,"z",void 0),gt=mt=(0,n.gn)([d(),(0,n.w6)("design:paramtypes",[Number,Number,Number,String,U])],gt);let vt=_t=class AxisAngle extends W{constructor(t,e,r,i=null,n=U.RADIAN){super(n.convert(t||0,U.RADIAN),n.convert(e||0,U.RADIAN),n.convert(r||0,U.RADIAN)),null!==i?this.angle=n.convert(i,U.RADIAN):(this.angle=Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2)+Math.pow(this.z,2)),this.normalize())}static fromQuaternion(t){const e=new _t;if(e.angle=2*Math.acos(t.w),1-t.w*t.w<1e-6)e.x=t.x,e.y=t.y,e.z=t.z;else{const r=Math.sqrt(1-t.w*t.w);e.x=t.x/r,e.y=t.y/r,e.z=t.z/r}return e}toRotationMatrix(){return ft.rotationFromAxisAngle(this,this.angle)}clone(){const t=new this.constructor;return t.angle=this.angle,t}};(0,n.gn)([(0,s._)({numberType:$.DOUBLE}),(0,n.w6)("design:type",Number)],vt.prototype,"angle",void 0),vt=_t=(0,n.gn)([d(),(0,n.w6)("design:paramtypes",[Number,Number,Number,Number,U])],vt);let wt=class Quaternion extends Quaternion_Quaternion{static fromThreeJS(t){const e=new this;return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}static fromEuler(t){const e=new this;return t instanceof gt?e.setFromEuler(t):t instanceof W?e.setFromEuler(new gt(t.x,t.y,t.z)):t instanceof Array?e.setFromEuler(new gt(t[0],t[1],t[2])):void 0===t.yaw?e.setFromEuler(new gt(t.x,t.y,t.z,t.order,t.unit)):e.setFromEuler(new gt(t.roll,t.pitch,t.yaw,"ZYX",t.unit)),e}static fromAxisAngle(t){const e=new this;if(t instanceof vt)e.setFromAxisAngle(new W(t.x,t.y,t.z),t.angle);else if(t instanceof Array){const r=new vt(t[0],t[1],t[2],4===t.length?t[3]:null);e.setFromAxisAngle(r,r.angle)}else{const r=new vt(t.x,t.y,t.z,t.angle?t.angle:null,t.unit);e.setFromAxisAngle(r,r.angle)}return e}static fromRotationMatrix(t){const e=new this;return e.setFromRotationMatrix(t),e}toEuler(t){return gt.fromQuaternion(this,t)}toAxisAngle(){return vt.fromQuaternion(this)}toRotationMatrix(){return ft.rotationFromQuaternion(this)}clone(){return(new this.constructor).copy(this)}};var bt;(0,n.gn)([(0,s._)({numberType:$.DECIMAL}),(0,n.w6)("design:type",Number)],wt.prototype,"x",void 0),(0,n.gn)([(0,s._)({numberType:$.DECIMAL}),(0,n.w6)("design:type",Number)],wt.prototype,"y",void 0),(0,n.gn)([(0,s._)({numberType:$.DECIMAL}),(0,n.w6)("design:type",Number)],wt.prototype,"z",void 0),(0,n.gn)([(0,s._)({numberType:$.DECIMAL}),(0,n.w6)("design:type",Number)],wt.prototype,"w",void 0),wt=(0,n.gn)([d()],wt);let xt=bt=class Orientation extends wt{constructor(t,e,r,i,n){super(t,e,r,i),this.accuracy=n||new J(0,U.RADIAN),this.timestamp=B.now()}static fromQuaternion(t){return new bt(t.x,t.y,t.z,t.w)}clone(){const t=super.clone();return t.accuracy=this.accuracy?this.accuracy.clone():void 0,t.timestamp=this.timestamp,t}};var Et;(0,n.gn)([(0,s._)({isRequired:!1,numberType:$.LONG}),(0,n.w6)("design:type",Number)],xt.prototype,"timestamp",void 0),(0,n.gn)([(0,s._)({isRequired:!1}),(0,n.w6)("design:type",K)],xt.prototype,"accuracy",void 0),xt=bt=(0,n.gn)([d(),(0,n.w6)("design:paramtypes",[Number,Number,Number,Number,K])],xt);let Mt=Et=class GCS extends y{static get EARTH_RADIUS(){return Et.EARTH_RADIUS_MEAN}};function St(t,e){const r=U.DEGREE.convert(t[1],U.RADIAN),i=U.DEGREE.convert(e[1],U.RADIAN),n=U.DEGREE.convert(e[1]-t[1],U.RADIAN),s=U.DEGREE.convert(e[0]-t[0],U.RADIAN),o=Math.sin(n/2)*Math.sin(n/2)+Math.cos(r)*Math.cos(i)*Math.sin(s/2)*Math.sin(s/2),a=2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o));return Mt.EARTH_RADIUS_MEAN*a}function At(t,e){let r=0;for(let i=0;i<t.length;i++)r+=Math.pow(t[i]-e[i],2);return r=Math.sqrt(r),r}function zt(t,e){let r=0;for(let i=0;i<t.length;i++)r+=Math.abs(t[i]-e[i]);return r}function Nt(t,e){let r=0;for(let i=0;i<t.length;i++)r+=Math.abs(t[i]-e[i])/(Math.abs(t[i])+Math.abs(e[i]));return r}function Tt(t,e){let r=0;for(let i=0;i<t.length;i++)r=Math.max(r,Math.abs(t[i]-e[i]));return r}Mt.EARTH_RADIUS_MEAN=6371008.7714,Mt.EARTH_EQUATORIAL_RADIUS=6378137,Mt.EARTH_POLAR_RADIUS=6356752.3142,Mt.EARTH_ECCENTRICITY=.081819190842622,Mt.EPSG4326=new Et("EPSG:4326",{baseName:"gcs",aliases:["WGS84","World Geodetic System"]}),Mt.WGS84=Et.EPSG4326,Mt.ECEF=new Et("ECEF",{baseName:"gcs",aliases:["earth-centered, earth-fixed","ECR","earth centered rotational"],definitions:[{unit:"EPSG:4326",toUnit:t=>{const e=Et.EARTH_EQUATORIAL_RADIUS,r=e-1/298.257223563*e,i=Math.sqrt(Math.pow(e,2)-Math.pow(r,2))/e,n=Math.atan2(t.y,t.x),s=Math.sqrt(Math.pow(t.x,2)+Math.pow(t.y,2));let o=0,a=Math.atan2(t.z,s*(1-Math.pow(i,2))),c=Math.cos(a),h=Math.sin(a),u=Math.pow(e,2)/Math.sqrt(Math.pow(e*c,2)+Math.pow(r*h,2)),l=s/c-u;for(;Math.abs(l-o)>1e-6;)o=l,a=Math.atan2(t.z,s*(1-Math.pow(i,2)*u/(u+l))),c=Math.cos(a),h=Math.sin(a),u=Math.pow(e,2)/Math.sqrt(Math.pow(e*c,2)+Math.pow(r*h,2)),l=s/c-u;return new W(U.RADIAN.convert(n,U.DEGREE),U.RADIAN.convert(a,U.DEGREE),l)},fromUnit:t=>{var e;const r=U.DEGREE.convert(t.y,U.RADIAN),i=U.DEGREE.convert(t.x,U.RADIAN),n=null!==(e=t.z)&&void 0!==e?e:0,s=Math.cos(r),o=Math.sin(r),a=Math.cos(i),c=Math.sin(i),h=Et.EARTH_EQUATORIAL_RADIUS/Math.sqrt(1-Math.pow(Et.EARTH_ECCENTRICITY,2)*Math.pow(o,2));return new W((h+n)*s*a,(h+n)*s*c,(h*(1-Math.pow(Et.EARTH_ECCENTRICITY,2))+n)*o)}}]}),Mt.EPSG3857=new Et("EPSG:3857",{baseName:"gcs",aliases:["pseudo mercator","web mercator"],definitions:[{unit:"EPSG:4326",fromUnit:t=>new W(20037508.34*t.x/180,Math.log(Math.tan((90+t.y)*Math.PI/360))/(Math.PI/180)*20037508.34/180,0),toUnit:t=>new W(180*t.x/20037508.34,360*Math.atan(Math.exp(t.y*Math.PI/20037508.34))/Math.PI-90,t.z)}]}),Mt=Et=(0,n.gn)([d()],Mt);let Dt=class AbsolutePosition{constructor(){this.timestamp=B.now(),this.velocity=new et,this.unit=R.METER}get probability(){return this._probability?this._probability:1/this.accuracy.valueOf()}set probability(t){if(t>1||t<0)throw new Error(`${this.constructor.name} should be between 0 and 1.`);this._probability=t}get accuracy(){return this._accuracy||(this._accuracy=new J(1,this.unit)),this._accuracy}set accuracy(t){if(!t)throw new Error("Accuracy can not be undefined!");this._accuracy=t}get linearVelocity(){if(this.velocity)return this.velocity.linear}set linearVelocity(t){this.velocity||(this.velocity=new et),this.velocity.linear=t}get angularVelocity(){if(this.velocity)return this.velocity.angular}set angularVelocity(t){this.velocity||(this.velocity=new et),this.velocity.angular=t}setAccuracy(t,e){return this.accuracy="number"==typeof t?new J(t,e||this.unit):t,this}distanceTo(t,e=At){return e(this.toVector3().toArray(),t.toVector3().toArray())}equals(t){return this.toVector3(this.unit).equals(t.toVector3(this.unit))}clone(){const t=new this.constructor;return t.unit=this.unit,t._accuracy=this._accuracy?this._accuracy.clone():void 0,t.orientation=this.orientation?this.orientation.clone():void 0,t.velocity=this.velocity?this.velocity.clone():void 0,t.timestamp=this.timestamp,t.referenceSpaceUID=this.referenceSpaceUID,t}};(0,n.gn)([(0,s._)({index:!0,numberType:$.LONG}),(0,n.w6)("design:type",Number)],Dt.prototype,"timestamp",void 0),(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",et)],Dt.prototype,"velocity",void 0),(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",xt)],Dt.prototype,"orientation",void 0),(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",R)],Dt.prototype,"unit",void 0),(0,n.gn)([(0,s._)({index:!0}),(0,n.w6)("design:type",String)],Dt.prototype,"referenceSpaceUID",void 0),(0,n.gn)([(0,s._)({name:"accuracy"}),(0,n.w6)("design:type",K)],Dt.prototype,"_accuracy",void 0),(0,n.gn)([(0,s._)({name:"probability",numberType:$.DECIMAL}),(0,n.w6)("design:type",Number)],Dt.prototype,"_probability",void 0),Dt=(0,n.gn)([d()],Dt);let Pt=class RelativePosition{get probability(){return this._probability?this._probability:1/this.accuracy.valueOf()}set probability(t){if(t>1||t<0)throw new Error(`${this.constructor.name} should be between 0 and 1.`);this._probability=t}get accuracy(){return this._accuracy||(this._accuracy=new J(1,this._defaultUnit)),this._accuracy}set accuracy(t){if(!t)throw new Error("Accuracy can not be undefined!");this.accuracy=t}constructor(t,e,r){this.timestamp=B.now(),void 0!==t&&(t instanceof String||"string"==typeof t?this.referenceObjectUID=t:(this.referenceObjectType=t.constructor.name,this.referenceObjectUID=t.uid)),this._defaultUnit=r||y.UNKNOWN,this.referenceValue=e}setAccuracy(t,e){return this.accuracy="number"==typeof t?new J(t,e||this._defaultUnit):t,this}equals(t){return this.timestamp===t.timestamp}clone(){return u.C.clone(this)}};var Ot;(0,n.gn)([(0,s._)({index:!0,numberType:$.LONG}),(0,n.w6)("design:type",Number)],Pt.prototype,"timestamp",void 0),(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",String)],Pt.prototype,"referenceObjectUID",void 0),(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",String)],Pt.prototype,"referenceObjectType",void 0),(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",Object)],Pt.prototype,"referenceValue",void 0),(0,n.gn)([(0,s._)({name:"accuracy"}),(0,n.w6)("design:type",K)],Pt.prototype,"_accuracy",void 0),(0,n.gn)([(0,s._)({name:"probability",numberType:$.DECIMAL}),(0,n.w6)("design:type",Number)],Pt.prototype,"_probability",void 0),(0,n.gn)([(0,s._)((()=>y)),(0,n.w6)("design:type",Object)],Pt.prototype,"unit",void 0),Pt=(0,n.gn)([d(),(0,n.w6)("design:paramtypes",[Object,Object,Object])],Pt);let Rt=Ot=class DataObject{constructor(t=E(),e){this._relativePositions=new Map,this.uid=t,this.createdTimestamp=B.now(),this.displayName=e}get position(){return this.getPosition()}set position(t){this.setPosition(t)}getPosition(t){return void 0!==t&&void 0!==this._position?t.transform(this._position,{inverse:!0}):this._position}setPosition(t,e){return this._position=e?e.transform(t,{inverse:!1}):t,this}setUID(t){return this.uid=t,this}get relativePositions(){const t=[];return void 0!==this._relativePositions&&this._relativePositions.forEach((e=>{e.forEach((e=>{t.push(e)}))})),t}set relativePositions(t){this._relativePositions=new Map,t.forEach((t=>{this.addRelativePosition(t)}))}setParent(t){return this.parentUID=t instanceof Ot?t.uid:t,this}removeRelativePositions(t){this._relativePositions.delete(t)}addRelativePosition(t){return t&&void 0!==t.referenceObjectUID?(this._relativePositions.has(t.referenceObjectUID)||this._relativePositions.set(t.referenceObjectUID,new Map),this._relativePositions.get(t.referenceObjectUID).set(t.constructor.name,t),this):this}getRelativePositions(t){return void 0===t?this.relativePositions:this._relativePositions.has(t)?Array.from(this._relativePositions.get(t).values()):[]}getRelativePosition(t,e){if(this._relativePositions.has(t)){const r=this._relativePositions.get(t);return e?r.get(e):Array.from(r.values())[0]}}hasRelativePosition(t){return this._relativePositions.has(t)}bind(t){return new DataObjectBinding(this,t)}clone(t){return u.C.clone(this,t)}};(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",String)],Rt.prototype,"displayName",void 0),(0,n.gn)([(0,s._)({index:!0,numberType:$.LONG}),(0,n.w6)("design:type",Number)],Rt.prototype,"createdTimestamp",void 0),(0,n.gn)([(0,s._)({primaryKey:!0}),(0,n.w6)("design:type",String)],Rt.prototype,"uid",void 0),(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",String)],Rt.prototype,"parentUID",void 0),(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",Dt),(0,n.w6)("design:paramtypes",[Dt])],Rt.prototype,"position",null),(0,n.gn)([yt(Pt),(0,n.w6)("design:type",Array),(0,n.w6)("design:paramtypes",[Array])],Rt.prototype,"relativePositions",null),Rt=Ot=(0,n.gn)([d(),(0,n.w6)("design:paramtypes",[String,String])],Rt);class DataObjectBinding extends M.EventEmitter{constructor(t,e){super(),this.target=t,this.service=e,this.service.on("insert",this._onInsert.bind(this))}_onInsert(t,e){this.target.uid===t&&(this.emit("update",this.target,e),this.target=e)}on(t,e){return super.on(t,e)}save(){return this.service.insert(this.target.uid,this.target)}delete(){return this.service.delete(this.target.uid)}dispose(){this.service.removeListener("update",this._onInsert.bind(this))}}let Ct=class SourceNode extends A{constructor(t){super(t),this.options.persistence=void 0===this.options.persistence||this.options.persistence,this.on("push",this._onPush.bind(this)),this.on("pull",this._onPull.bind(this)),this.source&&this.once("build",this.registerService.bind(this))}get source(){return this.options.source}registerService(){return new Promise((t=>{const e=this.model.findDataService(this.source);e.on("insert",((t,e)=>{t===this.source.uid&&(this.options.source=e)})),e.findByUID(this.source.uid).then((e=>{this.options.source=e,t()})).catch((()=>{t()}))}))}_onPush(t,e){return new Promise(((r,i)=>{const n=[];if(this.options.persistence)if(t instanceof Array)for(const e of t)n.push(this.mergeFrame(e));else n.push(this.mergeFrame(t));Promise.all(n).then((()=>{this.outlets.map((r=>r.push(t,e))),r()})).catch(i)}))}mergeFrame(t){return new Promise(((e,r)=>{const i=this.model.findDataService(Rt),n=[],s=[];t.getObjects().forEach((t=>{s.push(t)})),s.forEach((t=>{n.push(new Promise((e=>{let r=this.model.findDataService(t);null==r&&(r=i),r.findByUID(t.uid).then((r=>{null===r&&e(),this.mergeObject(t,r),e()})).catch((()=>{e()}))})))})),Promise.all(n).then((()=>{e(t)})).catch(r)}))}mergeObject(t,e){return t.displayName=t.displayName||e.displayName,t.position=t.position||e.position,t.parentUID=t.parentUID||e.parentUID,e.relativePositions.forEach((e=>{const r=t.getRelativePosition(e.referenceObjectUID,e.constructor.name);r&&r.timestamp<e.timestamp?t.addRelativePosition(e):r||t.addRelativePosition(e)})),t}_onPull(t={}){if(t.sourceNode&&t.sourceNode!==this.uid)return Promise.resolve();return void 0===t.sequentialPull||t.sequentialPull?this._onSequentialPull(t):this._onParallelPull(t)}_onSequentialPull(t){const e=Object.assign({sourceNode:this.uid},t),r=t.count||1;let i=Promise.resolve();for(let n=0;n<r;n++)i=i.then((()=>new Promise(((r,i)=>{this.onPull(t).then((t=>{if(null!=t)return this.push(t,e);r()})).then(r).catch(i)}))));return i}_onParallelPull(t){return new Promise(((e,r)=>{const i=Object.assign({sourceNode:this.uid},t),n=t.count||1;Promise.all([...Array(n).keys()].map((()=>this.onPull(t)))).then((t=>{const e=[];return t.forEach((t=>{null!=t&&e.push(this.push(t,i))})),Promise.all(e)})).then((()=>{e()})).catch(r)}))}};(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",Object)],Ct.prototype,"options",void 0),Ct=(0,n.gn)([d(),(0,n.w6)("design:paramtypes",[Object])],Ct);class GraphValidator{static validate(t){this.validateNodes(t),this.validateEdges(t)}static _validateInternalNode(t,e){if(0===e.outlets.length&&0===e.inlets.length)t.deleteNode(e);else if(!t.findNodeByUID(e.uid))throw new Error(`Internal node ${e.uid} (${e.name}) is not connected to the graph!`)}static validateNodes(t){GraphValidator._validateInternalNode(t,t.internalSource),GraphValidator._validateInternalNode(t,t.internalSink),t.nodes.forEach((t=>{if(void 0===t.graph)throw new Error(`Node ${t.uid} (${t.name}) does not have a graph set!`);if(0===t.inlets.length&&0===t.outlets.length)throw new Error(`Node ${t.uid} (${t.name}) is not connected to the graph!`)}))}static validateEdges(t){t.edges.forEach((e=>{if(!t.findNodeByUID(e.inputNode.uid))throw new Error(`Node ${e.inputNode.uid} (${e.inputNode.name}) is used in an edge but not added to the graph!`);if(!t.findNodeByUID(e.outputNode.uid))throw new Error(`Node ${e.outputNode.uid} (${e.outputNode.name}) is used in an edge but not added to the graph!`)}))}}class GraphBuilder{constructor(t=new P){this.graph=t,this.graph.name="graph"}static create(){return new GraphBuilder}on(t,e){return this.graph.once(t,e),this}from(...t){const e=[];return t.forEach((t=>{if(void 0===t)throw new Error("Undefined node was provided as a source!");if("string"==typeof t){let r=this.graph.findNodeByUID(t)||this.graph.findNodeByName(t);void 0===r&&(r=new PlaceholderNode(t)),this.graph.addNode(r),e.push(r)}else this.graph.addNode(t),t instanceof Ct&&this.graph.addEdge(new Edge(this.graph.internalSource,t)),e.push(t)})),new GraphShapeBuilder(this,this.graph,0===e.length?[this.graph.internalSource]:e)}addNode(t){return this.graph.addNode(t),this}addEdge(t){return this.graph.addEdge(t),this}deleteEdge(t){return this.graph.deleteEdge(t),this}deleteNode(t){return this.graph.deleteNode(t),this}addShape(t){let e;return e=t instanceof GraphBuilder?t.graph:t,e.nodes.forEach((t=>{if(t instanceof PlaceholderNode){const r=this.graph.findNodeByUID(t.name)||this.graph.findNodeByName(t.name);if(r){const i=e.edges.filter((e=>e.inputNode===t)),n=e.edges.filter((e=>e.outputNode===t));i.map((t=>t.inputNode=r)),n.map((t=>t.outputNode=r)),this.addNode(r)}else this.addNode(t)}else this.addNode(t)})),e.edges.forEach((t=>{this.addEdge(t)})),this.graph.addEdge(new Edge(this.graph.internalSource,e.internalSource)),this.graph.addEdge(new Edge(e.internalSink,this.graph.internalSink)),this}build(){return new Promise(((t,e)=>{GraphValidator.validate(this.graph),this.graph.once("ready",(()=>{t(this.graph)})),this.graph.emitAsync("build",this).catch((t=>{this.graph.emit("destroy"),e(t)}))}))}}class GraphShapeBuilder{constructor(t,e,r){this.graphBuilder=t,this.previousNodes=r,this.graph=e}viaGraph(t){return t.nodes.forEach((t=>{t.graph=this.graph,this.graph.addNode(t)})),t.edges.forEach((t=>{this.graph.addEdge(t)})),this._insertNode(t.internalSource),t.internalSink}via(...t){const e=[];return t.forEach((t=>{if(void 0===t)throw new Error("Undefined node was provided!");if(t instanceof GraphBuilder)e.push(this.viaGraph(t.graph));else if(t instanceof P)e.push(this.viaGraph(t));else{let r;"string"==typeof t?(r=this.graph.findNodeByUID(t)||this.graph.findNodeByName(t),void 0===r&&(r=new PlaceholderNode(t))):r=t,this.graph.addNode(r),this._insertNode(r),e.push(r)}})),this.previousNodes=e,this}_insertNode(t){this.previousNodes.forEach((e=>{this.graph.addEdge(new Edge(e,t))}))}static registerShape(t,e){GraphShapeBuilder.shapes.set(t,e)}chunk(t,e,r){return this.via(GraphShapeBuilder.shapes.get("chunk")(t,e,r))}flatten(){return this.via(GraphShapeBuilder.shapes.get("flatten")())}filter(t){return this.via(GraphShapeBuilder.shapes.get("filter")(t))}filterObjects(t){return this.via(GraphShapeBuilder.shapes.get("filterObjects")(t))}merge(t=(()=>!0),e=100,r=m.MILLISECOND){return this.via(GraphShapeBuilder.shapes.get("merge")(t,e,r))}debounce(t=100,e=m.MILLISECOND){return this.via(GraphShapeBuilder.shapes.get("debounce")(t,e))}delay(t=100,e=m.MILLISECOND){return this.via(GraphShapeBuilder.shapes.get("delay")(t,e))}clone(){return this.via(GraphShapeBuilder.shapes.get("clone")())}convertToSpace(t){return this.via(GraphShapeBuilder.shapes.get("convertToSpace")(t))}convertFromSpace(t){return this.via(GraphShapeBuilder.shapes.get("convertFromSpace")(t))}buffer(){return this.via(GraphShapeBuilder.shapes.get("buffer")())}store(){return this.to(GraphShapeBuilder.shapes.get("store")())}to(...t){if(0!==t.length){const e=[];t.forEach((t=>{let r;if(void 0===t)throw new Error("Undefined node was provided as a sink!");"string"==typeof t?(r=this.graph.findNodeByUID(t)||this.graph.findNodeByName(t),void 0===r&&(r=new PlaceholderNode(t))):r=t,this.graph.addNode(r),this._insertNode(r),this.graph.addEdge(new Edge(r,this.graph.internalSink)),e.push(r)})),this.previousNodes=e}else this._insertNode(this.graph.internalSink);return this.graphBuilder}}GraphShapeBuilder.shapes=new Map;let jt=class UnitValue{constructor(t,e){this._value=t,this._unit=e}to(t){if(!t)throw new Error(`${this.constructor.name} does not have a unit to convert from!`);const e=this.unit.convert(this.valueOf(),t);return new this.constructor(e,t)}get unit(){return this._unit}toString(){const t=this.valueOf();return t?t.toString():void 0}valueOf(){return this._value}setValue(t){return this._value=t,this}clone(){const t=new this.constructor;return t._value=this._value,t._unit=this._unit,t}};var Ut;(0,n.gn)([(0,s._)({name:"value"}),(0,n.w6)("design:type",Object)],jt.prototype,"_value",void 0),(0,n.gn)([(0,s._)({name:"unit"}),(0,n.w6)("design:type",Object)],jt.prototype,"_unit",void 0),jt=(0,n.gn)([d(),(0,n.w6)("design:paramtypes",[Object,Object])],jt);let kt=Ut=class AccelerationUnit extends C{};var It;kt.METER_PER_SECOND_SQUARE=new Ut("meter per second squared",{baseName:"acceleration",aliases:["m/s^2","m/s2","meters per second squared"]}).addUnit(R.METER,1).addUnit(m.SECOND,-2),kt.GRAVITATIONAL_FORCE=new Ut("gravitational force",{baseName:"acceleration",aliases:["g-force","G","GS"],definitions:[{magnitude:9.78033,unit:"m/s^2"}]}),kt=Ut=(0,n.gn)([d()],kt);let Lt=It=class MagnetismUnit extends y{};var Vt;Lt.TESLA=new It("tesla",{baseName:"magnetism",aliases:["T"],prefixes:"decimal"}),Lt.MICROTESLA=It.TESLA.specifier(UnitPrefix.MICRO),Lt=It=(0,n.gn)([d()],Lt);let Ft=Vt=class TemperatureUnit extends y{};var Bt;Ft.CELCIUS=new Vt("celcius",{baseName:"temperature"}),Ft.FAHRENHEIT=new Vt("fahrenheit",{baseName:"temperature",definitions:[{unit:"celcius",offset:-32,magnitude:5/9}]}),Ft.KELVIN=new Vt("kelvin",{baseName:"temperature",definitions:[{unit:"celcius",offset:-273.15}]}),Ft.RANKINE=new Vt("rankine",{baseName:"temperature",definitions:[{unit:"kelvin",magnitude:1/1.8}]}),Ft=Vt=(0,n.gn)([d()],Ft);let $t=Bt=class LuminanceIntensityUnit extends y{};var Ht;$t.CANDELA=new Bt("candela",{baseName:"luminanceintensity",aliases:["cd"]}),$t=Bt=(0,n.gn)([d()],$t);let Gt=Ht=class LuminanceUnit extends y{};var qt;Gt.LUMEN=new Ht("lumen",{baseName:"luminance",aliases:["lm"],prefixes:"decimal"}),Gt=Ht=(0,n.gn)([d()],Gt);let Wt=qt=class PressureUnit extends y{};Wt.PASCAL=new qt("pascal",{baseName:"pressure",aliases:["P"],prefixes:"decimal"}),Wt=qt=(0,n.gn)([d()],Wt);class Vector2_Vector2{constructor(t=0,e=0){Vector2_Vector2.prototype.isVector2=!0,this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const e=this.x,r=this.y,i=t.elements;return this.x=i[0]*e+i[3]*r+i[6],this.y=i[1]*e+i[4]*r+i[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this}clampLength(t,e){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(t,Math.min(e,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;const r=this.dot(t)/e;return Math.acos(H(r,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,r=this.y-t.y;return e*e+r*r}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,r){return this.x=t.x+(e.x-t.x)*r,this.y=t.y+(e.y-t.y)*r,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){const r=Math.cos(e),i=Math.sin(e),n=this.x-t.x,s=this.y-t.y;return this.x=n*r-s*i+t.x,this.y=n*i+s*r+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}let Kt=class Vector2 extends Vector2_Vector2{static fromArray(t){return(new this).fromArray(t)}clone(){return(new this.constructor).copy(this)}};(0,n.gn)([(0,s._)({numberType:$.DECIMAL}),(0,n.w6)("design:type",Number)],Kt.prototype,"x",void 0),(0,n.gn)([(0,s._)({numberType:$.DECIMAL}),(0,n.w6)("design:type",Number)],Kt.prototype,"y",void 0),Kt=(0,n.gn)([d()],Kt);class Vector4_Vector4{constructor(t=0,e=0,r=0,i=1){Vector4_Vector4.prototype.isVector4=!0,this.x=t,this.y=e,this.z=r,this.w=i}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,e,r,i){return this.x=t,this.y=e,this.z=r,this.w=i,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){const e=this.x,r=this.y,i=this.z,n=this.w,s=t.elements;return this.x=s[0]*e+s[4]*r+s[8]*i+s[12]*n,this.y=s[1]*e+s[5]*r+s[9]*i+s[13]*n,this.z=s[2]*e+s[6]*r+s[10]*i+s[14]*n,this.w=s[3]*e+s[7]*r+s[11]*i+s[15]*n,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);const e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this}setAxisAngleFromRotationMatrix(t){let e,r,i,n;const s=.01,o=.1,a=t.elements,c=a[0],h=a[4],u=a[8],l=a[1],p=a[5],d=a[9],y=a[2],f=a[6],m=a[10];if(Math.abs(h-l)<s&&Math.abs(u-y)<s&&Math.abs(d-f)<s){if(Math.abs(h+l)<o&&Math.abs(u+y)<o&&Math.abs(d+f)<o&&Math.abs(c+p+m-3)<o)return this.set(1,0,0,0),this;e=Math.PI;const t=(c+1)/2,a=(p+1)/2,g=(m+1)/2,_=(h+l)/4,v=(u+y)/4,w=(d+f)/4;return t>a&&t>g?t<s?(r=0,i=.707106781,n=.707106781):(r=Math.sqrt(t),i=_/r,n=v/r):a>g?a<s?(r=.707106781,i=0,n=.707106781):(i=Math.sqrt(a),r=_/i,n=w/i):g<s?(r=.707106781,i=.707106781,n=0):(n=Math.sqrt(g),r=v/n,i=w/n),this.set(r,i,n,e),this}let g=Math.sqrt((f-d)*(f-d)+(u-y)*(u-y)+(l-h)*(l-h));return Math.abs(g)<.001&&(g=1),this.x=(f-d)/g,this.y=(u-y)/g,this.z=(l-h)/g,this.w=Math.acos((c+p+m-1)/2),this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this}clampLength(t,e){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(t,Math.min(e,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this}lerpVectors(t,e,r){return this.x=t.x+(e.x-t.x)*r,this.y=t.y+(e.y-t.y)*r,this.z=t.z+(e.z-t.z)*r,this.w=t.w+(e.w-t.w)*r,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}let Jt=class Vector4 extends Vector4_Vector4{static fromArray(t){return(new this).fromArray(t)}clone(){return(new this.constructor).copy(this)}};(0,n.gn)([(0,s._)({numberType:$.DECIMAL}),(0,n.w6)("design:type",Number)],Jt.prototype,"x",void 0),(0,n.gn)([(0,s._)({numberType:$.DECIMAL}),(0,n.w6)("design:type",Number)],Jt.prototype,"y",void 0),(0,n.gn)([(0,s._)({numberType:$.DECIMAL}),(0,n.w6)("design:type",Number)],Jt.prototype,"z",void 0),(0,n.gn)([(0,s._)({numberType:$.DECIMAL}),(0,n.w6)("design:type",Number)],Jt.prototype,"w",void 0),Jt=(0,n.gn)([d()],Jt);class Matrix3_Matrix3{constructor(t,e,r,i,n,s,o,a,c){Matrix3_Matrix3.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==t&&this.set(t,e,r,i,n,s,o,a,c)}set(t,e,r,i,n,s,o,a,c){const h=this.elements;return h[0]=t,h[1]=i,h[2]=o,h[3]=e,h[4]=n,h[5]=a,h[6]=r,h[7]=s,h[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){const e=this.elements,r=t.elements;return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],this}extractBasis(t,e,r){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const r=t.elements,i=e.elements,n=this.elements,s=r[0],o=r[3],a=r[6],c=r[1],h=r[4],u=r[7],l=r[2],p=r[5],d=r[8],y=i[0],f=i[3],m=i[6],g=i[1],_=i[4],v=i[7],w=i[2],b=i[5],x=i[8];return n[0]=s*y+o*g+a*w,n[3]=s*f+o*_+a*b,n[6]=s*m+o*v+a*x,n[1]=c*y+h*g+u*w,n[4]=c*f+h*_+u*b,n[7]=c*m+h*v+u*x,n[2]=l*y+p*g+d*w,n[5]=l*f+p*_+d*b,n[8]=l*m+p*v+d*x,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){const t=this.elements,e=t[0],r=t[1],i=t[2],n=t[3],s=t[4],o=t[5],a=t[6],c=t[7],h=t[8];return e*s*h-e*o*c-r*n*h+r*o*a+i*n*c-i*s*a}invert(){const t=this.elements,e=t[0],r=t[1],i=t[2],n=t[3],s=t[4],o=t[5],a=t[6],c=t[7],h=t[8],u=h*s-o*c,l=o*a-h*n,p=c*n-s*a,d=e*u+r*l+i*p;if(0===d)return this.set(0,0,0,0,0,0,0,0,0);const y=1/d;return t[0]=u*y,t[1]=(i*c-h*r)*y,t[2]=(o*r-i*s)*y,t[3]=l*y,t[4]=(h*e-i*a)*y,t[5]=(i*n-o*e)*y,t[6]=p*y,t[7]=(r*a-c*e)*y,t[8]=(s*e-r*n)*y,this}transpose(){let t;const e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,r,i,n,s,o){const a=Math.cos(n),c=Math.sin(n);return this.set(r*a,r*c,-r*(a*s+c*o)+s+t,-i*c,i*a,-i*(-c*s+a*o)+o+e,0,0,1),this}scale(t,e){return this.premultiply(Qt.makeScale(t,e)),this}rotate(t){return this.premultiply(Qt.makeRotation(-t)),this}translate(t,e){return this.premultiply(Qt.makeTranslation(t,e)),this}makeTranslation(t,e){return t.isVector2?this.set(1,0,t.x,0,1,t.y,0,0,1):this.set(1,0,t,0,1,e,0,0,1),this}makeRotation(t){const e=Math.cos(t),r=Math.sin(t);return this.set(e,-r,0,r,e,0,0,0,1),this}makeScale(t,e){return this.set(t,0,0,0,e,0,0,0,1),this}equals(t){const e=this.elements,r=t.elements;for(let t=0;t<9;t++)if(e[t]!==r[t])return!1;return!0}fromArray(t,e=0){for(let r=0;r<9;r++)this.elements[r]=t[r+e];return this}toArray(t=[],e=0){const r=this.elements;return t[e]=r[0],t[e+1]=r[1],t[e+2]=r[2],t[e+3]=r[3],t[e+4]=r[4],t[e+5]=r[5],t[e+6]=r[6],t[e+7]=r[7],t[e+8]=r[8],t}clone(){return(new this.constructor).fromArray(this.elements)}}const Qt=new Matrix3_Matrix3;let Zt=class Matrix3 extends Matrix3_Matrix3{static fromArray(t){const e=new this;return e.fromArray([].concat(...t)),e.transpose(),e}clone(){return(new this.constructor).fromArray(this.elements)}};(0,n.gn)([yt(Number,{numberType:$.DECIMAL}),(0,n.w6)("design:type",Array)],Zt.prototype,"elements",void 0),Zt=(0,n.gn)([d()],Zt);var Yt,Xt=r(750);let te=Yt=class DataFrame{constructor(t){var e;this.uid=E(),this._objects=new Map,this.createdTimestamp=B.now(),t instanceof Yt?(this.createdTimestamp=t.createdTimestamp,this.phenomenonTimestamp=t.phenomenonTimestamp,this.uid=t.uid,this._objects=t._objects,this.source=t.source):t instanceof Rt&&(this.source=t),this.phenomenonTimestamp=null!==(e=this.phenomenonTimestamp)&&void 0!==e?e:this.createdTimestamp}get source(){return this.getObjectByUID(this._source)}set source(t){void 0!==t&&(this.addObject(t.clone()),this._source=t.uid)}getSensor(t,e){let r=this.getObjects(t)[0];return r||void 0===e||(r=new t(e),this.addObject(r)),r}getObjects(t){if(void 0===t){const t=[];return this._objects.forEach((e=>{t.push(e)})),t}{const e=[];return this._objects.forEach((r=>{r.constructor.name===t.name&&e.push(r)})),e}}getObjectByUID(t){return this._objects.get(t)}hasObject(t){return this._objects.has(t.uid)}addObject(t){return void 0===t||this._objects.set(t.uid,t),this}addSensor(t){return this.addObject(t)}addReferenceSpace(t){this.addObject(t)}removeObject(t){this._objects.delete(t.uid)}clearObjects(t){const e=null!=t?t:t=>!0;this._objects.forEach(((t,r)=>{e(t)&&this._objects.delete(r)}))}clone(){return u.C.clone(this)}};(0,n.gn)([(0,s._)({primaryKey:!0}),(0,n.w6)("design:type",String)],te.prototype,"uid",void 0),(0,n.gn)([(0,s._)({index:!0,numberType:$.LONG}),(0,n.w6)("design:type",Number)],te.prototype,"createdTimestamp",void 0),(0,n.gn)([(0,s._)({index:!0,numberType:$.LONG}),(0,n.w6)("design:type",Number)],te.prototype,"phenomenonTimestamp",void 0),(0,n.gn)([(0,s._)({name:"source"}),(0,n.w6)("design:type",String)],te.prototype,"_source",void 0),(0,n.gn)([D(String,Rt,{name:"objects"}),(0,n.w6)("design:type",Map)],te.prototype,"_objects",void 0),te=Yt=(0,n.gn)([d(),(0,n.w6)("design:paramtypes",[Object])],te);let ee=class ReferenceSpace extends Rt{constructor(t){super(),this.parent=t,this._scaleMatrix=new ft,this._transformationMatrix=(new ft).identity(),this._translationMatrix=(new ft).identity(),this._rotation=new wt}set parent(t){t&&(this.parentUID=t.uid,this._parent=t)}get parent(){return this._parent}update(t){return new Promise(((e,r)=>{this.parentUID?t.findByUID(this.parentUID).then((e=>{if(this._parent=e,!e)throw new Error(`Unable to find reference space with uid: ${this.parentUID}!`);return this._parent.update(t)})).then(e).catch(r):e()}))}orthographic(t,e,r,i,n,s){return this._transformationMatrix.multiply((new ft).makeOrthographic(t,e,r,i,n,s)),this}perspective(t,e,r,i,n,s){return this._transformationMatrix.multiply((new ft).makePerspective(t,e,r,i,n,s)),this}reset(){return this._transformationMatrix.identity(),this._scaleMatrix=new ft,this._rotation=new wt,this}referenceUnit(t){return this._unit=t,this}translation(t,e,r=0){return this._translationMatrix.multiply((new ft).makeTranslation(t,e,r)),this._transformationMatrix.multiply(this._translationMatrix),this}scale(t,e,r=1){return this._scaleMatrix=(new ft).makeScale(t,e,r),this._transformationMatrix.multiply(this._scaleMatrix),this}rotation(t){return t instanceof wt?(this._rotation=t.clone(),this._transformationMatrix.multiply(this._rotation.toRotationMatrix())):t instanceof gt?(this._rotation=wt.fromEuler(t),this._transformationMatrix.multiply(this._rotation.toRotationMatrix())):t instanceof vt?(this._rotation=wt.fromAxisAngle(t),this._transformationMatrix.multiply(this._rotation.toRotationMatrix())):(this._rotation=wt.fromEuler(t),this._transformationMatrix.multiply(this._rotation.toRotationMatrix())),this}transform(t,e){const r=e||{},i=this._parent?this._parent.transform(t,e):t.clone();this._unit&&(i.fromVector(i.toVector3(this._unit)),i.setAccuracy(i.accuracy.to(this._unit)));const n=r.inverse?this.transformationMatrix.clone().invert():this.transformationMatrix,s=r.inverse?this.rotationQuaternion.clone().invert():this.rotationQuaternion,o=r.inverse?this._scaleMatrix.clone().invert():this.scaleMatrix;return i.fromVector(i.toVector3().applyMatrix4(n)),i.orientation&&i.orientation.multiply(s),i.linearVelocity&&i.linearVelocity.applyMatrix4(o).applyMatrix4(ft.rotationFromQuaternion(s)),i.setAccuracy(new W(i.accuracy.valueOf(),0,0).applyMatrix4(o).x,i.accuracy.unit),i.referenceSpaceUID=this.uid,i}get transformationMatrix(){return this._transformationMatrix}set transformationMatrix(t){this._transformationMatrix=t}get scaleMatrix(){return this._scaleMatrix}set scaleMatrix(t){this._scaleMatrix=t}get rotationQuaternion(){return this._rotation}set rotationQuaternion(t){this._rotation=t}get translationMatrix(){return this._translationMatrix}set translationMatrix(t){this._translationMatrix=t}};(0,n.gn)([(0,s._)({name:"translationMatrix"}),(0,n.w6)("design:type",ft)],ee.prototype,"_translationMatrix",void 0),(0,n.gn)([(0,s._)({name:"transformationMatrix"}),(0,n.w6)("design:type",ft)],ee.prototype,"_transformationMatrix",void 0),(0,n.gn)([(0,s._)({name:"scaleMatrix"}),(0,n.w6)("design:type",ft)],ee.prototype,"_scaleMatrix",void 0),(0,n.gn)([(0,s._)({name:"rotation"}),(0,n.w6)("design:type",wt)],ee.prototype,"_rotation",void 0),(0,n.gn)([(0,s._)({name:"unit"}),(0,n.w6)("design:type",R)],ee.prototype,"_unit",void 0),ee=(0,n.gn)([d(),(0,n.w6)("design:paramtypes",[Object])],ee);let re=class SensorCalibrationData{};(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",Object)],re.prototype,"offset",void 0),(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",Object)],re.prototype,"multipler",void 0),re=(0,n.gn)([d()],re);let ie=class SensorObject extends Rt{constructor(t,e,r,i){super(t,i),this.value=null!=e?e:{},this.frequency=r}get timestamp(){return this.value instanceof Q||this.value instanceof xt?this.value.timestamp:this.createdTimestamp}};(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",Object)],ie.prototype,"value",void 0),(0,n.gn)([(0,s._)({numberType:$.DECIMAL}),(0,n.w6)("design:type",Number)],ie.prototype,"frequency",void 0),(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",re)],ie.prototype,"calibrationData",void 0),ie=(0,n.gn)([d(),(0,n.w6)("design:paramtypes",[String,Object,Number,String])],ie);let ne=class Acceleration extends Q{constructor(t=0,e=0,r=0,i=kt.METER_PER_SECOND_SQUARE){super(t,e,r,i,kt.METER_PER_SECOND_SQUARE)}};ne=(0,n.gn)([d(),(0,n.w6)("design:paramtypes",[Object,Object,Object,Object])],ne);let se=class Accelerometer extends ie{constructor(t,e,r,i){super(t,null!=e?e:new ne,r,i)}};se=(0,n.gn)([d(),(0,n.w6)("design:paramtypes",[String,ne,Number,String])],se);let oe=class GravitySensor extends ie{constructor(t,e,r,i){super(t,null!=e?e:new ne,r,i)}};oe=(0,n.gn)([d(),(0,n.w6)("design:paramtypes",[String,ne,Number,String])],oe);let ae=class Gyroscope extends ie{constructor(t,e,r,i){super(t,null!=e?e:new Z,r,i)}};ae=(0,n.gn)([d(),(0,n.w6)("design:paramtypes",[String,Z,Number,String])],ae);let ce=class LinearAccelerationSensor extends ie{constructor(t,e,r,i){super(t,null!=e?e:new ne,r,i)}};ce=(0,n.gn)([d(),(0,n.w6)("design:paramtypes",[String,ne,Number,String])],ce);let he=class AbsoluteOrientationSensor extends ie{constructor(t,e,r,i){super(t,null!=e?e:new xt,r,i)}};he=(0,n.gn)([d(),(0,n.w6)("design:paramtypes",[String,xt,Number,String])],he);let ue=class RelativeOrientationSensor extends ie{constructor(t,e,r,i){super(t,null!=e?e:new xt,r,i)}};ue=(0,n.gn)([d(),(0,n.w6)("design:paramtypes",[String,xt,Number,String])],ue);let le=class Magnetism extends Q{constructor(t,e,r,i=Lt.MICROTESLA){super(t,e,r,i,Lt.MICROTESLA)}};(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",Lt)],le.prototype,"unit",void 0),le=(0,n.gn)([d(),(0,n.w6)("design:paramtypes",[Number,Number,Number,Object])],le);let pe=class Magnetometer extends ie{constructor(t,e,r,i){super(t,null!=e?e:new le,r,i)}};pe=(0,n.gn)([d(),(0,n.w6)("design:paramtypes",[String,le,Number,String])],pe);let de=class LinearVelocitySensor extends ie{constructor(t,e,r,i){super(t,null!=e?e:new tt,r,i)}};de=(0,n.gn)([d(),(0,n.w6)("design:paramtypes",[String,tt,Number,String])],de);let ye=class Absolute2DPosition extends Dt{constructor(t,e,r=R.METER){super(),this.vector=new W,this.vector.x=r.convert(t||0,R.METER),this.vector.y=r.convert(e||0,R.METER)}get x(){if(this.vector)return this.vector.x}set x(t){this.vector&&(this.vector.x=t)}get y(){if(this.vector)return this.vector.y}set y(t){this.vector&&(this.vector.y=t)}angleTo(t){return this.vector.angleTo(t.vector)}fromVector(t,e){return e?(this.x=e.convert(t.x,this.unit),this.y=e.convert(t.y,this.unit)):(this.x=t.x,this.y=t.y),this}toVector3(t){return t?new W(this.unit.convert(this.x,t),this.unit.convert(this.y,t)):new W(this.x,this.y)}clone(){const t=super.clone();return t.x=this.x,t.y=this.y,t}};(0,n.gn)([(0,s._)({numberType:$.DECIMAL}),(0,n.w6)("design:type",Number),(0,n.w6)("design:paramtypes",[Number])],ye.prototype,"x",null),(0,n.gn)([(0,s._)({numberType:$.DECIMAL}),(0,n.w6)("design:type",Number),(0,n.w6)("design:paramtypes",[Number])],ye.prototype,"y",null),ye=(0,n.gn)([d(),(0,n.w6)("design:paramtypes",[Number,Number,R])],ye);let fe=class Absolute3DPosition extends ye{constructor(t,e,r,i=R.METER){super(t,e,i),this.vector.z=i.convert(r||0,R.METER)}get z(){if(this.vector)return this.vector.z}set z(t){this.vector&&(this.vector.z=t)}fromVector(t,e){var r,i;return e?(this.x=e.convert(t.x,this.unit),this.y=e.convert(t.y,this.unit),this.z=e.convert(null!==(r=t.z)&&void 0!==r?r:0,this.unit)):(this.x=t.x,this.y=t.y,this.z=null!==(i=t.z)&&void 0!==i?i:0),this}toVector3(t){return t?new W(this.unit.convert(this.x,t),this.unit.convert(this.y,t),this.unit.convert(this.z,t)):new W(this.x,this.y,this.z)}clone(){const t=super.clone();return t.x=this.x,t.y=this.y,t.z=this.z,t}};var me;(0,n.gn)([(0,s._)({numberType:$.DECIMAL}),(0,n.w6)("design:type",Number),(0,n.w6)("design:paramtypes",[Number])],fe.prototype,"z",null),fe=(0,n.gn)([d(),(0,n.w6)("design:paramtypes",[Number,Number,Number,R])],fe);let ge=me=class GeographicalPosition extends fe{constructor(t,e,r){super(),this.latitude=t,this.longitude=e,this.z=r}get latitude(){return this.y}set latitude(t){this.y=t}get longitude(){return this.x}set longitude(t){this.x=t}get altitude(){return this.z}set altitude(t){this.z=t}distanceTo(t){return super.distanceTo(t,St)}bearing(t){return U.RADIAN.convert(this.angleTo(t),U.DEGREE)}angleTo(t){const e=U.DEGREE.convert(this.longitude,U.RADIAN),r=U.DEGREE.convert(this.latitude,U.RADIAN),i=U.DEGREE.convert(t.longitude,U.RADIAN),n=U.DEGREE.convert(t.latitude,U.RADIAN),s=Math.sin(i-e)*Math.cos(n),o=Math.cos(r)*Math.sin(n)-Math.sin(r)*Math.cos(n)*Math.cos(i-e);return Math.atan2(s,o)}destination(t,e,r=U.DEGREE,i=R.METER){e=i.convert(e,R.METER);const n=r.convert(t,U.RADIAN),s=r.convert(this.longitude,U.RADIAN),o=r.convert(this.latitude,U.RADIAN),a=Math.asin(Math.sin(o)*Math.cos(e/Mt.EARTH_RADIUS_MEAN)+Math.cos(o)*Math.sin(e/Mt.EARTH_RADIUS_MEAN)*Math.cos(n)),c=s+Math.atan2(Math.sin(n)*Math.sin(e/Mt.EARTH_RADIUS_MEAN)*Math.cos(o),Math.cos(e/Mt.EARTH_RADIUS_MEAN)-Math.sin(o)*Math.sin(a)),h=new me;return h.latitude=U.RADIAN.convert(a,U.DEGREE),h.longitude=U.RADIAN.convert(c,U.DEGREE),h.altitude=this.altitude,h.unit=this.unit,h}fromVector(t,e=Mt.WGS84){let r;return e instanceof R?r=Mt.ECEF.convert(new W(e.convert(t.x,R.METER),e.convert(t.y,R.METER),e.convert(t.z,R.METER)),Mt.WGS84):e instanceof Mt&&(r=e.convert(t,Mt.WGS84)),this.x=r.x,this.y=r.y,this.z=r.z,this}toVector3(t=Mt.WGS84){return t instanceof Mt?Mt.WGS84.convert(new W(this.x,this.y,this.z),t):t instanceof R?Mt.WGS84.convert(new W(R.METER.convert(this.x,t),R.METER.convert(this.y,t),R.METER.convert(this.z,t)),Mt.ECEF):void 0}clone(){const t=super.clone();return t.latitude=this.latitude,t.longitude=this.longitude,t.z=this.altitude,t}};ge=me=(0,n.gn)([d(),(0,n.w6)("design:paramtypes",[Number,Number,Number])],ge);let _e=class RelativeAngle extends Pt{constructor(t,e,r,i){super(t,e,r||U.RADIAN),this.orientation=new xt,this.unit=r,i&&(this.orientation=i)}get angleUnit(){return this.unit}set angleUnit(t){this.unit=t}get angle(){return this.referenceValue}set angle(t){this.referenceValue=t}};(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",xt)],_e.prototype,"orientation",void 0),(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",U)],_e.prototype,"unit",void 0),(0,n.gn)([(0,s._)({numberType:$.DECIMAL}),(0,n.w6)("design:type",Number)],_e.prototype,"referenceValue",void 0),_e=(0,n.gn)([d(),(0,n.w6)("design:paramtypes",[Object,Number,U,xt])],_e);let ve=class RelativeDistance extends Pt{constructor(t,e,r){super(t,e,R.METER),this.unit=r}get distanceUnit(){return this.unit}set distanceUnit(t){this.unit=t}get distance(){return this.referenceValue}set distance(t){this.referenceValue=t}};(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",R)],ve.prototype,"unit",void 0),(0,n.gn)([(0,s._)({numberType:$.DECIMAL}),(0,n.w6)("design:type",Number)],ve.prototype,"referenceValue",void 0),ve=(0,n.gn)([d(),(0,n.w6)("design:paramtypes",[Object,Number,R])],ve);let we=class RelativeAngularVelocity extends Pt{constructor(t,e){super(t,e,I.RADIAN_PER_MINUTE)}get velocity(){return this.referenceValue}set velocity(t){this.referenceValue=t}};(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",Z)],we.prototype,"referenceValue",void 0),we=(0,n.gn)([d(),(0,n.w6)("design:paramtypes",[Object,Z])],we);let be=class RelativeLinearVelocity extends Pt{constructor(t,e){super(t,e,X.METER_PER_SECOND)}get velocity(){return this.referenceValue}set velocity(t){this.referenceValue=t}};(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",tt)],be.prototype,"referenceValue",void 0),be=(0,n.gn)([d(),(0,n.w6)("design:paramtypes",[Object,tt])],be);let xe=class Trajectory{get trajectoryStart(){return this.positions&&0!==this.positions.length?this.positions[0].timestamp:-1}get trajectoryEnd(){return this.positions&&0!==this.positions.length?this.positions[this.positions.length-1].timestamp:-1}constructor(t){this.uid=E(),this.positions=[],this.objectUID=t,this.createdTimestamp=B.now()}};(0,n.gn)([(0,s._)({primaryKey:!0}),(0,n.w6)("design:type",String)],xe.prototype,"uid",void 0),(0,n.gn)([(0,s._)({index:!0}),(0,n.w6)("design:type",String)],xe.prototype,"objectUID",void 0),(0,n.gn)([yt(Dt),(0,n.w6)("design:type",Array)],xe.prototype,"positions",void 0),(0,n.gn)([(0,s._)({index:!0,numberType:$.LONG}),(0,n.w6)("design:type",Number)],xe.prototype,"createdTimestamp",void 0),xe=(0,n.gn)([d(),(0,n.w6)("design:paramtypes",[String])],xe);let Ee=class Pose extends ft{constructor(){super(...arguments),this.timestamp=B.now(),this.unit=R.METER,this._probability=1}get probability(){return this._probability}set probability(t){if(t>1||t<0)throw new Error(`${this.constructor.name} should be between 0 and 1.`);this._probability=t}get accuracy(){return this._accuracy||(this._accuracy=new J(1,this.unit)),this._accuracy}set accuracy(t){this._accuracy=t}static fromMatrix4(t){const e=new this;return e.fromArray(t.toArray()),e}static fromPosition(t){const e=new this;e.timestamp=t.timestamp,e.unit=t.unit,e.probability=t.probability,e.accuracy=e.accuracy.clone();const r=t.toVector3();return t.orientation&&e.makeRotationFromQuaternion(t.orientation),e.setPosition(r.x,r.y,r.z),e}get orientation(){const t=this.extractRotation(this),e=xt.fromRotationMatrix(t);return e.timestamp=this.timestamp,e}get position(){const t=this.copyPosition(this),e=new fe(t.elements[12],t.elements[13],t.elements[14]);return e.timestamp=this.timestamp,e.unit=this.unit,e.probability=this.probability,e.accuracy=this.accuracy.clone(),e.orientation=this.orientation,e}};function Me(t,e){return void 0===e&&(e={}),function(r,i){var n,s="@jsonSetMember on "+(0,z.$0)(r.constructor)+"."+String(i),c=(0,N.JD)(t,s),h=z.df?Reflect.getMetadata("design:type",r,i):null;null==h||h===Set||h===Object?(0,o.d3)(r,i,{type:function(){return(0,N.zc)(c())},emitDefaultValue:e.emitDefaultValue,isRequired:e.isRequired,options:(0,a.M3)(e),key:i.toString(),name:null!==(n=e.name)&&void 0!==n?n:i.toString(),deserializer:e.deserializer,serializer:e.serializer}):(0,z.H)(s+": property is not a Set. "+z.AZ)}}function Se(t,e){return(r,i)=>{const n=(0,p.W5)(r,i,e);Me(t,n)(r,i),(0,p.EB)(r,i,n)}}(0,n.gn)([(0,s._)({index:!0,numberType:$.LONG}),(0,n.w6)("design:type",Number)],Ee.prototype,"timestamp",void 0),(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",R)],Ee.prototype,"unit",void 0),(0,n.gn)([(0,s._)({name:"accuracy"}),(0,n.w6)("design:type",K)],Ee.prototype,"_accuracy",void 0),(0,n.gn)([(0,s._)({numberType:$.DECIMAL}),(0,n.w6)("design:type",Number),(0,n.w6)("design:paramtypes",[Number])],Ee.prototype,"probability",null),Ee=(0,n.gn)([d()],Ee);let Ae=class Temperature extends Q{constructor(t=0,e=Ft.CELCIUS){super(t,void 0,void 0,e,Ft.CELCIUS)}get value(){return this.x}set value(t){this.x=t}};Ae=(0,n.gn)([d(),(0,n.w6)("design:paramtypes",[Object,Object])],Ae);let ze=class Humidity extends Q{constructor(t=0){super(t,void 0,void 0)}get value(){return this.x}set value(t){this.x=t}};ze=(0,n.gn)([d(),(0,n.w6)("design:paramtypes",[Object])],ze);let Ne=class Pressure extends Q{constructor(t=0,e=Wt.PASCAL){super(t,void 0,void 0,e,Wt.PASCAL)}get value(){return this.x}set value(t){this.x=t}};Ne=(0,n.gn)([d(),(0,n.w6)("design:paramtypes",[Object,Object])],Ne);let Te=class Accuracy2D extends K{constructor(t,e,r){super(new W,r),this.value.x=t,this.value.y=e}to(t){const e=super.to(t);return e.x=this.unit.convert(this.x,t),e.y=this.unit.convert(this.y,t),e}valueOf(){return(this.x+this.y)/2}toString(){return this.valueOf().toString()}get x(){return this.value.x}set x(t){this.value.x=t}get y(){return this.value.y}set y(t){this.value.y=t}};(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",W)],Te.prototype,"value",void 0),Te=(0,n.gn)([d(),(0,n.w6)("design:paramtypes",[Number,Number,Object])],Te);let De=class Accuracy3D extends Te{constructor(t,e,r,i){super(t,e,i),this.value.z=r}to(t){const e=super.to(t);return e.z=this.unit.convert(this.z,t),e}valueOf(){return(this.x+this.y+this.z)/3}get z(){return this.value.z}set z(t){this.value.z=t}};De=(0,n.gn)([d(),(0,n.w6)("design:paramtypes",[Number,Number,Number,Object])],De);var Pe=r(141),Oe=r(446),Re=r(188),Ce=r(844),je=function(){function t(t,e){this.serializer=new Ce.e,this.deserializer=new Re.Z,this.globalKnownTypes=[],this.indent=0;var r=o.WR.getFromConstructor(t);if(void 0===r||!r.isExplicitlyMarked&&!r.isHandledWithoutAnnotation)throw new TypeError("The TypedJSON root data type must have the @jsonObject decorator used.");this.nameResolver=function(t){return(0,z.$0)(t)},this.rootConstructor=t,this.errorHandler=function(t){return(0,z.H)(t)},this.config(e)}return t.parse=function(e,r,i){return new t(r,i).parse(e)},t.parseAsArray=function(e,r,i,n){return new t(r,i).parseAsArray(e,n)},t.parseAsSet=function(e,r,i){return new t(r,i).parseAsSet(e)},t.parseAsMap=function(e,r,i,n){return new t(i,n).parseAsMap(e,r)},t.toPlainJson=function(e,r,i){return new t(r,i).toPlainJson(e)},t.toPlainArray=function(e,r,i,n){return new t(r,n).toPlainArray(e,i)},t.toPlainSet=function(e,r,i){return new t(r,i).toPlainSet(e)},t.toPlainMap=function(e,r,i,n){return new t(i,n).toPlainMap(e,r)},t.stringify=function(e,r,i){return new t(r,i).stringify(e)},t.stringifyAsArray=function(e,r,i,n){return new t(r,n).stringifyAsArray(e,i)},t.stringifyAsSet=function(e,r,i){return new t(r,i).stringifyAsSet(e)},t.stringifyAsMap=function(e,r,i,n){return new t(i,n).stringifyAsMap(e,r)},t.setGlobalConfig=function(t){Object.assign(this._globalConfig,t)},t.mapType=function(t,e){null==this._globalConfig.mappedTypes&&(this._globalConfig.mappedTypes=new Map),this._globalConfig.mappedTypes.set(t,e)},t.prototype.config=function(e){var r=this;null!=(e=(0,n.pi)((0,n.pi)({},t._globalConfig),e)).knownTypes&&null!=t._globalConfig.knownTypes&&(e.knownTypes=Array.from(new Set(e.knownTypes.concat(t._globalConfig.knownTypes))));var i=(0,a.M3)(e);this.serializer.options=i,this.deserializer.options=i,null!=e.errorHandler&&(this.errorHandler=e.errorHandler,this.deserializer.setErrorHandler(e.errorHandler),this.serializer.setErrorHandler(e.errorHandler)),null!=e.replacer&&(this.replacer=e.replacer),null!=e.typeResolver&&this.deserializer.setTypeResolver(e.typeResolver),null!=e.typeHintEmitter&&this.serializer.setTypeHintEmitter(e.typeHintEmitter),null!=e.indent&&(this.indent=e.indent),null!=e.mappedTypes&&e.mappedTypes.forEach((function(t,e){r.setSerializationStrategies(e,t)})),null!=e.nameResolver&&(this.nameResolver=e.nameResolver,this.deserializer.setNameResolver(e.nameResolver)),null!=e.knownTypes&&(e.knownTypes.forEach((function(t,e){null==t&&(0,z.KE)("TypedJSON.config: 'knownTypes' contains an undefined/null value (element "+e+").")})),this.globalKnownTypes=e.knownTypes)},t.prototype.mapType=function(t,e){this.setSerializationStrategies(t,e)},t.prototype.parse=function(t){var e,r=(0,z.W0)(t,this.rootConstructor);try{e=this.deserializer.convertSingleValue(r,(0,N._k)(this.rootConstructor),this.getKnownTypes())}catch(t){this.errorHandler(t)}return e},t.prototype.parseAsArray=function(t,e){void 0===e&&(e=1);var r=(0,z.W0)(t,Array);return this.deserializer.convertSingleValue(r,dt((0,N._k)(this.rootConstructor),e),this._mapKnownTypes(this.globalKnownTypes))},t.prototype.parseAsSet=function(t){var e=(0,z.W0)(t,Set);return this.deserializer.convertSingleValue(e,(0,N.zc)(this.rootConstructor),this._mapKnownTypes(this.globalKnownTypes))},t.prototype.parseAsMap=function(t,e){var r=(0,z.W0)(t,Map);return this.deserializer.convertSingleValue(r,(0,N.mY)(e,this.rootConstructor),this._mapKnownTypes(this.globalKnownTypes))},t.prototype.toPlainJson=function(t){try{return this.serializer.convertSingleValue(t,(0,N._k)(this.rootConstructor))}catch(t){this.errorHandler(t)}},t.prototype.toPlainArray=function(t,e){void 0===e&&(e=1);try{return this.serializer.convertSingleValue(t,dt((0,N._k)(this.rootConstructor),e))}catch(t){this.errorHandler(t)}},t.prototype.toPlainSet=function(t){try{return this.serializer.convertSingleValue(t,(0,N.zc)(this.rootConstructor))}catch(t){this.errorHandler(t)}},t.prototype.toPlainMap=function(t,e){try{return this.serializer.convertSingleValue(t,(0,N.mY)(e,this.rootConstructor))}catch(t){this.errorHandler(t)}},t.prototype.stringify=function(t){var e=this.toPlainJson(t);return void 0===e?"":JSON.stringify(e,this.replacer,this.indent)},t.prototype.stringifyAsArray=function(t,e){return JSON.stringify(this.toPlainArray(t,e),this.replacer,this.indent)},t.prototype.stringifyAsSet=function(t){return JSON.stringify(this.toPlainSet(t),this.replacer,this.indent)},t.prototype.stringifyAsMap=function(t,e){return JSON.stringify(this.toPlainMap(t,e),this.replacer,this.indent)},t.prototype.getKnownTypes=function(){var t=this,e=o.WR.getFromConstructor(this.rootConstructor),r=new Map;return this.globalKnownTypes.filter((function(t){return t})).forEach((function(e){r.set(t.nameResolver(e),e)})),void 0!==e&&(e.processDeferredKnownTypes(),e.knownTypes.forEach((function(e){r.set(t.nameResolver(e),e)}))),r},t.prototype._mapKnownTypes=function(t){var e=this,r=new Map;return t.filter((function(t){return t})).forEach((function(t){return r.set(e.nameResolver(t),t)})),r},t.prototype.setSerializationStrategies=function(t,e){var r=this;null!=e.deserializer&&this.deserializer.setDeserializationStrategy(t,(function(t){return e.deserializer(t,{fallback:function(t,e){return r.deserializer.convertSingleValue(t,(0,N._k)(e),r.getKnownTypes())}})})),null!=e.serializer&&this.serializer.setSerializationStrategy(t,(function(t){return e.serializer(t,{fallback:function(t,e){return r.serializer.convertSingleValue(t,(0,N._k)(e))}})}))},t._globalConfig={},t}(),Ue=r(255);function ke(t){if("function"!=typeof t)return function(e){Ie(e,t)};Ie(t,{})}function Ie(t,e){if(!0!==e.overwrite&&void 0!==t.prototype.toJSON)throw new Error(t.name+" already has toJSON defined!");t.prototype.toJSON=function(){return je.toPlainJson(this,Object.getPrototypeOf(this).constructor)}}r(759);const Le=Object.assign(Object.assign({},i),{utils:{isInstanceOf:z.V9,isValueDefined:z.Jf,nameof:z.$0,isSubtypeOf:z.me},options:{mergeOptions:a.JH},typeDescriptor:{ensureTypeDescriptor:N._k,ArrayTypeDescriptor:N.GJ,MapTypeDescriptor:N.br,SetTypeDescriptor:N.do}});var Ve;const Fe="-0000-1000-8000-00805f9b34fb";let Be=Ve=class UUID{constructor(t){this._raw=t}static generate(){const t=E();return Ve.fromString(t)}static fromBuffer(t){return new this(t)}static fromString(t){const e=t.replace(Fe,"").replace(/-/g,"").split(/(..)/).filter((t=>""!==t)).map((t=>Number(`0x${t}`)));if(e.includes(NaN))return;let r=Uint8Array.from(e);return t.startsWith("0000")&&(r=r.slice(2)),new this(r)}toBuffer(){return this._raw}toString(){const t=[];for(const[,e]of this._raw.entries())t.push(e);if(2===this._raw.byteLength)return"0000"+t.map((t=>t.toString(16).padStart(2,"0"))).join("")+Fe;if(4===this._raw.byteLength)return t.map((t=>t.toString(16).padStart(2,"0"))).join("")+Fe;{const e=t.map((t=>t.toString(16).padStart(2,"0")));return e.splice(0,4).join("")+"-"+e.splice(0,2).join("")+"-"+e.splice(0,2).join("")+"-"+e.splice(0,2).join("")+"-"+e.join("")}}};(0,n.gn)([(0,s._)({name:"value"}),(0,n.w6)("design:type",Uint8Array)],Be.prototype,"_raw",void 0),Be=Ve=(0,n.gn)([d(),(0,n.w6)("design:paramtypes",[Uint8Array])],Be);let $e=class DataServiceDriver extends L{constructor(t,e={}){super(),this.options=e,this.options.serialize=this.options.serialize||(t=>u.C.serialize(t)),this.options.deserialize=this.options.deserialize||(t=>u.C.deserialize(t)),t&&(this.uid=t.name,this.dataType=t)}};(0,n.gn)([(0,s._)({serializer:t=>t.name,deserializer:t=>u.C.findTypeByName(t)}),(0,n.w6)("design:type",Object)],$e.prototype,"dataType",void 0),(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",Object)],$e.prototype,"options",void 0),$e=(0,n.gn)([d(),(0,n.w6)("design:paramtypes",[Object,Object])],$e);let He=class DataService extends L{constructor(t){super(),this.priority=-1,this.driver=t,this.driver&&(this.uid=this.driver.dataType.name),this.once("build",this._buildDriver.bind(this)),this.once("destroy",this._destroyDriver.bind(this))}_buildDriver(){return new Promise(((t,e)=>{this.driver?(this.driver.model=this.model,this.driver.emitAsync("build").then((()=>t())).catch(e)):t()}))}_destroyDriver(){return new Promise(((t,e)=>{this.driver?this.driver.emitAsync("destroy").then((()=>t())).catch(e):t()}))}get dataType(){if(this.driver)return this.driver.dataType}setPriority(t){return this.priority=t,this}findByUID(t){return this.driver.findByUID(t)}findOne(t,e){return this.driver.findOne(t,e)}findAll(t,e){return this.driver.findAll(t,e)}insert(t,e){return this.driver.insert(t,e)}count(t){return this.driver.count(t)}delete(t){return this.driver.delete(t)}deleteAll(t){return this.driver.deleteAll(t)}};(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",$e)],He.prototype,"driver",void 0),(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",Object)],He.prototype,"priority",void 0),He=(0,n.gn)([d(),(0,n.w6)("design:paramtypes",[$e])],He);class DataObjectService extends He{constructor(t){super(t)}insertObject(t){return this.insert(t.uid,t)}insert(t,e){return new Promise(((r,i)=>{this.driver.insert(t,e).then((t=>{r(t)})).catch(i)}))}findByDisplayName(t){return this.findAll({displayName:t})}findByPosition(t){const e=t.toVector3();let r;return r=t instanceof fe?{"position.x":e.x,"position.y":e.y,"position.z":e.z}:{"position.x":e.x,"position.y":e.y},this.findAll(r)}findByParentUID(t){return this.findAll({parentUID:t})}findBefore(t){return this._findTimestamp({$lte:t})}findAfter(t){return this._findTimestamp({$gte:t})}_findTimestamp(t){return this.findAll({createdTimestamp:t})}}class ServiceProxy extends L{get(t,e){return"target"===e?t:"constructor"===e?t.constructor:"function"==typeof t[e]?this.createHandler(t,e):t[e]}set(t,e,r){return t[e]=r,!0}createHandler(t,e){const r=e;return(...i)=>("emit"!==r&&"emitAsync"!==r&&"on"!==r&&"once"!==r&&t.emit(r,...i),t[e](...i))}}class WorkerServiceProxy extends ServiceProxy{constructor(t){super(),this._promises=new Map,this.options=t,this.uid=t.uid,this.options.responseObservable&&this.options.responseObservable.subscribe(this._onOutput.bind(this))}_onOutput(t){if(this._promises.has(t.id)){const e=this._promises.get(t.id);if(t.success)if(void 0===t.result)e.resolve();else if(Array.isArray(t.result)){const r=[];t.result.forEach((t=>{t.__type?r.push(u.C.deserialize(t)):r.push(t)})),e.resolve(r)}else t.result.__type?e.resolve(u.C.deserialize(t.result)):e.resolve(t.result);else e.reject(t.result);this._promises.delete(t.id)}}get(t,e){const r=this[e];return r||("target"===e?t:this.createHandler(t,e))}createHandler(t,e){return(...t)=>new Promise(((r,i)=>{const n=E();this._promises.set(n,{resolve:r,reject:i});const s=[];t.forEach((t=>{u.C.findTypeByName(t.constructor.name)?s.push(u.C.serialize(t)):s.push(t)}));const o={id:n,serviceUID:this.uid,method:e,parameters:s};this.options.callObservable?this.options.callObservable.next(o):this.options.callFunction(o).then((t=>{this._onOutput(t)})).catch((t=>{this._onOutput(t)}))}))}}class TrajectoryService extends He{constructor(t,e){var r;super(t),this.options=e||{},this.options.autoBind=void 0===this.options.autoBind||this.options.autoBind,this.options.dataService=this.options.dataService||Rt,this.options.defaultUID=null!==(r=this.options.defaultUID)&&void 0!==r?r:t=>t.uid,this.options.autoBind&&this.once("build",this._bindService.bind(this))}_bindService(){return new Promise(((t,e)=>{if(!this.model)return t();const r=this.model.findDataService(this.options.dataService);r?(r.on("insert",((t,e)=>(0,n.mG)(this,void 0,void 0,(function*(){yield this.appendPosition(e)})))),t()):e(new Error(`Data object service not found for '${this.options.dataService}'`))}))}findCurrentTrajectory(t){return new Promise(((e,r)=>{this.findOne({objectUID:t instanceof Rt?t.uid:t},{sort:[["createdTimestamp",-1]]}).then(e).catch(r)}))}findTrajectoryByRange(t,e,r){return new Promise(((i,n)=>{this.findOne({objectUID:t instanceof Rt?t.uid:t,positions:{$elemMatch:{timestamp:{$lte:r?r instanceof Date?r.getTime():r:Number.MAX_VALUE,$gte:e?e instanceof Date?e.getTime():e:-1}}}}).then((t=>{i(t)})).catch(n)}))}findTrajectories(t){return new Promise((e=>{this.findAll({objectUID:t instanceof Rt?t.uid:t}).then((t=>{e(t.map((t=>t.uid)))}))}))}appendPosition(t,e){return new Promise(((r,i)=>{if(!t.getPosition())return i();Promise.resolve(e?this.findOne({uid:e}):this.findCurrentTrajectory(t)).then((r=>(r||((r=new this.driver.dataType).objectUID=t.uid,r.uid=null!=e?e:this.options.defaultUID(t)),r.positions.push(t.position),this.insert(r.uid,r)))).then(r).catch(i)}))}}const Ge=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;const qe=function(t){return"string"==typeof t&&Ge.test(t)};const We=function(t){if(!qe(t))throw TypeError("Invalid UUID");let e;const r=new Uint8Array(16);return r[0]=(e=parseInt(t.slice(0,8),16))>>>24,r[1]=e>>>16&255,r[2]=e>>>8&255,r[3]=255&e,r[4]=(e=parseInt(t.slice(9,13),16))>>>8,r[5]=255&e,r[6]=(e=parseInt(t.slice(14,18),16))>>>8,r[7]=255&e,r[8]=(e=parseInt(t.slice(19,23),16))>>>8,r[9]=255&e,r[10]=(e=parseInt(t.slice(24,36),16))/1099511627776&255,r[11]=e/4294967296&255,r[12]=e>>>24&255,r[13]=e>>>16&255,r[14]=e>>>8&255,r[15]=255&e,r};function Ke(t,e,r,i){switch(t){case 0:return e&r^~e&i;case 1:case 3:return e^r^i;case 2:return e&r^e&i^r&i}}function Je(t,e){return t<<e|t>>>32-e}const Qe=function(t,e,r){function i(t,i,n,s){var o;if("string"==typeof t&&(t=function(t){t=unescape(encodeURIComponent(t));const e=[];for(let r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e}(t)),"string"==typeof i&&(i=We(i)),16!==(null===(o=i)||void 0===o?void 0:o.length))throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let a=new Uint8Array(16+t.length);if(a.set(i),a.set(t,i.length),a=r(a),a[6]=15&a[6]|e,a[8]=63&a[8]|128,n){s=s||0;for(let t=0;t<16;++t)n[s+t]=a[t];return n}return x(a)}try{i.name=t}catch(t){}return i.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",i.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",i}("v5",80,(function(t){const e=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof t){const e=unescape(encodeURIComponent(t));t=[];for(let r=0;r<e.length;++r)t.push(e.charCodeAt(r))}else Array.isArray(t)||(t=Array.prototype.slice.call(t));t.push(128);const i=t.length/4+2,n=Math.ceil(i/16),s=new Array(n);for(let e=0;e<n;++e){const r=new Uint32Array(16);for(let i=0;i<16;++i)r[i]=t[64*e+4*i]<<24|t[64*e+4*i+1]<<16|t[64*e+4*i+2]<<8|t[64*e+4*i+3];s[e]=r}s[n-1][14]=8*(t.length-1)/Math.pow(2,32),s[n-1][14]=Math.floor(s[n-1][14]),s[n-1][15]=8*(t.length-1)&4294967295;for(let t=0;t<n;++t){const i=new Uint32Array(80);for(let e=0;e<16;++e)i[e]=s[t][e];for(let t=16;t<80;++t)i[t]=Je(i[t-3]^i[t-8]^i[t-14]^i[t-16],1);let n=r[0],o=r[1],a=r[2],c=r[3],h=r[4];for(let t=0;t<80;++t){const r=Math.floor(t/20),s=Je(n,5)+Ke(r,o,a,c)+h+e[r]+i[t]>>>0;h=c,c=a,a=Je(o,30)>>>0,o=n,n=s}r[0]=r[0]+n>>>0,r[1]=r[1]+o>>>0,r[2]=r[2]+a>>>0,r[3]=r[3]+c>>>0,r[4]=r[4]+h>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,255&r[0],r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,255&r[1],r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,255&r[2],r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,255&r[3],r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,255&r[4]]})),Ze=Qe;class NodeDataService extends He{findData(t,e){return new Promise((r=>{this.findByUID(this.getUID(t,"string"==typeof e?e:e.uid)).then((t=>{r(t.data)})).catch((()=>{r(void 0)}))}))}insertData(t,e,r){const i=this.getUID(t,"string"==typeof e?e:e.uid);return this.insert(i,new Ye(i,r))}getUID(t,e){return Ze(e+t,"97b9cc7e-19ca-4f20-8190-161d7b39e93a")}}let Ye=class NodeData{constructor(t,e={}){this.uid=t,this.data=e}};(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",String)],Ye.prototype,"uid",void 0),(0,n.gn)([(0,s._)({serializer:t=>t,deserializer:t=>t}),(0,n.w6)("design:type",Object)],Ye.prototype,"data",void 0),Ye=(0,n.gn)([d(),(0,n.w6)("design:paramtypes",[String,Object])],Ye);class MemoryQueryEvaluator{static isRegexQuery(t){return"[object RegExp]"===Object.prototype.toString.call(t)}static evaluateComponent(t,e,r){let i=!0;const n=t[e];return i=e.startsWith("$")?i&&MemoryQueryEvaluator.evaluateOp(e,t,r):e.includes(".")?i&&MemoryQueryEvaluator.evaluatePath(t,e,r):MemoryQueryEvaluator.isRegexQuery(r)?!(!i||!n.match(r)):"object"==typeof r?i&&MemoryQueryEvaluator.evaluateSelector(n,r):i&&n===r,i}static evaluate(t,e){let r=!0;if(e)for(const i of Object.keys(e))r=r&&MemoryQueryEvaluator.evaluateComponent(t,i,e[i]);return r}static getValueFromPath(t,e){let r=t;const i=(e=(e=e.replace(/\[(\w+)\]/g,".$1")).replace(/^\./,"")).split(".");for(let t=0,e=i.length;t<e;++t){const n=i[t];if(!r)return;if(!(n in r))return;if(!(t<e-1))return[r,r[n],n];r=r[n]}}static evaluatePath(t,e,r){const i=MemoryQueryEvaluator.getValueFromPath(t,e);return!!i&&MemoryQueryEvaluator.evaluateComponent(i[0],i[2],r)}static evaluateSelector(t,e){let r=!0;for(const i of Object.keys(e))r=r&&MemoryQueryEvaluator.evaluateComparisonSelector(i,t,e),r=r&&MemoryQueryEvaluator.evaluateArraySelector(i,t,e);return r}static evaluateComparisonSelector(t,e,r){let i=!0;switch(t){case"$gt":i=i&&e>r[t];break;case"$gte":i=i&&e>=r[t];break;case"$lt":i=i&&e<r[t];break;case"$lte":i=i&&e<=r[t];break;case"$eq":i=i&&e===r[t]}return i}static evaluateArraySelector(t,e,r){let i=!0;switch(t){case"$in":i=i&&Array.from(e).includes(r[t]);break;case"$nin":i=i&&!Array.from(e).includes(r[t]);break;case"$elemMatch":i=!1,e instanceof Array?Array.from(e).forEach((e=>{i=e.key&&e.value?i||MemoryQueryEvaluator.evaluate(e.value,r[t]):i||MemoryQueryEvaluator.evaluate(e,r[t])})):e instanceof Map&&e.forEach((e=>{i=i||MemoryQueryEvaluator.evaluate(e,r[t])})),i=i&&i}return i}static evaluateOp(t,e,r){let i;switch(t){case"$and":i=!0;for(const t of r)i=i&&MemoryQueryEvaluator.evaluate(e,t);break;case"$or":i=!1;for(const t of r)i=i||MemoryQueryEvaluator.evaluate(e,t)}return i}}class MemoryDataService extends $e{constructor(t,e){super(t,e),this._data=new Map}findByUID(t){return new Promise(((e,r)=>{this._data.has(t)?e(this.options.deserialize(this._data.get(t))):r(`${this.dataType.name} with identifier #${t} not found!`)}))}findOne(t,e={}){return new Promise(((r,i)=>{this.findAll(t,{limit:1,sort:e.sort}).then((t=>{if(t.length>0)return r(t[0]);r(void 0)})).catch(i)}))}findAll(t,e={}){return new Promise((r=>{e.limit=e.limit||this._data.size;let i=[];this._data.forEach((r=>{MemoryQueryEvaluator.evaluate(r,t)&&(i.push(r),!e.sort&&(i.length,e.limit))})),e.sort&&(i=i.sort(((t,r)=>e.sort.map((e=>{const i=MemoryQueryEvaluator.getValueFromPath(e[1]>0?t:r,e[0])[1],n=MemoryQueryEvaluator.getValueFromPath(e[1]>0?r:t,e[0])[1];return"number"==typeof i?i-n:"string"==typeof i?i.localeCompare(n):0})).reduce(((t,e)=>t+e)))).slice(0,e.limit)),i=i.map(this.options.deserialize),r(i)}))}insert(t,e){return new Promise((r=>{t&&e?(this._data.set(t,this.options.serialize(e)),r(e)):r(void 0)}))}delete(t){return new Promise(((e,r)=>{this._data.has(t)?(this._data.delete(t),e()):r(`Unable to delete! ${this.dataType.name} with identifier #${t} not found!`)}))}count(t){return new Promise((e=>{if(void 0===t)e(this._data.size);else{let r=0;for(const[,e]of this._data)MemoryQueryEvaluator.evaluate(e,t)&&r++;e(r)}}))}deleteAll(t){return new Promise((e=>{if(void 0===t)this._data=new Map;else for(const[e,r]of this._data)MemoryQueryEvaluator.evaluate(r,t)&&this.delete(e);e()}))}}class KeyValueDataService extends He{constructor(t,e){super(e),e||(this.driver=new MemoryDataService(Object,{serialize:t=>t,deserialize:t=>t}),this.driver.dataType=Object),this.uid=t||this.constructor.name}getValue(t){return this.findByUID(t)}setValue(t,e){return this.emit("set",t,e),this.insert(t,e)}}class DataFrameService extends He{constructor(t){super(t)}insertFrame(t){return this.insert(t.uid,t)}findBefore(t,e){return this._findTimestamp({$lte:t},e)}findAfter(t,e){return this._findTimestamp({$gte:t},e)}findByDataObject(t,e){return this.findAll({objects:{$elemMatch:{uid:t instanceof Rt?t.uid:t}}},e||{sort:[["createdTimestamp",-1]]})}_findTimestamp(t,e){return this.findAll({createdTimestamp:t},e)}}class LocationBasedService extends L{constructor(t){super(),this.watchers=new Map,this.watchedObjects=new Map,this.watchIndex=1,this.options=t||{},this.once("build",this._initLBS.bind(this)),this.once("destroy",this._destroy.bind(this))}_initLBS(){this.options.pullNode=this.options.pullNode||this.model.internalSink.uid,this.options.dataService=this.options.dataService||Rt,this.service=this.model.findDataService(this.options.dataService),this.service.on("insert",((t,e)=>{const r=this.watchedObjects.get(t);if(r){const t=e.position;r.forEach((e=>{const r=this.watchers.get(e);t&&r.callback(t)}))}}))}_destroy(){Array.from(this.watchers.keys()).forEach((t=>{this.clearWatch(t)}))}setCurrentPosition(t,e){return new Promise(((r,i)=>{const n=t instanceof Rt?t.uid:t;this.service.findByUID(n).then((t=>(t.setPosition(e),this.service.insertObject(t)))).then((()=>{r()})).catch(i)}))}getCurrentPosition(t,e={}){return new Promise(((r,i)=>{const n=e.maximumAge||1/0;e.timeout=e.timeout||1e4;const s=t instanceof Rt?t.uid:t;if(e.forceUpdate){this.model.findNodeByUID(this.options.pullNode).pull({requestedObjects:[s]});const n=setTimeout((()=>{this.clearWatch(o),i(new Error("Timeout error for getting current position!"))}),e.timeout),o=this.watchPosition(t,((t,e)=>{if(this.clearWatch(o),clearTimeout(n),e)return i(e);r(t)}),Object.assign(Object.assign({},e),{interval:-1,forceUpdate:!1}))}else this.service.findByUID(s).then((i=>{const s=i.position,o=B.getUnit().convert(B.now(),m.MILLISECOND);if(!(s&&s.timestamp>=o-n))return this.getCurrentPosition(t,Object.assign(Object.assign({},e),{forceUpdate:!0}));r(s)})).then(r).catch(i)}))}watchPosition(t,e,r={}){var i;const n=t instanceof Rt?t.uid:t,s=this.watchIndex++,o=null!==(i=r.interval)&&void 0!==i?i:1e3,a=-1!==o?setInterval((()=>{this.getCurrentPosition(t,r).then(e).catch((t=>{e(void 0,t)}))}),o):void 0;return this.watchers.set(s,{timer:a,uid:n,callback:e}),this.watchObject(n,s),s}watchObject(t,e){var r;const i=null!==(r=this.watchedObjects.get(t))&&void 0!==r?r:[];i.push(e),this.watchedObjects.set(t,i)}unwatchObject(t,e){var r;const i=null!==(r=this.watchedObjects.get(t))&&void 0!==r?r:[];i.splice(i.indexOf(e),1),0===i.length?this.watchedObjects.delete(t):this.watchedObjects.set(t,i)}clearWatch(t){const e=this.watchers.get(t);void 0!==e.timer&&clearInterval(e.timer),this.watchers.delete(t),this.unwatchObject(e.uid,t)}}let Xe=class RemoteService extends L{constructor(){super(),this.nodes=new Set,this.localServices=new Set,this.remoteServices=new Set,this.promises=new Map,this.once("build",this._registerServices.bind(this))}_registerServices(){return new Promise((t=>{if(!this.model)return t();this.model.once("ready",(()=>{this.model.findAllServices().forEach((t=>{this.registerService(t)}))})),t()}))}registerPromise(t,e,r){const i=null!=r?r:this.generateUUID();return this.promises.set(i,{resolve:t,reject:e}),i}getPromise(t){const e=this.promises.get(t);return e&&this.promises.delete(t),e}localPush(t,e,r){if(r=r||{},this.nodes.has(t)){this.model.findNodeByUID(t).emit("localpush",e,r)}}localPull(t,e){e=e||{},this.nodes.has(t)&&this.model.findNodeByUID(t).emit("localpull",e)}localEvent(t,e,...r){this.nodes.has(t)&&this.model.findNodeByUID(t).emit("localevent",e,...r)}localServiceCall(t,e,...r){if(this.localServices.has(t)){return(this.model.findService(t)||this.model.findDataService(t))[e](...r)}}registerNode(t){return new Promise((e=>{const r=t instanceof A?t:this.model.findNodeByUID(t);this.nodes.add(r.uid),this.logger("debug",`Registered remote server node ${r.uid}`),e()}))}registerService(t){return new Promise((e=>{t instanceof RemoteServiceProxy?this.remoteServices.add(t.uid):this.localServices.add(t.uid),e()}))}};Xe=(0,n.gn)([d(),(0,n.w6)("design:paramtypes",[])],Xe);class RemoteServiceProxy extends L{constructor(t){super(),this.options=t,this.uid=t.uid}get(t,e){const r=this[e];return r||this.createHandler(t,e)}set(t,e,r){return t[e]=r,!0}createHandler(t,e){if(!this.service){if(this.service=t.model.findService(this.options.service),void 0===this.service||null===this.service)return()=>{};this.service.registerService(this)}return(...r)=>this.service.remoteServiceCall(t.uid,e,...r)}}class DummyDataService extends He{constructor(t,e){super(void 0),this.uid=t,this._dataType=e}get dataType(){return this._dataType}}class DummyService extends L{constructor(t){super(),this.uid=t}}class CalibrationService extends DataObjectService{start(t,e){if(!this.node)throw new Error("Calibration node did not register itself to the calibration service!");this.node.start(t,e)}stop(){if(!this.node)throw new Error("Calibration node did not register itself to the calibration service!");this.node.stop()}suspend(){if(!this.node)throw new Error("Calibration node did not register itself to the calibration service!");this.node.suspend()}}class DataServiceProxy extends ServiceProxy{get(t,e){return"dataType"===e?t.dataType:super.get(t,e)}}let tr=class ModelGraph extends P{constructor(t="model"){super(),this._services=new Map,this._dataServices=new Map,this.name=t,this.referenceSpace=new ee(void 0),this.removeAllListeners("build"),this.removeAllListeners("destroy"),this.once("build",this._onModelBuild.bind(this)),this.once("destroy",this._onModelDestroy.bind(this))}_onModelBuild(t){return new Promise(((e,r)=>{this.emit("prebuild",t),this._buildServices().then((()=>{for(const t of this.findAllServices())t.isReady()||t.emit("ready");return this._buildNodes(t)})).then((()=>{for(const t of this.nodes)t.isReady()||t.emit("ready");this.emit("ready"),this.emit("postbuild",this),e()})).catch(r)}))}_buildServices(){return new Promise(((t,e)=>{const r=[];this._services.forEach((t=>{t.isReady()||r.push(t.emitAsync("build"))})),this._dataServices.forEach((t=>{t.isReady()||r.push(t.emitAsync("build"))})),Promise.all(r).then((()=>t())).catch(e)}))}_buildNodes(t){return new Promise(((e,r)=>{const i=[];this.nodes.forEach((e=>{e.isReady()||i.push(e.emitAsync("build",t))})),Promise.all(i).then((()=>e())).catch(r)}))}_onModelDestroy(t){return new Promise(((e,r)=>{const i=[];this._services.forEach((e=>{i.push(e.emitAsync("destroy",t))})),this._dataServices.forEach((e=>{i.push(e.emitAsync("destroy",t))})),this.nodes.forEach((e=>{i.push(e.emitAsync("destroy",t))})),Promise.all(i).then((()=>{e()})).catch(r)}))}findService(t){let e;if(t)return e="string"==typeof t?this._services.get(t):Array.from(this._services.values()).filter((e=>e instanceof t))[0],e||(e=this.findDataService(t)),e}findDataService(t){let e;return e=void 0===t?void 0:"string"==typeof t?this._findDataServiceByUID(t):t.prototype instanceof He?this.findAllServices(t)[0]:t instanceof Function?this.findAllDataServices(t)[0]:this.findDataService(t.constructor),e}_findDataServiceByUID(t){return Array.from(this._dataServices.values()).filter((e=>e.uid===t))[0]}findAllServices(t){return void 0!==t?this.findAllServices().filter((e=>e instanceof t))||[]:Array.from(this._services.values()).concat(Array.from(this._dataServices.values()))||[]}findAllDataServices(t){return void 0!==t?this.findAllDataServices().map((e=>[e,...this._instanceofPriority(t,e.target.dataType)])).filter((t=>t[1])).sort(((t,e)=>t[2]===e[2]?e[0].priority-t[0].priority:t[2]-e[2])).map((t=>t[0]))||[]:Array.from(this._dataServices.values())||[]}_instanceofPriority(t,e){if(t===e)return[!0,0];let r=1;for(;t=Object.getPrototypeOf(t);){if(t===e)return[!0,r];r++}return[!1,void 0]}addService(t,e){t.model=void 0===this.graph?this:this.model,t instanceof He?this._dataServices.set(t.uid,new Proxy(t,e||new DataServiceProxy)):this._services.set(t.uid,new Proxy(t,e||new ServiceProxy))}push(t,e){return new Promise(((r,i)=>{const n=[],s=this.findDataService(t.constructor.name);s&&(Array.isArray(t)?t.forEach((e=>{n.push(s.insert(e.uid,t))})):n.push(s.insert(t.uid,t))),Promise.all(n).then((()=>this.internalSource.push(t,e))).then((()=>{r()})).catch(i)}))}destroy(){return this.emitAsync("destroy")}};(0,n.gn)([D(String,L,{name:"services"}),(0,n.w6)("design:type",Map)],tr.prototype,"_services",void 0),(0,n.gn)([D(String,He,{name:"dataServices"}),(0,n.w6)("design:type",Map)],tr.prototype,"_dataServices",void 0),(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",ee)],tr.prototype,"referenceSpace",void 0),tr=(0,n.gn)([d(),(0,n.w6)("design:paramtypes",[Object])],tr);class ModelBuilder extends GraphBuilder{constructor(){super(new tr),this.graph.name="model",this.graph.addService(new DataObjectService(new MemoryDataService(Rt))),this.graph.addService(new DataObjectService(new MemoryDataService(ee))),this.graph.addService(new NodeDataService(new MemoryDataService(Ye))),this.graph.addService(new B)}static create(){return new ModelBuilder}withLogger(t){return this.graph.logger=t,this}withReferenceSpace(t){return this.graph.referenceSpace=t,this}addService(t,e){return this.graph.addService(t,e),this}addServices(...t){return t.forEach((t=>this.addService(t))),this}addShape(t){return t instanceof tr?t.findAllServices().forEach((t=>{this.addService(t)})):t instanceof ModelBuilder&&t.graph.findAllServices().forEach((t=>{this.addService(t)})),super.addShape(t)}build(){return new Promise(((t,e)=>{GraphValidator.validate(this.graph),this.graph.once("ready",(()=>{t(this.graph)})),this.graph.emitAsync("build",this).catch((t=>{this.graph.emit("destroy"),e(t)}))}))}}let er=class SinkNode extends A{constructor(t){super(t),this.options.completedEvent=void 0===this.options.completedEvent||this.options.completedEvent,this.options.persistence=void 0===this.options.persistence||this.options.persistence}push(t,e){return new Promise(((r,i)=>{if(null==t)return i();this.onPush(t,e).then((()=>{const e=[];return t instanceof Array?t.forEach((t=>{this.options.persistence&&e.push(this.persistDataObject(t))})):this.options.persistence&&e.push(this.persistDataObject(t)),Promise.all(e)})).then((()=>{r(),this.options.completedEvent&&(t instanceof Array?t.forEach((t=>{this.emit("completed",{frameUID:t.uid})})):this.emit("completed",{frameUID:t.uid}))})).catch(i)}))}persistDataObject(t){return new Promise(((e,r)=>{const i=[],n=t.getObjects();for(const t of n){null===t.uid&&(t.uid=E());const e=this.model.findDataService(t);i.push(e.insert(t.uid,t))}Promise.all(i).then((()=>e())).catch(r)}))}};er=(0,n.gn)([d(),(0,n.w6)("design:paramtypes",[Object])],er);let rr=class ProcessingNode extends A{constructor(t){super(t),this.options.frameFilter=this.options.frameFilter||(()=>!0),this.on("push",this._onPush.bind(this))}_onPush(t,e){return new Promise(((r,i)=>{const n=[];Array.isArray(t)?(t.filter((t=>this.options.frameFilter(t))).forEach((t=>{n.push(this.process(t,e))})),t.filter((t=>!this.options.frameFilter(t))).forEach((t=>{n.push(Promise.resolve(t))}))):this.options.frameFilter(t)?n.push(this.process(t,e)):n.push(Promise.resolve(t)),Promise.all(n).then((t=>{const i=t.filter((t=>void 0!==t));i.length>0&&this.outlets.forEach((t=>t.push(1===i.length?i[0]:i,e))),r()})).catch((t=>{void 0===t&&this.logger("warn",`Exception thrown in processing node ${this.uid} but no exception given!`),i(t)}))}))}findNodeDataService(){return this.model.findDataService(Ye)}getNodeData(t,e=undefined){return new Promise(((r,i)=>{this.findNodeDataService().findData(this.uid,t).then((t=>{r(t||e)})).catch(i)}))}setNodeData(t,e){return new Promise(((r,i)=>{this.findNodeDataService().insertData(this.uid,t,e).then(r).catch(i)}))}};rr=(0,n.gn)([d(),(0,n.w6)("design:paramtypes",[Object])],rr);class ObjectProcessingNode extends rr{constructor(t){super(t),this.options.objectFilter=this.options.objectFilter||(()=>!0)}process(t,e){return new Promise(((r,i)=>{const n=[],s=[],o=t.source?t.source.uid:void 0;t.getObjects().filter((e=>this.options.objectFilter(e,t))).forEach((r=>{s.push(r.uid),n.push(this.processObject(r,t,e))})),Promise.all(n).then((e=>{t.clearObjects(this.options.objectFilter),e.forEach(((e,r)=>{const i=s[r];t.addObject(e),i===o&&(t.source=e)})),r(t)})).catch(i)}))}findObjectByUID(t,e,r){if(void 0!==e&&e.hasObject(new Rt(t)))return new Promise((r=>{r(e.getObjectByUID(t))}));let i;return void 0!==r&&(i=this.model.findDataService(r)),i=i||this.model.findDataService(Rt),new Promise((e=>{i.findByUID(t).then(e).catch((()=>e(void 0)))}))}}class CallbackNode extends A{constructor(t=(()=>!0),e=(()=>null),r){super(r),this.pushCallback=t,this.pullCallback=e,this.on("push",this._onPush.bind(this)),this.on("pull",this._onPull.bind(this)),this.options.autoPush=this.options.autoPush||!0}_onPush(t,e){return new Promise(((r,i)=>{Promise.resolve(this.pushCallback(t,e)).then((()=>{if(this.options.autoPush)return Promise.all(this.outlets.map((r=>r.push(t,e))));r()})).then((()=>{r()})).catch(i)}))}_onPull(t){return new Promise(((e,r)=>{Promise.resolve(this.pullCallback(t)).then((i=>{null!=i?Promise.all(this.outlets.map((e=>e.push(i,t)))).then((()=>{e()})).catch(r):Promise.all(this.inlets.map((e=>e.pull(t)))).then((()=>{e()})).catch(r)})).catch(r)}))}}class RemoteNode extends A{constructor(t,e){var r,i;super(t),this.proxyNode=e,this.options.service=this.options.service||Xe,this.options.serialize=null!==(r=this.options.serialize)&&void 0!==r?r:t=>u.C.serialize(t),this.options.deserialize=null!==(i=this.options.deserialize)&&void 0!==i?i:t=>u.C.deserialize(t),this.on("push",this._onPush.bind(this)),this.on("pull",this._onPull.bind(this)),this.on("error",this._onDownstreamError.bind(this)),this.on("completed",this._onDownstreamCompleted.bind(this)),this.on("localpush",this._onLocalPush.bind(this)),this.on("localpull",this._onLocalPull.bind(this)),this.on("localevent",this._onLocalEvent.bind(this)),this.once("build",this._onBuild.bind(this))}_onBuild(){return new Promise(((t,e)=>{if(this.service=this.graph.findService(this.options.service),void 0===this.service||null===this.service)return e(new Error("Remote service was not added to model!"));this.service.registerNode(this).then(t).catch(e)}))}_onPush(t,e){return new Promise((r=>{this.service.remotePush(this.uid,t,Object.assign(Object.assign({},e),this.options)),r()}))}_onPull(t){return new Promise((e=>{this.service.remotePull(this.uid,t),e()}))}_onLocalPush(t,e){return new Promise((r=>{const i=t instanceof te?t:this.options.deserialize(t,e);this.outlets.forEach((t=>t.push(i,e))),r()}))}_onLocalPull(t){return new Promise(((e,r)=>{Promise.all(this.inlets.map((e=>e.pull(t)))).then((()=>{e()})).catch(r)}))}_onLocalEvent(t,e){this.inlets.forEach((r=>r.emit(t,e)))}_onDownstreamCompleted(t){this.service.remoteEvent(this.uid,"completed",t)}_onDownstreamError(t){this.service.remoteEvent(this.uid,"error",t)}}class GraphShapeNode extends A{constructor(t){super(t),this.once("build",this._onBuild.bind(this)),this.once("destroy",this._onDestroy.bind(this))}_onBuild(){return new Promise(((t,e)=>{this.construct(this._builder),this._builder.build().then((e=>{this._graph=e,this._builder=null,t()})).catch(e)}))}_onDestroy(){return this._graph.emitAsync("destroy")}pull(t){return this._graph.pull(t)}push(t,e={}){return this._graph.push(t,e)}get processingGraph(){return this._graph}}class CallbackSinkNode extends er{constructor(t=(()=>null),e){super(e),this.callback=t}onPush(t,e){return new Promise(((r,i)=>{Promise.resolve(this.callback(t,e)).then(r).catch(i)}))}}class LoggingSinkNode extends CallbackSinkNode{constructor(t,e){super(t,e),void 0===t&&(this.callback=t=>{this.logger("debug",`Received a data frame in node ${this.uid}`,t)})}}class RemoteSinkNode extends er{constructor(t){var e;super(t),this.remoteNode=new(null!==(e=t.type)&&void 0!==e?e:RemoteNode)(t,this),this.uid=`${this.uid}-sink`,this.once("build",this._onRemoteBuild.bind(this)),this.once("destroy",this._onRemoteDestroy.bind(this))}_onRemoteBuild(t){return this.remoteNode.graph=this.graph,t.addNode(this.remoteNode),t.addEdge(new Edge(this,this.remoteNode)),this.remoteNode.emitAsync("build",t)}_onRemoteDestroy(){return this.remoteNode.emitAsync("destroy")}onPush(t,e){return this.remoteNode.push(t,e)}}class ReferenceSpaceConversionNode extends ObjectProcessingNode{constructor(t,e){super(e),t instanceof ee?(this._referenceSpace=t,this._referenceSpaceUID=t.uid):this._referenceSpaceUID=t,this.once("build",this._onRegisterService.bind(this))}_onRegisterService(){return new Promise((t=>{const e=this.graph.findDataService(ee);e.on("insert",((t,e)=>{t===this._referenceSpaceUID&&(this._referenceSpace=e)})),e.findByUID(this._referenceSpaceUID).then((e=>{this._referenceSpace=e,t()})).catch((()=>{t()}))}))}processObject(t,e){return new Promise((r=>{let i=e.getObjectByUID(this._referenceSpaceUID);null==i&&(i=this._referenceSpace),t.getPosition()&&t.uid!==i.uid&&(this.options.inverse?t.setPosition(t.getPosition(),i):t.setPosition(t.getPosition(i))),r(t)}))}}class FilterProcessingNode extends ObjectProcessingNode{constructor(t){super(t)}processObject(t,e){return new Promise(((r,i)=>{this.getNodeData(t).then((s=>(0,n.mG)(this,void 0,void 0,(function*(){void 0===s?s=Object.assign({timestamp:B.now()},yield this.initFilter(t,e,this.options)):s.timestamp?s.timestamp+this.options.expire<B.now()&&(s=Object.assign({timestamp:B.now()},yield this.initFilter(t,e,this.options))):s=Object.assign({timestamp:B.now()},s),this.filter(t,e,s,this.options).then((t=>{r(t)})).catch(i).finally((()=>{this.setNodeData(t,s).then((()=>{r(void 0)})).catch(i)}))})))).catch(i)}))}}class PropertyFilterProcessingNode extends ObjectProcessingNode{constructor(t,e,r){super(r),this._propertySelector=t,this._propertyModifier=e}processObject(t,e){return new Promise(((r,i)=>{const n=this._propertySelector(t,e);Promise.all(n.map((e=>this.filterValue(t,e.value,e.key)))).then((i=>{for(let r=0;r<i.length;r++){const s=i[r],o=n[r];this._propertyModifier(o.key,s,t,e)}r(t)})).catch(i)}))}filterValue(t,e,r="default"){return new Promise(((i,s)=>{this.getNodeData(t).then((o=>(0,n.mG)(this,void 0,void 0,(function*(){void 0===o&&(o={});const n=B.now();if(void 0===o[r]?o[r]=Object.assign({timestamp:n},yield this.initFilter(t,e,this.options)):o[r]=Object.assign({timestamp:n},o[r]),this.options.expire){const t=[];Object.keys(o).forEach((e=>{const r=o[e];r.timestamp&&r.timestamp+this.options.expire<n&&t.push(e)})),t.forEach((t=>{delete o[t]}))}this.filter(t,e,o[r],this.options).then(i).catch(s).finally((()=>{this.setNodeData(t,o)}))})))).catch(s)}))}}class KalmanFilterNode extends PropertyFilterProcessingNode{constructor(t,e,r){super(t,e,r)}initFilter(t,e,r){return new Promise((t=>{Object.keys(r).forEach((t=>{"number"==typeof r[t]&&["R","Q","A","B","C"].includes(t)&&(r[t]=new W(r[t],0,0))})),t(Object.assign({x:void 0,cov:NaN},r))}))}filter(t,e,r){return new Promise((t=>{const i=new KalmanFilter(r.R,r.Q,r.A,r.B,r.C,r.x,r.cov),n="number"==typeof e;n?i.filter(new W(e,0,0)):i.filter(e),r.x=i.measurement,r.cov=i.covariance,t(n?i.measurement.x:i.measurement)}))}}class KalmanFilter{constructor(t,e,r,i,n,s,o){this._R=t,this._Q=e,this._A=r,this._B=i,this._C=n,this._x=s,this._cov=o}filter(t,e){if(void 0===this._x){const e=new W(1,1,1).divide(this._C);this._x=e.clone().multiply(t),this._cov=e.clone().multiply(this._Q).multiply(e)}else{const r=this.predict(e),i=this.uncertainty(),n=i.clone().multiply(this._C).multiply(new W(1,1,1).divide(this._C.clone().multiply(i).multiply(this._C).add(this._Q)));this._x=r.clone().add(n.clone().multiply(t.clone().sub(this._C.clone().multiply(r)))),this._cov=i.clone().sub(n.clone().multiply(this._C).multiply(i))}return this._x}predict(t){return this._A.clone().multiply(this._x).add(void 0===t?new W:this._B.clone().multiply(t))}uncertainty(){return this._A.clone().multiply(this._cov).multiply(this._A).add(this._R)}get measurement(){return this._x}get covariance(){return this._cov}}class LPFilterNode extends PropertyFilterProcessingNode{constructor(t,e,r){super(t,e,r)}initFilter(t,e,r){return new Promise((t=>{let i=r.alpha;if(void 0===i){const t=1/(2*r.cutOff*Math.PI),e=1/r.sampleRate;i=e/(t+e)}t({x:e,alpha:i})}))}filter(t,e,r){return new Promise((t=>{if("number"==typeof e)r.x=r.x+r.alpha*(e-r.x);else{const t=e.clone(),i=r.x;r.x=i.add(t.sub(r.x).multiplyScalar(r.alpha))}t(r.x)}))}}class HPFilterNode extends PropertyFilterProcessingNode{constructor(t,e,r){super(t,e,r)}initFilter(t,e,r){return new Promise((t=>{const i=1/(2*r.cutOff*Math.PI),n=1/r.sampleRate;t({x:e,y:e,alpha:i/(i+n)})}))}filter(t,e,r){return new Promise((t=>{"number"==typeof e?(r.x=r.alpha*(r.x+e-r.y),r.y=e,t(r.x)):(r.x=r.x.clone().add(e).sub(r.y).multiplyScalar(r.alpha),r.y=e,t(r.x))}))}}class SMAFilterNode extends PropertyFilterProcessingNode{constructor(t,e,r){super(t,e,r)}initFilter(t,e,r){return new Promise((t=>{if(r.taps<1)throw new Error("Filter taps needs to be higher than 1!");t({x:[],taps:r.taps})}))}filter(t,e,r,i){return new Promise((t=>{if(r.x.push(e),r.x.length>r.taps?r.x.shift():i.minTaps&&r.x.length<i.minTaps&&t(e),"number"==typeof e){t(r.x.reduce(((t,e)=>t+e))/r.taps)}else{const e=r.x[0].clone();for(let t=1;t<r.x.length;t++)e.add(r.x[t]);t(e.divideScalar(r.taps))}}))}}class EMAFilterNode extends PropertyFilterProcessingNode{constructor(t,e,r){super(t,e,r)}initFilter(t,e,r){return new Promise((t=>{if(r.alpha>1||r.alpha<0)throw new Error("Filter coefficient needs to be between 0 and 1!");t({x:e,alpha:r.alpha})}))}filter(t,e,r){return new Promise((t=>{if("number"==typeof e)r.x=r.x*(1-r.alpha)+r.alpha*e;else{const t=e,i=r.x;r.x=i.clone().multiplyScalar(1-r.alpha).add(t.clone().multiplyScalar(r.alpha))}t(r.x)}))}}class RelativePositionFilter extends KalmanFilterNode{constructor(t,e){super(void 0,void 0,e),this._relativePositionType=t,this.options.minValue=this.options.minValue||0,this.options.maxValue=this.options.maxValue||100,this.options.maxTimeDifference=this.options.maxTimeDifference||1/0}processObject(t){return new Promise(((e,r)=>{const i=t.relativePositions.filter((t=>t instanceof this._relativePositionType));Promise.all(i.map((e=>this.filterValue(t,e.referenceValue,e.referenceObjectUID)))).then((r=>{r.forEach(((e,r)=>{const n=e,s=i[r];"number"==typeof n&&n<=this.options.maxValue&&n>=this.options.minValue&&B.now()-this.options.maxTimeDifference<=s.timestamp?s.referenceValue=n:t.removeRelativePositions(s.referenceObjectUID)})),e(t)})).catch(r)}))}}class RelativePositionProcessing extends ObjectProcessingNode{constructor(t,e){super(e),this._relativePositionType=t}processObject(t,e){return new Promise(((r,i)=>{const n=[],s=new Map;for(const r of t.relativePositions)r instanceof this._relativePositionType&&(s.set(r.referenceObjectUID,r),n.push(this.findObjectByUID(r.referenceObjectUID,e,r.referenceObjectType)));Promise.all(n).then((r=>{const i=new Map;return r.filter((t=>void 0!==t)).forEach((t=>{i.set(s.get(t.uid),t)})),this.processRelativePositions(t,i,e)})).then((t=>{r(t)})).catch(i)}))}}class MultilaterationNode extends RelativePositionProcessing{constructor(t){super(ve,t),this.options.incrementStep=this.options.incrementStep||1,this.options.minReferences=this.options.minReferences||1,this.options.nlsFunction=this.options.nlsFunction||this.nls.bind(this)}processRelativePositions(t,e,r){return new Promise(((i,n)=>{let s,o=[];if(e.forEach(((t,e)=>{t.getPosition()&&o.push(new Sphere(t.getPosition(),e.distance,e.accuracy.valueOf()))})),o=o.sort(((t,e)=>t.radius-e.radius)),o.length<this.options.minReferences)return i(t);switch(o.length>this.options.maxReferences&&(o=o.splice(0,this.options.maxReferences)),o.length){case 0:return i(t);case 1:return s=o[0].position.clone(),s.timestamp=r.createdTimestamp,s.accuracy=new J(o[0].radius+s.accuracy.valueOf()+o[0].accuracy,s.unit),t.setPosition(s),i(t);case 2:return s=o[0].position instanceof ge?this.midpointGeographical(o[0],o[1]):this.midpoint(o[0],o[1]),s.timestamp=r.createdTimestamp,s.accuracy=new J(o.map((t=>t.accuracy)).reduce(((t,e)=>t.valueOf()+e.valueOf()))/o.length,s.unit),t.setPosition(s),i(t);case 3:if(!this.options.preferNls){this.trilaterate(o).then((e=>{e&&(e.timestamp=r.createdTimestamp,e.accuracy=new J(o.map((t=>t.accuracy)).reduce(((t,e)=>t.valueOf()+e.valueOf()))/o.length,e.unit),t.setPosition(e)),i(t)})).catch(n);break}default:s=this.options.nlsFunction(o),s.timestamp=r.createdTimestamp,s.accuracy=new J(o.map((t=>t.accuracy)).reduce(((t,e)=>t.valueOf()+e.valueOf()))/o.length,s.unit),t.setPosition(s),i(t)}}))}nls(t){const e=e=>this._calculateError(e,t),r=this._calculateInit(t),i=this.options.maxIterations;let n=0;const s=r.length,o=new Array(s+1);o[0]=r,o[0].fx=e(r),o[0].id=0;for(let t=0;t<s;++t){const i=r.slice();i[t]=i[t]?1.05*i[t]:.001,o[t+1]=i,o[t+1].fx=e(i),o[t+1].id=t+1}function a(t){for(let e=0;e<t.length;e++)o[s][e]=t[e];o[s].fx=t.fx}function c(t,e,r,i,n){for(let s=0;s<t.length;++s)t[s]=e*r[s]+i*n[s]}const h=(t,e)=>t.fx-e.fx,u=r.slice(),l=r.slice(),p=r.slice(),d=r.slice();for(let t=0;t<i;++t){o.sort(h),n=0;for(let t=0;t<s;++t)n=Math.max(n,Math.abs(o[0][t]-o[1][t]));if(Math.abs(o[0].fx-o[s].fx)<1e-6&&n<1e-5)break;for(let t=0;t<s;++t){u[t]=0;for(let e=0;e<s;++e)u[t]+=o[e][t];u[t]/=s}const t=o[s];if(c(l,2,u,-1,t),l.fx=e(l),l.fx<o[0].fx)c(d,3,u,-2,t),d.fx=e(d),d.fx<l.fx?a(d):a(l);else if(l.fx>=o[s-1].fx){let r=!1;if(l.fx>t.fx?(c(p,.5,u,.5,t),p.fx=e(p),p.fx<t.fx?a(p):r=!0):(c(p,1.5,u,-.5,t),p.fx=e(p),p.fx<l.fx?a(p):r=!0),r){0;for(let t=1;t<o.length;++t)c(o[t],.5,o[0],.5,o[t]),o[t].fx=e(o[t])}}else a(l)}o.sort(h);const y=t[0].position.clone();return y.fromVector(new W(...o[0])),y}midpoint(t,e){const r=t.position,i=e.position,n=r.clone();return n.fromVector(r.toVector3().multiplyScalar(e.radius).add(i.toVector3().multiplyScalar(t.radius)).divideScalar(t.radius+e.radius)),n}midpointGeographical(t,e){const r=t.position,i=e.position;if(t.radius===e.radius){const t=U.DEGREE.convert(r.longitude,U.RADIAN),e=U.DEGREE.convert(r.latitude,U.RADIAN),n=U.DEGREE.convert(i.longitude,U.RADIAN),s=U.DEGREE.convert(i.latitude,U.RADIAN),o=Math.cos(s)*Math.cos(n-t),a=Math.cos(s)*Math.sin(n-t),c=Math.atan2(Math.sin(e)+Math.sin(s),Math.sqrt((Math.cos(e)+o)*(Math.cos(e)+o)+a*a)),h=t+Math.atan2(a,Math.cos(e)+o),u=new ge;return u.latitude=U.RADIAN.convert(c,U.DEGREE),u.longitude=U.RADIAN.convert(h,U.DEGREE),u}{const n=r.bearing(i),s=i.bearing(r),o=r.destination(n,t.radius),a=i.destination(s,e.radius),c=this.midpoint(new Sphere(o,1,o.accuracy.valueOf()),new Sphere(a,1,a.accuracy.valueOf()));return c.accuracy=new J(Math.round(o.distanceTo(a)/2*100)/100,c.unit),c}}trilaterate(t){return new Promise((e=>{const r=this.options.maxIterations||900,i=t.map((t=>t.center)),n=i[1].clone().sub(i[0]).normalize(),s=n.clone().dot(i[2].clone().sub(i[0])),o=i[2].clone().sub(i[0]).sub(n.clone().multiplyScalar(s)).normalize(),a=n.clone().cross(o),c=i[1].clone().sub(i[0]).length(),h=o.clone().dot(i[2].clone().sub(i[0]));let u=t[0].radius,l=t[1].radius,p=t[2].radius,d=0,y=0,f=-1,m=0;do{d=(Math.pow(u,2)-Math.pow(l,2)+Math.pow(c,2))/(2*c),y=(Math.pow(u,2)-Math.pow(p,2)+Math.pow(s,2)+Math.pow(h,2))/(2*h)-s/h*d,f=Math.pow(u,2)-Math.pow(d,2)-Math.pow(y,2),u+=this.options.incrementStep,l+=this.options.incrementStep,p+=this.options.incrementStep,m++}while(f<-1e-10&&m<r);const g=Math.sqrt(f)||0,_=t[0].position.clone();return _.fromVector(i[0].clone().add(n.multiplyScalar(d)).add(o.multiplyScalar(y)).add(a.multiplyScalar(g))),e(_)}))}_calculateInit(t){const e=t[0],r=t.map((t=>t.radius)).reduce(((t,e)=>t+e)),i=new W(0,0,0);t.forEach((e=>{const n=(r-e.radius)/((t.length-1)*r);i.add(e.center.clone().multiplyScalar(n))}));const n=Math.min(1,e.radius/e.center.distanceTo(i)*.9);return i.multiplyScalar(n).add(e.center.clone().multiplyScalar(1-n)).toArray()}_calculateError(t,e){return e.map((e=>Math.pow(new W(...t).distanceTo(e.center)-e.radius,2))).reduce(((t,e)=>t+e))}}class Sphere{constructor(t,e,r){this.position=t,this.radius=e,this.accuracy=r}get center(){return this.position.toVector3()}}class TriangulationNode extends RelativePositionProcessing{constructor(t){super(_e,t)}processRelativePositions(t,e,r){return new Promise(((i,n)=>{const s=[],o=[],a=[];switch(e.forEach(((t,e)=>{t.getPosition()&&(s.push(t),o.push(t.getPosition()),a.push(e.angleUnit.convert(e.angle,U.RADIAN)))})),s.length){case 0:case 1:default:return i(t);case 2:break;case 3:this.triangulate(o,a).then((e=>{null!==e&&(e.timestamp=r.createdTimestamp,t.setPosition(e)),i(t)})).catch(n)}}))}triangulate(t,e){return new Promise(((r,i)=>{const n=[t[0].toVector3(),t[1].toVector3(),t[2].toVector3()],s=n[0].x-n[1].x,o=n[0].y-n[1].y,a=n[2].x-n[1].x,c=n[2].y-n[1].y,h=1/Math.tan(e[1]-e[0]),u=1/Math.tan(e[2]-e[1]),l=(1-h*u)/(h+u),p=s+h*o,d=o-h*s,y=a-u*c,f=c+u*a,m=s*a+o*c+l*(s*c-a*o),g=(p-y)*(f-(c+o-l*(a-s)))-(d-f)*(y-(a+s+l*(c-o)));if(0===g)return i();const _=n[1].x+m*(d-f)/g,v=n[1].y+m*(y-p)/g,w=t[0].clone();return w.unit=t[0].unit,w.fromVector(new W(_,v,0)),r(w)}))}}class AccuracyModifierNode extends ObjectProcessingNode{constructor(t){super(t),this.options.offsetUnit=this.options.offsetUnit||R.METER,this.options.offset=this.options.offset||0,this.options.magnitude=this.options.magnitude||1}processObject(t){return new Promise((e=>{if(t.position)if(this.options.value)t.position.accuracy.value=R.METER.convert(this.options.value,t.position.unit);else{const e=t.position.accuracy.value||this.options.defaultValue;if(e){const r=this.options.offsetUnit.convert(this.options.offset,t.position.unit);t.position.accuracy.value=e*this.options.magnitude+r}}e(t)}))}}class CellIdentificationNode extends RelativePositionProcessing{constructor(t){super(ve,t),this.options.maxDistance=this.options.maxDistance||2}processRelativePositions(t,e,r){return new Promise((i=>{let n=[];if(e.forEach(((t,e)=>{t.getPosition()&&n.push([t.getPosition(),e.distance])})),n=n.sort(((t,e)=>t[1]-e[1])),n.length>0&&n[0][1]<=this.options.maxDistance){const e=n[0][0].clone();return e.timestamp=r.createdTimestamp,e.accuracy.value=n[0][1],t.setPosition(e),i(t)}i(t)}))}}class CalibrationNode extends ObjectProcessingNode{constructor(t){super(t),this.state=ir.IDLE,this.once("build",this._onBuild.bind(this))}_onBuild(){if(this.service=this.model.findService(this.options.service),!this.service)throw new Error(`Calibration node requires a calibration service of type '${this.options.service.name}'!`);this.service.node=this}processObject(t){return new Promise(((e,r)=>{this.state!==ir.RUNNING?e(t):this.objectCallback?Promise.resolve(this.objectCallback(t)).then((t=>{e(t)})).catch(r):e(t)}))}process(t){return new Promise(((e,r)=>{this.state===ir.SUSPENDED?e(void 0):this.state===ir.RUNNING?this.frameCallback?Promise.resolve(this.frameCallback(t)).then((e=>{var r;return super.process(null!==(r=e)&&void 0!==r?r:t)})).then((()=>{e(void 0)})).catch(r):super.process(t).then((()=>{e(void 0)})):e(t)}))}start(t,e){this.objectCallback=t,this.frameCallback=e,this.state=ir.RUNNING}suspend(){this.state=ir.SUSPENDED}stop(){this.state=ir.IDLE}}var ir;!function(t){t[t.IDLE=0]="IDLE",t[t.SUSPENDED=1]="SUSPENDED",t[t.RUNNING=2]="RUNNING"}(ir||(ir={}));class ListSourceNode extends Ct{constructor(t,e){super(e),this._inputData=[],this._inputData=t}get inputData(){return this._inputData}set inputData(t){this._inputData=t}get size(){return this._inputData.length}onPull(){return new Promise((t=>{0!==this._inputData.length&&t(this._inputData.shift()),t(null)}))}}class CallbackSourceNode extends Ct{constructor(t=(()=>null),e){super(e),this.callback=t}onPull(t){return new Promise(((e,r)=>{Promise.resolve(this.callback(t)).then((t=>{e(t)})).catch(r)}))}}class HistorySourceNode extends Ct{constructor(t){super(t)}onPull(t={requestedObjects:[]}){return new Promise(((e,r)=>{const i=this.model.findDataService(Rt),n=[];t.requestedObjects.forEach((t=>{n.push(new Promise((e=>{i.findByUID(t).then((t=>{e(t)})).catch((()=>{e(void 0)}))})))})),Promise.all(n).then((t=>{const r=new te(this.source);t.forEach((t=>{t&&r.addObject(t)})),e(r)})).catch(r)}))}}class RemoteSourceNode extends Ct{constructor(t){var e;super(t),this.remoteNode=new(null!==(e=t.type)&&void 0!==e?e:RemoteNode)(t,this),this.uid=`${this.uid}-source`,this.once("build",this._onRemoteBuild.bind(this)),this.on("error",this._onDownstreamError.bind(this)),this.on("completed",this._onDownstreamCompleted.bind(this))}_onRemoteBuild(t){return this.remoteNode.graph=this.graph,t.addNode(this.remoteNode),t.addEdge(new Edge(this.remoteNode,this)),this.remoteNode.emitAsync("build",t)}onPull(){return new Promise(((t,e)=>{this.remoteNode.pull().then((()=>{t(void 0)})).catch(e)}))}_onDownstreamError(t){this.remoteNode.emit("error",t)}_onDownstreamCompleted(t){this.remoteNode.emit("completed",t)}}class ModelSerializer{static get options(){return{serialize:u.C.serialize,deserialize:u.C.deserialize}}static serialize(t){return this.serializeNode(t)}static serializeNode(t){return this.initialize(),this.options.serialize(t)}static deserialize(t){const e=this.deserializeNode(t);return e.nodes.forEach((t=>{t.graph=e})),e}static deserializeNode(t){return this.initialize(),this.options.deserialize(t)}static loadClasses(t=r.c[r.s]){void 0!==t?(this._modules.add(t.id),t.exports&&Object.keys(t.exports).forEach((e=>{const r=t.exports[e];r&&r.prototype instanceof A?this.NODES.set(e,{constructor:r}):r&&r.prototype instanceof L&&this.SERVICES.set(e,{constructor:r})})),t.children&&t.children.forEach((t=>{this._modules.has(t.id)||this.loadClasses(t)}))):Object.values(r.c).map((t=>this.loadClasses(t)))}static initialize(){0!==this.SERVICES.size&&0!==this.NODES.size||(this.loadClasses(),this._modules.clear(),this.SERVICES.forEach((t=>u.C.registerType(t.constructor))),this.NODES.forEach((t=>u.C.registerType(t.constructor))))}}ModelSerializer.NODES=new Map,ModelSerializer.SERVICES=new Map,ModelSerializer._modules=new Set},750:(t,e,r)=>{"use strict";function i(t,e){if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t.getUint8(r)!==e.getUint8(r))return!1;return!0}r.d(e,{o:()=>n});const n={toHexString:function(t){if(t)return t.reduce(((t,e)=>t+e.toString(16).padStart(2,"0")),"")},fromHexString:function(t){if(t)return Uint8Array.from(t.match(/.{1,2}/g).map((t=>parseInt(t,16))))},arrayBuffersAreEqual:function(t,e){return i(new DataView(t),new DataView(e))},concatBuffer:function(...t){const e=new Uint8Array(t.map((t=>t.byteLength)).reduce(((t,e)=>t+e)));return t.forEach(((r,i)=>{e.set(r,i>0?t[i-1].byteLength:0)})),e},dataViewsAreEqual:i}},187:t=>{"use strict";var e,r="object"==typeof Reflect?Reflect:null,i=r&&"function"==typeof r.apply?r.apply:function(t,e,r){return Function.prototype.apply.call(t,e,r)};e=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var n=Number.isNaN||function(t){return t!=t};function s(){s.init.call(this)}t.exports=s,t.exports.once=function(t,e){return new Promise((function(r,i){function n(r){t.removeListener(e,s),i(r)}function s(){"function"==typeof t.removeListener&&t.removeListener("error",n),r([].slice.call(arguments))}f(t,e,s,{once:!0}),"error"!==e&&function(t,e,r){"function"==typeof t.on&&f(t,"error",e,r)}(t,n,{once:!0})}))},s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var o=10;function a(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function c(t){return void 0===t._maxListeners?s.defaultMaxListeners:t._maxListeners}function h(t,e,r,i){var n,s,o,h;if(a(r),void 0===(s=t._events)?(s=t._events=Object.create(null),t._eventsCount=0):(void 0!==s.newListener&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),o=s[e]),void 0===o)o=s[e]=r,++t._eventsCount;else if("function"==typeof o?o=s[e]=i?[r,o]:[o,r]:i?o.unshift(r):o.push(r),(n=c(t))>0&&o.length>n&&!o.warned){o.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=t,u.type=e,u.count=o.length,h=u,console&&console.warn&&console.warn(h)}return t}function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function l(t,e,r){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},n=u.bind(i);return n.listener=r,i.wrapFn=n,n}function p(t,e,r){var i=t._events;if(void 0===i)return[];var n=i[e];return void 0===n?[]:"function"==typeof n?r?[n.listener||n]:[n]:r?function(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}(n):y(n,n.length)}function d(t){var e=this._events;if(void 0!==e){var r=e[t];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function y(t,e){for(var r=new Array(e),i=0;i<e;++i)r[i]=t[i];return r}function f(t,e,r,i){if("function"==typeof t.on)i.once?t.once(e,r):t.on(e,r);else{if("function"!=typeof t.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t);t.addEventListener(e,(function n(s){i.once&&t.removeEventListener(e,n),r(s)}))}}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(t){if("number"!=typeof t||t<0||n(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");o=t}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||n(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},s.prototype.getMaxListeners=function(){return c(this)},s.prototype.emit=function(t){for(var e=[],r=1;r<arguments.length;r++)e.push(arguments[r]);var n="error"===t,s=this._events;if(void 0!==s)n=n&&void 0===s.error;else if(!n)return!1;if(n){var o;if(e.length>0&&(o=e[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=s[t];if(void 0===c)return!1;if("function"==typeof c)i(c,this,e);else{var h=c.length,u=y(c,h);for(r=0;r<h;++r)i(u[r],this,e)}return!0},s.prototype.addListener=function(t,e){return h(this,t,e,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(t,e){return h(this,t,e,!0)},s.prototype.once=function(t,e){return a(e),this.on(t,l(this,t,e)),this},s.prototype.prependOnceListener=function(t,e){return a(e),this.prependListener(t,l(this,t,e)),this},s.prototype.removeListener=function(t,e){var r,i,n,s,o;if(a(e),void 0===(i=this._events))return this;if(void 0===(r=i[t]))return this;if(r===e||r.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,r.listener||e));else if("function"!=typeof r){for(n=-1,s=r.length-1;s>=0;s--)if(r[s]===e||r[s].listener===e){o=r[s].listener,n=s;break}if(n<0)return this;0===n?r.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(r,n),1===r.length&&(i[t]=r[0]),void 0!==i.removeListener&&this.emit("removeListener",t,o||e)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(t){var e,r,i;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[t]),this;if(0===arguments.length){var n,s=Object.keys(r);for(i=0;i<s.length;++i)"removeListener"!==(n=s[i])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=r[t]))this.removeListener(t,e);else if(void 0!==e)for(i=e.length-1;i>=0;i--)this.removeListener(t,e[i]);return this},s.prototype.listeners=function(t){return p(this,t,!0)},s.prototype.rawListeners=function(t){return p(this,t,!1)},s.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):d.call(t,e)},s.prototype.listenerCount=d,s.prototype.eventNames=function(){return this._eventsCount>0?e(this._events):[]}},465:(t,e,r)=>{t=r.nmd(t);var i="__lodash_hash_undefined__",n=9007199254740991,s="[object Arguments]",o="[object Boolean]",a="[object Date]",c="[object Function]",h="[object GeneratorFunction]",u="[object Map]",l="[object Number]",p="[object Object]",d="[object Promise]",y="[object RegExp]",f="[object Set]",m="[object String]",g="[object Symbol]",_="[object WeakMap]",v="[object ArrayBuffer]",w="[object DataView]",b="[object Float32Array]",x="[object Float64Array]",E="[object Int8Array]",M="[object Int16Array]",S="[object Int32Array]",A="[object Uint8Array]",z="[object Uint8ClampedArray]",N="[object Uint16Array]",T="[object Uint32Array]",D=/\w*$/,P=/^\[object .+?Constructor\]$/,O=/^(?:0|[1-9]\d*)$/,R={};R[s]=R["[object Array]"]=R[v]=R[w]=R[o]=R[a]=R[b]=R[x]=R[E]=R[M]=R[S]=R[u]=R[l]=R[p]=R[y]=R[f]=R[m]=R[g]=R[A]=R[z]=R[N]=R[T]=!0,R["[object Error]"]=R[c]=R[_]=!1;var C="object"==typeof r.g&&r.g&&r.g.Object===Object&&r.g,j="object"==typeof self&&self&&self.Object===Object&&self,U=C||j||Function("return this")(),k=e&&!e.nodeType&&e,I=k&&t&&!t.nodeType&&t,L=I&&I.exports===k;function V(t,e){return t.set(e[0],e[1]),t}function F(t,e){return t.add(e),t}function B(t,e,r,i){var n=-1,s=t?t.length:0;for(i&&s&&(r=t[++n]);++n<s;)r=e(r,t[n],n,t);return r}function $(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}function H(t){var e=-1,r=Array(t.size);return t.forEach((function(t,i){r[++e]=[i,t]})),r}function G(t,e){return function(r){return t(e(r))}}function q(t){var e=-1,r=Array(t.size);return t.forEach((function(t){r[++e]=t})),r}var W,K=Array.prototype,J=Function.prototype,Q=Object.prototype,Z=U["__core-js_shared__"],Y=(W=/[^.]+$/.exec(Z&&Z.keys&&Z.keys.IE_PROTO||""))?"Symbol(src)_1."+W:"",X=J.toString,tt=Q.hasOwnProperty,et=Q.toString,rt=RegExp("^"+X.call(tt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),it=L?U.Buffer:void 0,nt=U.Symbol,st=U.Uint8Array,ot=G(Object.getPrototypeOf,Object),at=Object.create,ct=Q.propertyIsEnumerable,ht=K.splice,ut=Object.getOwnPropertySymbols,lt=it?it.isBuffer:void 0,pt=G(Object.keys,Object),dt=It(U,"DataView"),yt=It(U,"Map"),ft=It(U,"Promise"),mt=It(U,"Set"),gt=It(U,"WeakMap"),_t=It(Object,"create"),vt=$t(dt),wt=$t(yt),bt=$t(ft),xt=$t(mt),Et=$t(gt),Mt=nt?nt.prototype:void 0,St=Mt?Mt.valueOf:void 0;function At(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}function zt(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}function Nt(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}function Tt(t){this.__data__=new zt(t)}function Dt(t,e){var r=Gt(t)||function(t){return function(t){return function(t){return!!t&&"object"==typeof t}(t)&&qt(t)}(t)&&tt.call(t,"callee")&&(!ct.call(t,"callee")||et.call(t)==s)}(t)?function(t,e){for(var r=-1,i=Array(t);++r<t;)i[r]=e(r);return i}(t.length,String):[],i=r.length,n=!!i;for(var o in t)!e&&!tt.call(t,o)||n&&("length"==o||Ft(o,i))||r.push(o);return r}function Pt(t,e,r){var i=t[e];tt.call(t,e)&&Ht(i,r)&&(void 0!==r||e in t)||(t[e]=r)}function Ot(t,e){for(var r=t.length;r--;)if(Ht(t[r][0],e))return r;return-1}function Rt(t,e,r,i,n,d,_){var P;if(i&&(P=d?i(t,n,d,_):i(t)),void 0!==P)return P;if(!Jt(t))return t;var O=Gt(t);if(O){if(P=function(t){var e=t.length,r=t.constructor(e);e&&"string"==typeof t[0]&&tt.call(t,"index")&&(r.index=t.index,r.input=t.input);return r}(t),!e)return function(t,e){var r=-1,i=t.length;e||(e=Array(i));for(;++r<i;)e[r]=t[r];return e}(t,P)}else{var C=Vt(t),j=C==c||C==h;if(Wt(t))return function(t,e){if(e)return t.slice();var r=new t.constructor(t.length);return t.copy(r),r}(t,e);if(C==p||C==s||j&&!d){if($(t))return d?t:{};if(P=function(t){return"function"!=typeof t.constructor||Bt(t)?{}:(e=ot(t),Jt(e)?at(e):{});var e}(j?{}:t),!e)return function(t,e){return Ut(t,Lt(t),e)}(t,function(t,e){return t&&Ut(e,Qt(e),t)}(P,t))}else{if(!R[C])return d?t:{};P=function(t,e,r,i){var n=t.constructor;switch(e){case v:return jt(t);case o:case a:return new n(+t);case w:return function(t,e){var r=e?jt(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)}(t,i);case b:case x:case E:case M:case S:case A:case z:case N:case T:return function(t,e){var r=e?jt(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}(t,i);case u:return function(t,e,r){var i=e?r(H(t),!0):H(t);return B(i,V,new t.constructor)}(t,i,r);case l:case m:return new n(t);case y:return function(t){var e=new t.constructor(t.source,D.exec(t));return e.lastIndex=t.lastIndex,e}(t);case f:return function(t,e,r){var i=e?r(q(t),!0):q(t);return B(i,F,new t.constructor)}(t,i,r);case g:return s=t,St?Object(St.call(s)):{}}var s}(t,C,Rt,e)}}_||(_=new Tt);var U=_.get(t);if(U)return U;if(_.set(t,P),!O)var k=r?function(t){return function(t,e,r){var i=e(t);return Gt(t)?i:function(t,e){for(var r=-1,i=e.length,n=t.length;++r<i;)t[n+r]=e[r];return t}(i,r(t))}(t,Qt,Lt)}(t):Qt(t);return function(t,e){for(var r=-1,i=t?t.length:0;++r<i&&!1!==e(t[r],r,t););}(k||t,(function(n,s){k&&(n=t[s=n]),Pt(P,s,Rt(n,e,r,i,s,t,_))})),P}function Ct(t){return!(!Jt(t)||(e=t,Y&&Y in e))&&(Kt(t)||$(t)?rt:P).test($t(t));var e}function jt(t){var e=new t.constructor(t.byteLength);return new st(e).set(new st(t)),e}function Ut(t,e,r,i){r||(r={});for(var n=-1,s=e.length;++n<s;){var o=e[n],a=i?i(r[o],t[o],o,r,t):void 0;Pt(r,o,void 0===a?t[o]:a)}return r}function kt(t,e){var r,i,n=t.__data__;return("string"==(i=typeof(r=e))||"number"==i||"symbol"==i||"boolean"==i?"__proto__"!==r:null===r)?n["string"==typeof e?"string":"hash"]:n.map}function It(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return Ct(r)?r:void 0}At.prototype.clear=function(){this.__data__=_t?_t(null):{}},At.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},At.prototype.get=function(t){var e=this.__data__;if(_t){var r=e[t];return r===i?void 0:r}return tt.call(e,t)?e[t]:void 0},At.prototype.has=function(t){var e=this.__data__;return _t?void 0!==e[t]:tt.call(e,t)},At.prototype.set=function(t,e){return this.__data__[t]=_t&&void 0===e?i:e,this},zt.prototype.clear=function(){this.__data__=[]},zt.prototype.delete=function(t){var e=this.__data__,r=Ot(e,t);return!(r<0)&&(r==e.length-1?e.pop():ht.call(e,r,1),!0)},zt.prototype.get=function(t){var e=this.__data__,r=Ot(e,t);return r<0?void 0:e[r][1]},zt.prototype.has=function(t){return Ot(this.__data__,t)>-1},zt.prototype.set=function(t,e){var r=this.__data__,i=Ot(r,t);return i<0?r.push([t,e]):r[i][1]=e,this},Nt.prototype.clear=function(){this.__data__={hash:new At,map:new(yt||zt),string:new At}},Nt.prototype.delete=function(t){return kt(this,t).delete(t)},Nt.prototype.get=function(t){return kt(this,t).get(t)},Nt.prototype.has=function(t){return kt(this,t).has(t)},Nt.prototype.set=function(t,e){return kt(this,t).set(t,e),this},Tt.prototype.clear=function(){this.__data__=new zt},Tt.prototype.delete=function(t){return this.__data__.delete(t)},Tt.prototype.get=function(t){return this.__data__.get(t)},Tt.prototype.has=function(t){return this.__data__.has(t)},Tt.prototype.set=function(t,e){var r=this.__data__;if(r instanceof zt){var i=r.__data__;if(!yt||i.length<199)return i.push([t,e]),this;r=this.__data__=new Nt(i)}return r.set(t,e),this};var Lt=ut?G(ut,Object):function(){return[]},Vt=function(t){return et.call(t)};function Ft(t,e){return!!(e=null==e?n:e)&&("number"==typeof t||O.test(t))&&t>-1&&t%1==0&&t<e}function Bt(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Q)}function $t(t){if(null!=t){try{return X.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function Ht(t,e){return t===e||t!=t&&e!=e}(dt&&Vt(new dt(new ArrayBuffer(1)))!=w||yt&&Vt(new yt)!=u||ft&&Vt(ft.resolve())!=d||mt&&Vt(new mt)!=f||gt&&Vt(new gt)!=_)&&(Vt=function(t){var e=et.call(t),r=e==p?t.constructor:void 0,i=r?$t(r):void 0;if(i)switch(i){case vt:return w;case wt:return u;case bt:return d;case xt:return f;case Et:return _}return e});var Gt=Array.isArray;function qt(t){return null!=t&&function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=n}(t.length)&&!Kt(t)}var Wt=lt||function(){return!1};function Kt(t){var e=Jt(t)?et.call(t):"";return e==c||e==h}function Jt(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function Qt(t){return qt(t)?Dt(t):function(t){if(!Bt(t))return pt(t);var e=[];for(var r in Object(t))tt.call(t,r)&&"constructor"!=r&&e.push(r);return e}(t)}t.exports=function(t){return Rt(t,!0,!0)}},660:(t,e,r)=>{var i;!function(t){!function(e){var i="object"==typeof r.g?r.g:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),n=s(t);function s(t,e){return function(r,i){"function"!=typeof t[r]&&Object.defineProperty(t,r,{configurable:!0,writable:!0,value:i}),e&&e(r,i)}}void 0===i.Reflect?i.Reflect=t:n=s(i.Reflect,n),function(t){var e=Object.prototype.hasOwnProperty,r="function"==typeof Symbol,i=r&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",n=r&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",s="function"==typeof Object.create,o={__proto__:[]}instanceof Array,a=!s&&!o,c={create:s?function(){return it(Object.create(null))}:o?function(){return it({__proto__:null})}:function(){return it({})},has:a?function(t,r){return e.call(t,r)}:function(t,e){return e in t},get:a?function(t,r){return e.call(t,r)?t[r]:void 0}:function(t,e){return t[e]}},h=Object.getPrototypeOf(Function),u="object"==typeof process&&process.env&&"true"===process.env.REFLECT_METADATA_USE_MAP_POLYFILL,l=u||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?tt():Map,p=u||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?et():Set,d=new(u||"function"!=typeof WeakMap?rt():WeakMap);function y(t,e,r,i){if(j(r)){if(!H(t))throw new TypeError;if(!q(e))throw new TypeError;return M(t,e)}if(!H(t))throw new TypeError;if(!I(e))throw new TypeError;if(!I(i)&&!j(i)&&!U(i))throw new TypeError;return U(i)&&(i=void 0),S(t,e,r=$(r),i)}function f(t,e){function r(r,i){if(!I(r))throw new TypeError;if(!j(i)&&!W(i))throw new TypeError;P(t,e,r,i)}return r}function m(t,e,r,i){if(!I(r))throw new TypeError;return j(i)||(i=$(i)),P(t,e,r,i)}function g(t,e,r){if(!I(e))throw new TypeError;return j(r)||(r=$(r)),z(t,e,r)}function _(t,e,r){if(!I(e))throw new TypeError;return j(r)||(r=$(r)),N(t,e,r)}function v(t,e,r){if(!I(e))throw new TypeError;return j(r)||(r=$(r)),T(t,e,r)}function w(t,e,r){if(!I(e))throw new TypeError;return j(r)||(r=$(r)),D(t,e,r)}function b(t,e){if(!I(t))throw new TypeError;return j(e)||(e=$(e)),O(t,e)}function x(t,e){if(!I(t))throw new TypeError;return j(e)||(e=$(e)),R(t,e)}function E(t,e,r){if(!I(e))throw new TypeError;j(r)||(r=$(r));var i=A(e,r,!1);if(j(i))return!1;if(!i.delete(t))return!1;if(i.size>0)return!0;var n=d.get(e);return n.delete(r),n.size>0||d.delete(e),!0}function M(t,e){for(var r=t.length-1;r>=0;--r){var i=(0,t[r])(e);if(!j(i)&&!U(i)){if(!q(i))throw new TypeError;e=i}}return e}function S(t,e,r,i){for(var n=t.length-1;n>=0;--n){var s=(0,t[n])(e,r,i);if(!j(s)&&!U(s)){if(!I(s))throw new TypeError;i=s}}return i}function A(t,e,r){var i=d.get(t);if(j(i)){if(!r)return;i=new l,d.set(t,i)}var n=i.get(e);if(j(n)){if(!r)return;n=new l,i.set(e,n)}return n}function z(t,e,r){if(N(t,e,r))return!0;var i=X(e);return!U(i)&&z(t,i,r)}function N(t,e,r){var i=A(e,r,!1);return!j(i)&&F(i.has(t))}function T(t,e,r){if(N(t,e,r))return D(t,e,r);var i=X(e);return U(i)?void 0:T(t,i,r)}function D(t,e,r){var i=A(e,r,!1);if(!j(i))return i.get(t)}function P(t,e,r,i){A(r,i,!0).set(t,e)}function O(t,e){var r=R(t,e),i=X(t);if(null===i)return r;var n=O(i,e);if(n.length<=0)return r;if(r.length<=0)return n;for(var s=new p,o=[],a=0,c=r;a<c.length;a++){var h=c[a];s.has(h)||(s.add(h),o.push(h))}for(var u=0,l=n;u<l.length;u++){h=l[u];s.has(h)||(s.add(h),o.push(h))}return o}function R(t,e){var r=[],i=A(t,e,!1);if(j(i))return r;for(var n=J(i.keys()),s=0;;){var o=Z(n);if(!o)return r.length=s,r;var a=Q(o);try{r[s]=a}catch(t){try{Y(n)}finally{throw t}}s++}}function C(t){if(null===t)return 1;switch(typeof t){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===t?1:6;default:return 6}}function j(t){return void 0===t}function U(t){return null===t}function k(t){return"symbol"==typeof t}function I(t){return"object"==typeof t?null!==t:"function"==typeof t}function L(t,e){switch(C(t)){case 0:case 1:case 2:case 3:case 4:case 5:return t}var r=3===e?"string":5===e?"number":"default",n=K(t,i);if(void 0!==n){var s=n.call(t,r);if(I(s))throw new TypeError;return s}return V(t,"default"===r?"number":r)}function V(t,e){if("string"===e){var r=t.toString;if(G(r))if(!I(n=r.call(t)))return n;if(G(i=t.valueOf))if(!I(n=i.call(t)))return n}else{var i;if(G(i=t.valueOf))if(!I(n=i.call(t)))return n;var n,s=t.toString;if(G(s))if(!I(n=s.call(t)))return n}throw new TypeError}function F(t){return!!t}function B(t){return""+t}function $(t){var e=L(t,3);return k(e)?e:B(e)}function H(t){return Array.isArray?Array.isArray(t):t instanceof Object?t instanceof Array:"[object Array]"===Object.prototype.toString.call(t)}function G(t){return"function"==typeof t}function q(t){return"function"==typeof t}function W(t){switch(C(t)){case 3:case 4:return!0;default:return!1}}function K(t,e){var r=t[e];if(null!=r){if(!G(r))throw new TypeError;return r}}function J(t){var e=K(t,n);if(!G(e))throw new TypeError;var r=e.call(t);if(!I(r))throw new TypeError;return r}function Q(t){return t.value}function Z(t){var e=t.next();return!e.done&&e}function Y(t){var e=t.return;e&&e.call(t)}function X(t){var e=Object.getPrototypeOf(t);if("function"!=typeof t||t===h)return e;if(e!==h)return e;var r=t.prototype,i=r&&Object.getPrototypeOf(r);if(null==i||i===Object.prototype)return e;var n=i.constructor;return"function"!=typeof n||n===t?e:n}function tt(){var t={},e=[],r=function(){function t(t,e,r){this._index=0,this._keys=t,this._values=e,this._selector=r}return t.prototype["@@iterator"]=function(){return this},t.prototype[n]=function(){return this},t.prototype.next=function(){var t=this._index;if(t>=0&&t<this._keys.length){var r=this._selector(this._keys[t],this._values[t]);return t+1>=this._keys.length?(this._index=-1,this._keys=e,this._values=e):this._index++,{value:r,done:!1}}return{value:void 0,done:!0}},t.prototype.throw=function(t){throw this._index>=0&&(this._index=-1,this._keys=e,this._values=e),t},t.prototype.return=function(t){return this._index>=0&&(this._index=-1,this._keys=e,this._values=e),{value:t,done:!0}},t}();return function(){function e(){this._keys=[],this._values=[],this._cacheKey=t,this._cacheIndex=-2}return Object.defineProperty(e.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),e.prototype.has=function(t){return this._find(t,!1)>=0},e.prototype.get=function(t){var e=this._find(t,!1);return e>=0?this._values[e]:void 0},e.prototype.set=function(t,e){var r=this._find(t,!0);return this._values[r]=e,this},e.prototype.delete=function(e){var r=this._find(e,!1);if(r>=0){for(var i=this._keys.length,n=r+1;n<i;n++)this._keys[n-1]=this._keys[n],this._values[n-1]=this._values[n];return this._keys.length--,this._values.length--,e===this._cacheKey&&(this._cacheKey=t,this._cacheIndex=-2),!0}return!1},e.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=t,this._cacheIndex=-2},e.prototype.keys=function(){return new r(this._keys,this._values,i)},e.prototype.values=function(){return new r(this._keys,this._values,s)},e.prototype.entries=function(){return new r(this._keys,this._values,o)},e.prototype["@@iterator"]=function(){return this.entries()},e.prototype[n]=function(){return this.entries()},e.prototype._find=function(t,e){return this._cacheKey!==t&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=t)),this._cacheIndex<0&&e&&(this._cacheIndex=this._keys.length,this._keys.push(t),this._values.push(void 0)),this._cacheIndex},e}();function i(t,e){return t}function s(t,e){return e}function o(t,e){return[t,e]}}function et(){return function(){function t(){this._map=new l}return Object.defineProperty(t.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),t.prototype.has=function(t){return this._map.has(t)},t.prototype.add=function(t){return this._map.set(t,t),this},t.prototype.delete=function(t){return this._map.delete(t)},t.prototype.clear=function(){this._map.clear()},t.prototype.keys=function(){return this._map.keys()},t.prototype.values=function(){return this._map.values()},t.prototype.entries=function(){return this._map.entries()},t.prototype["@@iterator"]=function(){return this.keys()},t.prototype[n]=function(){return this.keys()},t}()}function rt(){var t=16,r=c.create(),i=n();return function(){function t(){this._key=n()}return t.prototype.has=function(t){var e=s(t,!1);return void 0!==e&&c.has(e,this._key)},t.prototype.get=function(t){var e=s(t,!1);return void 0!==e?c.get(e,this._key):void 0},t.prototype.set=function(t,e){return s(t,!0)[this._key]=e,this},t.prototype.delete=function(t){var e=s(t,!1);return void 0!==e&&delete e[this._key]},t.prototype.clear=function(){this._key=n()},t}();function n(){var t;do{t="@@WeakMap@@"+h()}while(c.has(r,t));return r[t]=!0,t}function s(t,r){if(!e.call(t,i)){if(!r)return;Object.defineProperty(t,i,{value:c.create()})}return t[i]}function o(t,e){for(var r=0;r<e;++r)t[r]=255*Math.random()|0;return t}function a(t){return"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(t)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(t)):o(new Uint8Array(t),t):o(new Array(t),t)}function h(){var e=a(t);e[6]=79&e[6]|64,e[8]=191&e[8]|128;for(var r="",i=0;i<t;++i){var n=e[i];4!==i&&6!==i&&8!==i||(r+="-"),n<16&&(r+="0"),r+=n.toString(16).toLowerCase()}return r}}function it(t){return t.__=void 0,delete t.__,t}t("decorate",y),t("metadata",f),t("defineMetadata",m),t("hasMetadata",g),t("hasOwnMetadata",_),t("getMetadata",v),t("getOwnMetadata",w),t("getMetadataKeys",b),t("getOwnMetadataKeys",x),t("deleteMetadata",E)}(n)}()}(i||(i={}))},188:(t,e,r)=>{"use strict";r.d(e,{Z:()=>c,m:()=>a});var i=r(77),n=r(606),s=r(651),o=r(665);function a(t,e){if(null!=t.__type)return e.get(t.__type)}var c=function(){function t(){this.typeResolver=a,this.errorHandler=i.H,this.deserializationStrategy=new Map([[o.IK.ctor,i.yR],[Number,p],[String,p],[Boolean,p],[Date,m],[ArrayBuffer,g],[DataView,_],[Array,d],[Set,y],[Map,f],[Float32Array,w],[Float64Array,w],[Uint8Array,b],[Uint8ClampedArray,b],[Uint16Array,b],[Uint32Array,b]])}return t.prototype.setDeserializationStrategy=function(t,e){this.deserializationStrategy.set(t,e)},t.prototype.setNameResolver=function(t){this.nameResolver=t},t.prototype.setTypeResolver=function(t){if("function"!=typeof t)throw new TypeError("'typeResolverCallback' is not a function.");this.typeResolver=t},t.prototype.getTypeResolver=function(){return this.typeResolver},t.prototype.setErrorHandler=function(t){if("function"!=typeof t)throw new TypeError("'errorHandlerCallback' is not a function.");this.errorHandler=t},t.prototype.getErrorHandler=function(){return this.errorHandler},t.prototype.convertSingleValue=function(t,e,r,a,c){if(void 0===a&&(a="object"),this.retrievePreserveNull(c)&&null===t)return null;if((0,i.Jf)(t)){var h=this.deserializationStrategy.get(e.ctor);if(void 0!==h)return h(t,e,r,a,this,c);if("object"==typeof t)return function(t,e,r,a,c){if("object"!=typeof t||null===t)return void c.getErrorHandler()(new TypeError("Cannot deserialize "+a+": 'sourceObject' must be a defined object."));var h=e.ctor,u=n.WR.getFromConstructor(h),l=r,p=c.getTypeResolver();void 0!==u&&(u.processDeferredKnownTypes(),l=c.mergeKnownTypes(l,c.createKnownTypesMap(u.knownTypes)),null!=u.typeResolver&&(p=u.typeResolver));var d=p(t,l);null!=d&&(0,i.me)(d,h)&&(h=d,void 0!==(u=n.WR.getFromConstructor(d))&&(l=c.mergeKnownTypes(l,c.createKnownTypesMap(u.knownTypes))));if(!0===(null==u?void 0:u.isExplicitlyMarked)){var y=u,f={},m=(0,s.JH)(c.options,y.options);y.dataMembers.forEach((function(e,n){var a,h=t[n],u=(0,i.$0)(y.classType)+"."+n,p=(0,s.JH)(m,e.options);if(null!=e.deserializer)a=e.deserializer(h,{fallback:function(t,e){return c.convertSingleValue(t,(0,o._k)(e),r)}});else{if(null==e.type)throw new TypeError("Cannot deserialize "+u+" there is no constructor nor deserialization function to use.");a=c.convertSingleValue(h,e.type(),l,u,p)}(0,i.Jf)(a)||c.retrievePreserveNull(p)&&null===a?f[e.key]=a:!0===e.isRequired&&c.getErrorHandler()(new TypeError("Missing required member '"+u+"'."))}));var g=void 0;if("function"==typeof u.initializerCallback)try{if(null==(g=u.initializerCallback(f,t)))throw new TypeError("Cannot deserialize "+a+": 'initializer' function returned undefined/null, but '"+(0,i.$0)(u.classType)+"' was expected.");if(!(g instanceof u.classType))throw new TypeError("Cannot deserialize "+a+":'initializer' returned '"+(0,i.$0)(g.constructor)+"', but '"+(0,i.$0)(u.classType)+"' was expected, and '"+(0,i.$0)(g.constructor)+"' is not a subtype of '"+(0,i.$0)(u.classType)+"'")}catch(t){return void c.getErrorHandler()(t)}else g=c.instantiateType(h);Object.assign(g,f);var _=u.onDeserializedMethodName;return null!=_&&("function"==typeof g[_]?g[_]():"function"==typeof g.constructor[_]?g.constructor[_]():c.getErrorHandler()(new TypeError("onDeserialized callback'"+(0,i.$0)(u.classType)+"."+_+"' is not a method."))),g}var v={};return Object.keys(t).forEach((function(e){v[e]=c.convertSingleValue(t[e],new o.h2(t[e].constructor),r,e)})),v}(t,e,r,a,this);var u="Could not deserialize '"+a+"'; don't know how to deserialize type";e.hasFriendlyName()&&(u+=" '"+e.ctor.name+"'"),this.errorHandler(new TypeError(u+"."))}},t.prototype.instantiateType=function(t){return new t},t.prototype.mergeKnownTypes=function(){for(var t=this,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var i=new Map;return e.forEach((function(e){e.forEach((function(e,r){void 0===t.nameResolver?i.set(r,e):i.set(t.nameResolver(e),e)}))})),i},t.prototype.createKnownTypesMap=function(t){var e=this,r=new Map;return t.forEach((function(t){if(void 0===e.nameResolver){var i=n.WR.getFromConstructor(t),s=!0===(null==i?void 0:i.isExplicitlyMarked)?i.name:null;r.set(null!=s?s:t.name,t)}else r.set(e.nameResolver(t),t)})),r},t.prototype.retrievePreserveNull=function(t){return(0,s.l_)("preserveNull",(0,s.JH)(this.options,t))},t}();function h(t,e,r,i){throw new TypeError("Could not deserialize "+i+" as "+t+": expected "+e+", got "+r+".")}function u(t,e,r){return"Could not deserialize "+r+": expected '"+("function"==typeof t?(0,i.$0)(t):t)+"', got '"+("function"==typeof e?(0,i.$0)(e):e)+"'."}function l(t){return null==t?"undefined":(0,i.$0)(t.constructor)}function p(t,e,r,n){if(t.constructor!==e.ctor)throw new TypeError(u((0,i.$0)(e.ctor),t.constructor,n));return t}function d(t,e,r,i,n,s){if(!(e instanceof o.GJ))throw new TypeError("Could not deserialize "+i+" as Array: incorrect TypeDescriptor detected, please use proper annotation or function for this type");return Array.isArray(t)?null==e.elementType?(n.getErrorHandler()(new TypeError("Could not deserialize "+i+" as Array: missing constructor reference of Array elements.")),[]):t.map((function(t,o){try{return n.convertSingleValue(t,e.elementType,r,i+"["+o+"]",s)}catch(t){return void n.getErrorHandler()(t)}})):(n.getErrorHandler()(new TypeError(u(Array,t.constructor,i))),[])}function y(t,e,r,i,n,s){if(!(e instanceof o.do))throw new TypeError("Could not deserialize "+i+" as Set: incorrect TypeDescriptor detected, please use proper annotation or function for this type");if(!Array.isArray(t))return n.getErrorHandler()(new TypeError(u(Array,t.constructor,i))),new Set;if(null==e.elementType)return n.getErrorHandler()(new TypeError("Could not deserialize "+i+" as Set: missing constructor reference of Set elements.")),new Set;var a=new Set;return t.forEach((function(t,o){try{a.add(n.convertSingleValue(t,e.elementType,r,i+"["+o+"]",s))}catch(t){n.getErrorHandler()(t)}})),a}function f(t,e,r,n,s,a){if(!(e instanceof o.br))throw new TypeError("Could not deserialize "+n+" as Map: incorrect TypeDescriptor detected,please use proper annotation or function for this type");var c=e.getCompleteOptions().shape;if(!function(t,e){return 0===e&&Array.isArray(t)||1===e&&"object"==typeof t}(t,c)){var h=0===c?Array:Object;return s.getErrorHandler()(new TypeError(u(h,t.constructor,n))),new Map}if(null==e.keyType)return s.getErrorHandler()(new TypeError("Could not deserialize "+n+" as Map: missing key constructor.")),new Map;if(null==e.valueType)return s.getErrorHandler()(new TypeError("Could not deserialize "+n+" as Map: missing value constructor.")),new Map;var l=n+"[].key",p=n+"[].value",d=new Map;return 1===c?Object.keys(t).forEach((function(n){try{var o=s.convertSingleValue(n,e.keyType,r,l,a);(0,i.Jf)(o)&&d.set(o,s.convertSingleValue(t[n],e.valueType,r,p,a))}catch(t){s.getErrorHandler()(t)}})):t.forEach((function(t){try{var n=s.convertSingleValue(t.key,e.keyType,r,l,a);(0,i.Jf)(n)&&d.set(n,s.convertSingleValue(t.value,e.valueType,r,p,a))}catch(t){s.getErrorHandler()(t)}})),d}function m(t,e,r,i){if("number"==typeof t){if(!(t%1==0))throw new TypeError("Could not deserialize "+i+" as Date: expected an integer, got a number with decimal places.");return new Date(t)}return"string"==typeof t?new Date(t):t instanceof Date?t:void h("Date","an ISO-8601 string",l(t),i)}function g(t,e,r,i){return"string"!=typeof t&&h("ArrayBuffer","a string source",l(t),i),v(t)}function _(t,e,r,i){return"string"!=typeof t&&h("DataView","a string source",l(t),i),new DataView(v(t))}function v(t){for(var e=new ArrayBuffer(2*t.length),r=new Uint16Array(e),i=0,n=t.length;i<n;i++)r[i]=t.charCodeAt(i);return e}function w(t,e,r,i){var n=e.ctor;return Array.isArray(t)&&t.every((function(t){return!isNaN(t)}))?new n(t):h(n.name,"a numeric source array",l(t),i)}function b(t,e,r,i){var n=e.ctor;return Array.isArray(t)&&t.every((function(t){return!isNaN(t)}))?new n(t.map((function(t){return~~t}))):h(e.ctor.name,"a numeric source array",l(t),i)}},77:(t,e,r)=>{"use strict";r.d(e,{$0:()=>m,AZ:()=>o,H:()=>l,Jf:()=>d,KE:()=>p,V9:()=>y,Vf:()=>s,W0:()=>h,by:()=>c,df:()=>f,lW:()=>a,me:()=>u,yR:()=>g});var i=r(582),n=r(665),s="If the type is not yet defined, for example due to circular references, add '() => ' before it. E.g. @jsonMember(() => Foo)",o='Make sure that you have both "experimentalDecorators" and "emitDecoratorMetadata" enabled in your tsconfig.json';function a(t){return-1!==[Date,Number,String,Boolean].indexOf(t)}function c(t){return-1!==[Float32Array,Float64Array,Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array].indexOf(t)}function h(t,e){return"string"!=typeof t||function(t,e){var r=e===String||e===ArrayBuffer||e===DataView,i=t.length>=2&&'"'===t[0]&&'"'===t[t.length-1];if(e===Date){var n=!isNaN(Number(t.trim()));return!i&&!n}return r&&!i}(t,e)?t:JSON.parse(t)}function u(t,e){return t===e||t.prototype instanceof e}function l(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];"object"==typeof console&&"function"==typeof console.error?console.error.apply(console,(0,i.pr)([t],e)):"object"==typeof console&&"function"==typeof console.log&&console.log.apply(console,(0,i.pr)(["ERROR: "+t],e))}function p(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];"object"==typeof console&&"function"==typeof console.warn?console.warn.apply(console,(0,i.pr)([t],e)):"object"==typeof console&&"function"==typeof console.log&&console.log.apply(console,(0,i.pr)(["WARNING: "+t],e))}function d(t){return!(null==t)}function y(t,e){return e===n.IK.ctor||("number"==typeof t?e===Number:"string"==typeof t?e===String:"boolean"==typeof t?e===Boolean:!!function(t){return"object"==typeof t}(t)&&t instanceof e)}var f="object"==typeof Reflect&&"function"==typeof Reflect.getMetadata;function m(t){return"string"==typeof t.name?t.name:"undefined"}function g(t){return t}},255:(t,e,r)=>{"use strict";r.d(e,{R:()=>a});var i=r(77),n=r(606),s=r(651),o=r(665);function a(t,e){var r,a;if("string"!=typeof e&&"symbol"!=typeof e)return r=t,a=e,function(t,e){var c,u,l="@jsonMember on "+(0,i.$0)(t.constructor)+"."+String(e);if((0,o.nW)(r)||(0,o.p3)(r)?u=(0,o.JD)(r,l):a=r,a=null!=a?a:{},Object.prototype.hasOwnProperty.call(a,"constructor")){if(void 0!==u)throw new Error("Cannot both define constructor option and type. Only one allowed.");if(!(0,i.Jf)(a.constructor))return void(0,i.H)(l+": cannot resolve specified property constructor at runtime. "+i.Vf);var p=(0,o._k)(a.constructor);u=function(){return p},i.df&&!(0,i.me)(p.ctor,Reflect.getMetadata("design:type",t,e))&&(0,i.KE)(l+": detected property type does not match 'constructor' option.")}else if(void 0!==u);else if(i.df){var d=Reflect.getMetadata("design:type",t,e);if(null==d)return void(0,i.H)(l+": cannot resolve detected property constructor at runtime. "+i.Vf);u=function(){return(0,o._k)(d)}}else if(void 0===a.deserializer)return void(0,i.H)(l+": Cannot determine type");var y=null==u?void 0:u();void 0!==y&&h(l,y)||(0,n.d3)(t,e,{type:void 0===u?void 0:function(){return(0,o._k)(u())},emitDefaultValue:a.emitDefaultValue,isRequired:a.isRequired,options:(0,s.M3)(a),key:e.toString(),name:null!==(c=a.name)&&void 0!==c?c:e.toString(),deserializer:a.deserializer,serializer:a.serializer})};var c=e,u=t,l="@jsonMember on "+(0,i.$0)(u.constructor)+"."+String(c);if(i.df){var p=Reflect.getMetadata("design:type",u,c);if(null!=p){var d=(0,o._k)(p);h(l,d)||(0,n.d3)(u,c,{type:function(){return d},key:e.toString(),name:e.toString()})}else(0,i.H)(l+": could not resolve detected property constructor at runtime. Potential solutions:\n - "+i.Vf+"\n - "+i.AZ)}else(0,i.H)(l+": ReflectDecorators is required if the type is not explicitly provided with e.g. @jsonMember(Number)")}function c(t,e){return t instanceof o.eh?t.ctor===e:t===e}function h(t,e){return e instanceof o.GJ||!c(e,Array)?e instanceof o.do||!c(e,Set)?!(e instanceof o.br||!c(e,Map))&&((0,i.H)(t+": property is a Map. Use the jsonMapMember decorator to serialize this property."),!0):((0,i.H)(t+": property is a Set. Use the jsonSetMember decorator to serialize this property."),!0):((0,i.H)(t+": property is an Array. Use the jsonArrayMember decorator to serialize this property."),!0)}},606:(t,e,r)=>{"use strict";r.d(e,{WR:()=>s,d3:()=>o});var i=r(77),n="__typedJsonJsonObjectMetadataInformation__",s=function(){function t(t){this.dataMembers=new Map,this.knownTypes=new Set,this.knownTypesDeferred=[],this.isExplicitlyMarked=!1,this.isHandledWithoutAnnotation=!1,this.classType=t}return t.getJsonObjectName=function(e){var r=t.getFromConstructor(e);return void 0===r?(0,i.$0)(e):(0,i.$0)(r.classType)},t.getFromConstructor=function(e){var r=e.prototype;if(null!=r){var i;if(Object.prototype.hasOwnProperty.call(r,n)&&(i=r[n]),!0===(null==i?void 0:i.isExplicitlyMarked))return i;if(t.doesHandleWithoutAnnotation(e)){var s=new t(e);return s.isExplicitlyMarked=!0,s}}},t.ensurePresentInPrototype=function(e){if(Object.prototype.hasOwnProperty.call(e,n))return e[n];var r=new t(e.constructor),i=e[n];return void 0!==i&&(i.dataMembers.forEach((function(t,e){r.dataMembers.set(e,t)})),i.knownTypes.forEach((function(t){r.knownTypes.add(t)})),r.typeResolver=i.typeResolver,r.typeHintEmitter=i.typeHintEmitter),Object.defineProperty(e,n,{enumerable:!1,configurable:!1,writable:!1,value:r}),r},t.getKnownTypeNameFromType=function(e){var r=t.getFromConstructor(e);return void 0===r?(0,i.$0)(e):(0,i.$0)(r.classType)},t.doesHandleWithoutAnnotation=function(t){return(0,i.lW)(t)||(0,i.by)(t)||t===DataView||t===ArrayBuffer},t.prototype.processDeferredKnownTypes=function(){var t=this;this.knownTypesDeferred.forEach((function(e){e().getTypes().forEach((function(e){return t.knownTypes.add(e)}))})),this.knownTypesDeferred=[]},t}();function o(t,e,r){var n="@jsonMember on "+(0,i.$0)(t.constructor)+"."+String(e);if("function"!=typeof t)if("function"!=typeof t[e])if(null==r||void 0===r.type&&void 0===r.deserializer)(0,i.H)(n+": JsonMemberMetadata has unknown type.");else{var o=s.ensurePresentInPrototype(t);void 0===r.deserializer&&o.knownTypesDeferred.push(r.type),Object.keys(r).forEach((function(t){return void 0===r[t]&&delete r[t]})),o.dataMembers.set(r.name,r)}else(0,i.H)(n+": cannot use a method property.");else(0,i.H)(n+": cannot use a static property.")}},651:(t,e,r)=>{"use strict";r.d(e,{JH:()=>a,M3:()=>s,l_:()=>o});var i=r(582),n=["preserveNull"];function s(t){var e=Object.keys(t).filter((function(t){return n.indexOf(t)>-1})).reduce((function(e,r){return e[r]=t[r],e}),{});return Object.keys(e).length>0?e:void 0}function o(t,e){return null!=e&&null!=e[t]?e[t]:function(t){return"preserveNull"!==t&&null}(t)}function a(t,e){return null==e?t:(0,i.pi)((0,i.pi)({},t),e)}},844:(t,e,r)=>{"use strict";r.d(e,{C:()=>c,e:()=>h});var i=r(582),n=r(77),s=r(606),o=r(651),a=r(665);function c(t,e,r,i){var s;e.constructor!==r&&(t.__type=null!==(s=null==i?void 0:i.name)&&void 0!==s?s:(0,n.$0)(e.constructor))}var h=function(){function t(){this.typeHintEmitter=c,this.errorHandler=n.H,this.serializationStrategy=new Map([[a.IK.ctor,n.yR],[Date,n.yR],[Number,n.yR],[String,n.yR],[Boolean,n.yR],[ArrayBuffer,y],[DataView,f],[Array,u],[Set,l],[Map,p],[Float32Array,d],[Float64Array,d],[Int8Array,d],[Uint8Array,d],[Uint8ClampedArray,d],[Int16Array,d],[Uint16Array,d],[Int32Array,d],[Uint32Array,d]])}return t.prototype.setSerializationStrategy=function(t,e){this.serializationStrategy.set(t,e)},t.prototype.setTypeHintEmitter=function(t){if("function"!=typeof t)throw new TypeError("'typeEmitterCallback' is not a function.");this.typeHintEmitter=t},t.prototype.getTypeHintEmitter=function(){return this.typeHintEmitter},t.prototype.setErrorHandler=function(t){if("function"!=typeof t)throw new TypeError("'errorHandlerCallback' is not a function.");this.errorHandler=t},t.prototype.getErrorHandler=function(){return this.errorHandler},t.prototype.retrievePreserveNull=function(t){return(0,o.l_)("preserveNull",(0,o.JH)(this.options,t))},t.prototype.convertSingleValue=function(t,e,r,c){if(void 0===r&&(r="object"),this.retrievePreserveNull(c)&&null===t)return null;if((0,n.Jf)(t))if((0,n.V9)(t,e.ctor)){var h=this.serializationStrategy.get(e.ctor);if(void 0!==h)return h(t,e,r,this,c);if("object"==typeof t)return function(t,e,r,c,h){var u,l,p=c.getTypeHintEmitter();u=t.constructor!==e.ctor&&t instanceof e.ctor?s.WR.getFromConstructor(t.constructor):s.WR.getFromConstructor(e.ctor);if(void 0===u)l=(0,i.pi)({},t);else{var d=u.beforeSerializationMethodName;null!=d&&("function"==typeof t[d]?t[d]():"function"==typeof t.constructor[d]?t.constructor[d]():c.getErrorHandler()(new TypeError("beforeSerialization callback '"+(0,n.$0)(u.classType)+"."+d+"' is not a method.")));var y=u;l={};var f=(0,o.JH)(c.options,y.options);null!=y.typeHintEmitter&&(p=y.typeHintEmitter),y.dataMembers.forEach((function(e){var r,i=(0,o.JH)(f,e.options);if(null!=e.serializer)r=e.serializer(t[e.key],{fallback:function(t,e){return c.convertSingleValue(t,(0,a._k)(e))}});else{if(null==e.type)throw new TypeError("Could not serialize "+e.name+", there is no constructor nor serialization function to use.");r=c.convertSingleValue(t[e.key],e.type(),(0,n.$0)(y.classType)+"."+e.key,i)}(c.retrievePreserveNull(i)&&null===r||(0,n.Jf)(r))&&(l[e.name]=r)}))}return p(l,t,e.ctor,u),l}(t,e,0,this);var u="Could not serialize '"+r+"'; don't know how to serialize type";e.hasFriendlyName()&&(u+=" '"+e.ctor.name+"'"),this.errorHandler(new TypeError(u+"."))}else{var l=(0,n.$0)(e.ctor),p=(0,n.$0)(t.constructor);this.errorHandler(new TypeError("Could not serialize '"+r+"': expected '"+l+"', got '"+p+"'."))}},t}();function u(t,e,r,i,s){if(!(e instanceof a.GJ))throw new TypeError("Could not serialize "+r+" as Array: incorrect TypeDescriptor detected, please use proper annotation or function for this type");if(null==e.elementType)throw new TypeError("Could not serialize "+r+" as Array: missing element type definition.");return t.forEach((function(t,o){if(!(i.retrievePreserveNull(s)&&null===t||(0,n.V9)(t,e.elementType.ctor))){var a=(0,n.$0)(e.elementType.ctor),c=t&&(0,n.$0)(t.constructor);throw new TypeError("Could not serialize "+r+"["+o+"]: expected '"+a+"', got '"+c+"'.")}})),t.map((function(t,n){return i.convertSingleValue(t,e.elementType,r+"["+n+"]",s)}))}function l(t,e,r,i,s){if(!(e instanceof a.do))throw new TypeError("Could not serialize "+r+" as Set: incorrect TypeDescriptor detected, please use proper annotation or function for this type");if(null==e.elementType)throw new TypeError("Could not serialize "+r+" as Set: missing element type definition.");r+="[]";var o=[];return t.forEach((function(t){var a=i.convertSingleValue(t,e.elementType,r,s);(0,n.Jf)(t)&&!(0,n.Jf)(a)||o.push(a)})),o}function p(t,e,r,i,s){if(!(e instanceof a.br))throw new TypeError("Could not serialize "+r+" as Map: incorrect TypeDescriptor detected, please use proper annotation or function for this type");if(null==e.valueType)throw new TypeError("Could not serialize "+r+" as Map: missing value type definition.");if(null==e.keyType)throw new TypeError("Could not serialize "+r+" as Map: missing key type definition.");var o=r+"[].key",c=r+"[].value",h=e.getCompleteOptions().shape,u=1===h?{}:[],l=i.retrievePreserveNull(s);return t.forEach((function(t,r){var a={key:i.convertSingleValue(r,e.keyType,o,s),value:i.convertSingleValue(t,e.valueType,c,s)},p=(0,n.Jf)(a.key),d=null===a.value&&l||(0,n.Jf)(a.value);p&&d&&(1===h?u[a.key]=a.value:u.push(a))})),u}function d(t){return Array.from(t)}function y(t){return Array.from(new Uint16Array(t)).map((function(t){return String.fromCharCode(t)})).join("")}function f(t){return y(t.buffer)}},665:(t,e,r)=>{"use strict";r.d(e,{AJ:()=>h,GJ:()=>c,IK:()=>y,JD:()=>_,_k:()=>g,br:()=>p,do:()=>u,eh:()=>s,h2:()=>o,mY:()=>d,nW:()=>f,p3:()=>m,zc:()=>l});var i=r(582),n=r(77),s=function(){function t(t){this.ctor=t}return t.prototype.getTypes=function(){return[this.ctor]},t.prototype.hasFriendlyName=function(){return"Object"!==this.ctor.name},t}(),o=function(t){function e(e){return t.call(this,e)||this}return(0,i.ZT)(e,t),e}(s),a=function(t){function e(e){return t.call(this,e)||this}return(0,i.ZT)(e,t),e}(s),c=function(t){function e(e){var r=t.call(this,Array)||this;return r.elementType=e,r}return(0,i.ZT)(e,t),e.prototype.getTypes=function(){return t.prototype.getTypes.call(this).concat(this.elementType.getTypes())},e}(a);function h(t){return new c(g(t))}var u=function(t){function e(e){var r=t.call(this,Set)||this;return r.elementType=e,r}return(0,i.ZT)(e,t),e.prototype.getTypes=function(){return t.prototype.getTypes.call(this).concat(this.elementType.getTypes())},e}(a);function l(t){return new u(g(t))}var p=function(t){function e(e,r,i){var n=t.call(this,Map)||this;return n.keyType=e,n.valueType=r,n.options=i,n}return(0,i.ZT)(e,t),e.prototype.getTypes=function(){return t.prototype.getTypes.call(this).concat(this.keyType.getTypes(),this.valueType.getTypes())},e.prototype.getCompleteOptions=function(){var t,e;return{shape:null!==(e=null===(t=this.options)||void 0===t?void 0:t.shape)&&void 0!==e?e:0}},e}(a);function d(t,e,r){return new p(g(t),g(e),r)}var y=new o((function(){}));function f(t){return null!=t&&("function"==typeof t||t instanceof s)}function m(t){return"function"==typeof t&&""===t.name}function g(t){return t instanceof s?t:new o(t)}function _(t,e){if(null==t)throw new Error("No type given on "+e+". "+n.Vf);return m(t)?t:function(){return t}}},759:()=>{},801:()=>{},582:(t,e,r)=>{"use strict";r.d(e,{ZT:()=>n,gn:()=>o,mG:()=>c,pi:()=>s,pr:()=>h,w6:()=>a});var i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},i(t,e)};function n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var s=function(){return s=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},s.apply(this,arguments)};function o(t,e,r,i){var n,s=arguments.length,o=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,r,i);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(o=(s<3?n(o):s>3?n(e,r,o):n(e,r))||o);return s>3&&o&&Object.defineProperty(e,r,o),o}function a(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function c(t,e,r,i){return new(r||(r=Promise))((function(n,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))}Object.create;function h(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var i=Array(t),n=0;for(e=0;e<r;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,n++)i[n]=s[o];return i}Object.create;"function"==typeof SuppressedError&&SuppressedError}},__webpack_module_cache__={};function __webpack_require__(t){var e=__webpack_module_cache__[t];if(void 0!==e)return e.exports;var r=__webpack_module_cache__[t]={id:t,loaded:!1,exports:{}};return __webpack_modules__[t](r,r.exports,__webpack_require__),r.loaded=!0,r.exports}__webpack_require__.c=__webpack_module_cache__,__webpack_require__.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return __webpack_require__.d(e,{a:e}),e},__webpack_require__.d=(t,e)=>{for(var r in e)__webpack_require__.o(e,r)&&!__webpack_require__.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),__webpack_require__.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),__webpack_require__.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},__webpack_require__.nmd=t=>(t.paths=[],t.children||(t.children=[]),t);var __webpack_exports__=__webpack_require__(__webpack_require__.s=496);return __webpack_exports__})()));
//# sourceMappingURL=openhps-core-lite.min.js.map