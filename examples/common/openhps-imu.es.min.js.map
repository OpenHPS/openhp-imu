{"version":3,"file":"web/openhps-imu.es.min.js","mappings":"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","sources":["webpack://@openhps/imu/webpack/bootstrap","webpack://@openhps/imu/webpack/runtime/define property getters","webpack://@openhps/imu/webpack/runtime/hasOwnProperty shorthand","webpack://@openhps/imu/external module \"./openhps-core.es.min.js\"","webpack://@openhps/imu/./dist/esm/nodes/processing/calibration/MagnetometerCalibrationNode.js","webpack://@openhps/imu/./dist/esm/nodes/processing/GravityProcessingNode.js","webpack://@openhps/imu/./dist/esm/nodes/processing/AccelerationProcessingNode.js","webpack://@openhps/imu/./dist/esm/nodes/processing/RelativeOrientationProcessingNode.js","webpack://@openhps/imu/./dist/esm/nodes/processing/AbsoluteOrientationProcessingNode.js","webpack://@openhps/imu/./dist/esm/nodes/processing/PedometerProcessingNode.js","webpack://@openhps/imu/./dist/esm/nodes/processing/VelocityCalculationNode.js","webpack://@openhps/imu/./dist/esm/nodes/processing/VelocityProcessingNode.js","webpack://@openhps/imu/./dist/esm/data/IMUDataFrame.js","webpack://@openhps/imu/./dist/esm/data/IMUSensorObject.js","webpack://@openhps/imu/./dist/esm/nodes/source/IMUBrowserSource.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","var x = y => { var x = {}; __webpack_require__.d(x, y); return x; }\nvar y = x => () => x\nconst __WEBPACK_NAMESPACE_OBJECT__ = x({ [\"Acceleration\"]: () => __WEBPACK_EXTERNAL_MODULE__openhps_core_es_min_js_27733f5f__.Acceleration, [\"AccelerationUnit\"]: () => __WEBPACK_EXTERNAL_MODULE__openhps_core_es_min_js_27733f5f__.AccelerationUnit, [\"AngularVelocity\"]: () => __WEBPACK_EXTERNAL_MODULE__openhps_core_es_min_js_27733f5f__.AngularVelocity, [\"AxisAngle\"]: () => __WEBPACK_EXTERNAL_MODULE__openhps_core_es_min_js_27733f5f__.AxisAngle, [\"DataFrame\"]: () => __WEBPACK_EXTERNAL_MODULE__openhps_core_es_min_js_27733f5f__.DataFrame, [\"DataObject\"]: () => __WEBPACK_EXTERNAL_MODULE__openhps_core_es_min_js_27733f5f__.DataObject, [\"FilterProcessingNode\"]: () => __WEBPACK_EXTERNAL_MODULE__openhps_core_es_min_js_27733f5f__.FilterProcessingNode, [\"LengthUnit\"]: () => __WEBPACK_EXTERNAL_MODULE__openhps_core_es_min_js_27733f5f__.LengthUnit, [\"LinearVelocity\"]: () => __WEBPACK_EXTERNAL_MODULE__openhps_core_es_min_js_27733f5f__.LinearVelocity, [\"LinearVelocityUnit\"]: () => __WEBPACK_EXTERNAL_MODULE__openhps_core_es_min_js_27733f5f__.LinearVelocityUnit, [\"Magnetism\"]: () => __WEBPACK_EXTERNAL_MODULE__openhps_core_es_min_js_27733f5f__.Magnetism, [\"Matrix4\"]: () => __WEBPACK_EXTERNAL_MODULE__openhps_core_es_min_js_27733f5f__.Matrix4, [\"ObjectProcessingNode\"]: () => __WEBPACK_EXTERNAL_MODULE__openhps_core_es_min_js_27733f5f__.ObjectProcessingNode, [\"Orientation\"]: () => __WEBPACK_EXTERNAL_MODULE__openhps_core_es_min_js_27733f5f__.Orientation, [\"ProcessingNode\"]: () => __WEBPACK_EXTERNAL_MODULE__openhps_core_es_min_js_27733f5f__.ProcessingNode, [\"SerializableArrayMember\"]: () => __WEBPACK_EXTERNAL_MODULE__openhps_core_es_min_js_27733f5f__.SerializableArrayMember, [\"SerializableMember\"]: () => __WEBPACK_EXTERNAL_MODULE__openhps_core_es_min_js_27733f5f__.SerializableMember, [\"SerializableObject\"]: () => __WEBPACK_EXTERNAL_MODULE__openhps_core_es_min_js_27733f5f__.SerializableObject, [\"SourceNode\"]: () => __WEBPACK_EXTERNAL_MODULE__openhps_core_es_min_js_27733f5f__.SourceNode, [\"TimeService\"]: () => __WEBPACK_EXTERNAL_MODULE__openhps_core_es_min_js_27733f5f__.TimeService, [\"TimeUnit\"]: () => __WEBPACK_EXTERNAL_MODULE__openhps_core_es_min_js_27733f5f__.TimeUnit, [\"Vector3\"]: () => __WEBPACK_EXTERNAL_MODULE__openhps_core_es_min_js_27733f5f__.Vector3 });","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nimport { ObjectProcessingNode } from '@openhps/core';\r\nexport class MagnetometerCalibrationNode extends ObjectProcessingNode {\r\n    constructor(options) {\r\n        super(options);\r\n    }\r\n    processObject(object, frame) {\r\n        return new Promise((resolve, reject) => {\r\n            this.getNodeData(object)\r\n                .then((calibrationData) => __awaiter(this, void 0, void 0, function* () {\r\n                if (calibrationData === undefined) {\r\n                    calibrationData = {\r\n                        xMax: 0,\r\n                        xMin: 0,\r\n                        yMax: 0,\r\n                        yMin: 0,\r\n                        zMax: 0,\r\n                        zMin: 0,\r\n                        count: 0,\r\n                        scaleX: NaN,\r\n                        scaleY: NaN,\r\n                        scaleZ: NaN,\r\n                    };\r\n                }\r\n                if (isNaN(calibrationData.scaleX) &&\r\n                    calibrationData.count < this.options.count &&\r\n                    this.options.count !== -1) {\r\n                    calibrationData.xMax = Math.max(frame.magnetism.x, calibrationData.xMax);\r\n                    calibrationData.xMin = Math.min(frame.magnetism.x, calibrationData.xMin);\r\n                    calibrationData.yMax = Math.max(frame.magnetism.y, calibrationData.yMax);\r\n                    calibrationData.yMin = Math.min(frame.magnetism.y, calibrationData.yMin);\r\n                    calibrationData.zMax = Math.max(frame.magnetism.z, calibrationData.zMax);\r\n                    calibrationData.zMin = Math.min(frame.magnetism.z, calibrationData.zMin);\r\n                    calibrationData.count += 1;\r\n                    yield this.setNodeData(object, calibrationData);\r\n                }\r\n                else if (isNaN(calibrationData.scaleX) && calibrationData.count >= this.options.count) {\r\n                    const avgDeltaX = (calibrationData.xMax + calibrationData.xMin) / 2;\r\n                    const avgDeltaY = (calibrationData.yMax + calibrationData.yMin) / 2;\r\n                    const avgDeltaZ = (calibrationData.zMax + calibrationData.zMin) / 2;\r\n                    const avgDelta = (avgDeltaX + avgDeltaY + avgDeltaZ) / 3;\r\n                    calibrationData.scaleX = avgDelta / avgDeltaX;\r\n                    calibrationData.scaleY = avgDelta / avgDeltaY;\r\n                    calibrationData.scaleZ = avgDelta / avgDeltaZ;\r\n                    yield this.setNodeData(object, calibrationData);\r\n                }\r\n                else {\r\n                    frame.magnetism.x = frame.magnetism.x * calibrationData.scaleX;\r\n                    frame.magnetism.y = frame.magnetism.y * calibrationData.scaleY;\r\n                    frame.magnetism.z = frame.magnetism.z * calibrationData.scaleZ;\r\n                }\r\n                resolve(object);\r\n            }))\r\n                .catch(reject);\r\n        });\r\n    }\r\n}\r\n//# sourceMappingURL=MagnetometerCalibrationNode.js.map","import { FilterProcessingNode, Acceleration, AccelerationUnit, } from '@openhps/core';\r\nexport class GravityProcessingNode extends FilterProcessingNode {\r\n    constructor(options) {\r\n        super(options);\r\n        this.options.method = this.options.method || GravityProcessingMethod.LOW_PASS;\r\n    }\r\n    initFilter(object, frame, options) {\r\n        return new Promise((resolve, reject) => {\r\n            if (!frame.acceleration) {\r\n                return reject(new Error(`Gravity processing requires accelerometer readings!`));\r\n            }\r\n            resolve(options);\r\n        });\r\n    }\r\n    filter(object, frame) {\r\n        return new Promise((resolve) => {\r\n            let method;\r\n            if (frame.linearAcceleration) {\r\n                method = GravityProcessingMethod.LINEAR_ACCELERATION;\r\n            }\r\n            else if (frame.relativeOrientation) {\r\n                method = GravityProcessingMethod.RELATIVE_ORIENTATION;\r\n            }\r\n            else if (frame.absoluteOrientation) {\r\n                method = GravityProcessingMethod.ABSOLUTE_ORIENTATION;\r\n            }\r\n            switch (method) {\r\n                case GravityProcessingMethod.LINEAR_ACCELERATION:\r\n                    this._fromLinearAcceleration(frame);\r\n                    break;\r\n                case GravityProcessingMethod.LOW_PASS:\r\n                    this._usingLPFilter(frame);\r\n                    break;\r\n                case GravityProcessingMethod.ABSOLUTE_ORIENTATION:\r\n                    this._fromAbsoluteOrientation(frame);\r\n                    break;\r\n                default:\r\n                case GravityProcessingMethod.RELATIVE_ORIENTATION:\r\n                    this._fromRelativeOrientation(frame);\r\n                    break;\r\n            }\r\n            resolve(object);\r\n        });\r\n    }\r\n    _fromLinearAcceleration(frame) {\r\n        frame.gravity = frame.acceleration.clone().sub(frame.linearAcceleration);\r\n    }\r\n    _usingLPFilter(frame) {\r\n        frame.gravity = new Acceleration();\r\n        frame.linearAcceleration = frame.acceleration.clone().sub(frame.gravity);\r\n    }\r\n    _fromRelativeOrientation(frame) {\r\n        frame.linearAcceleration = frame.acceleration.clone().multiply(frame.relativeOrientation.toEuler().toVector3());\r\n        frame.gravity = frame.acceleration.clone().sub(frame.linearAcceleration);\r\n    }\r\n    _fromAbsoluteOrientation(frame) {\r\n        frame.gravity = new Acceleration(0, 0, 1, AccelerationUnit.GRAVITATIONAL_FORCE).applyQuaternion(frame.absoluteOrientation);\r\n        frame.linearAcceleration = frame.acceleration.clone().sub(frame.gravity);\r\n    }\r\n}\r\nexport var GravityProcessingMethod;\r\n(function (GravityProcessingMethod) {\r\n    GravityProcessingMethod[GravityProcessingMethod[\"LOW_PASS\"] = 0] = \"LOW_PASS\";\r\n    GravityProcessingMethod[GravityProcessingMethod[\"ABSOLUTE_ORIENTATION\"] = 1] = \"ABSOLUTE_ORIENTATION\";\r\n    GravityProcessingMethod[GravityProcessingMethod[\"RELATIVE_ORIENTATION\"] = 2] = \"RELATIVE_ORIENTATION\";\r\n    GravityProcessingMethod[GravityProcessingMethod[\"LINEAR_ACCELERATION\"] = 3] = \"LINEAR_ACCELERATION\";\r\n})(GravityProcessingMethod || (GravityProcessingMethod = {}));\r\n//# sourceMappingURL=GravityProcessingNode.js.map","import { FilterProcessingNode, LinearVelocity } from '@openhps/core';\r\nexport class AccelerationProcessingNode extends FilterProcessingNode {\r\n    initFilter(object, frame) {\r\n        return new Promise((resolve, reject) => {\r\n            if (!frame.acceleration && !frame.linearAcceleration) {\r\n                return reject(new Error(`Acceleration processing requires accelerometer readings!`));\r\n            }\r\n            resolve({\r\n                alpha: 0,\r\n                beta: 0,\r\n                gamma: 0,\r\n            });\r\n        });\r\n    }\r\n    filter(object, frame) {\r\n        return new Promise((resolve) => {\r\n            const accl = frame.linearAcceleration || frame.acceleration;\r\n            const dt = 1000 / frame.frequency;\r\n            frame.linearVelocity = LinearVelocity.fromArray(accl.clone().multiplyScalar(dt).toArray());\r\n            const position = object.getPosition();\r\n            if (!position) {\r\n                return resolve(object);\r\n            }\r\n            if (!position.linearVelocity) {\r\n                position.linearVelocity = frame.linearVelocity.clone();\r\n            }\r\n            else {\r\n                position.linearVelocity.add(frame.linearVelocity);\r\n            }\r\n            resolve(object);\r\n        });\r\n    }\r\n}\r\n//# sourceMappingURL=AccelerationProcessingNode.js.map","import { FilterProcessingNode, Orientation } from '@openhps/core';\r\nexport class RelativeOrientationProcessingNode extends FilterProcessingNode {\r\n    initFilter(_, frame) {\r\n        return new Promise((resolve, reject) => {\r\n            if (!frame.angularVelocity || !frame.acceleration) {\r\n                return reject(new Error(`Relative rotation processing requires accelerometer and gyroscope readings!`));\r\n            }\r\n            resolve({\r\n                alpha: 0,\r\n                beta: 0,\r\n                gamma: 0,\r\n            });\r\n        });\r\n    }\r\n    filter(object, frame, filter) {\r\n        return new Promise((resolve) => {\r\n            const accl = frame.acceleration;\r\n            const gyro = object.getPosition().angularVelocity || frame.angularVelocity;\r\n            const bias = 0.98;\r\n            const dt = 1000 / frame.frequency;\r\n            const norm = Math.sqrt(Math.pow(accl.x, 2) + Math.pow(accl.y, 2) + Math.pow(accl.z, 2));\r\n            const scale = Math.PI / 2;\r\n            const alpha = filter.alpha + gyro.z * dt;\r\n            const beta = bias * (filter.beta + gyro.x * dt) + (1.0 - bias) * ((accl.x * scale) / norm);\r\n            const gamma = bias * (filter.gamma + gyro.y * dt) + (1.0 - bias) * ((accl.y * -scale) / norm);\r\n            frame.relativeOrientation = Orientation.fromEuler([beta, gamma, alpha]);\r\n            resolve(object);\r\n        });\r\n    }\r\n}\r\n//# sourceMappingURL=RelativeOrientationProcessingNode.js.map","import { FilterProcessingNode, Orientation } from '@openhps/core';\r\nexport class AbsoluteOrientationProcessingNode extends FilterProcessingNode {\r\n    initFilter(object, frame) {\r\n        return new Promise((resolve, reject) => {\r\n            if (frame.angularVelocity || frame.acceleration === undefined) {\r\n                reject(new Error(`Relative rotation processing requires accelerometer and gyroscope readings!`));\r\n            }\r\n            resolve({\r\n                alpha: 0,\r\n                beta: 0,\r\n                gamma: 0,\r\n            });\r\n        });\r\n    }\r\n    filter(object, frame) {\r\n        return new Promise((resolve) => {\r\n            const accl = frame.acceleration;\r\n            const mag = frame.magnetism;\r\n            const pitch = Math.atan2(-accl.x, Math.sqrt(accl.z * accl.z + accl.y * accl.y));\r\n            const roll = Math.atan2(accl.y, Math.sqrt(accl.z * accl.z + accl.x * accl.x));\r\n            const Xh = mag.x * Math.cos(pitch) +\r\n                mag.y * Math.sin(roll) * Math.sin(pitch) +\r\n                mag.z * Math.cos(roll) * Math.sin(pitch);\r\n            const Yh = mag.y * Math.cos(roll) - mag.z * Math.sin(roll);\r\n            let azimuth = Math.atan2(Yh, Xh);\r\n            if (azimuth < 0) {\r\n                azimuth = 2 * Math.PI + azimuth;\r\n            }\r\n            frame.absoluteOrientation = Orientation.fromEuler([pitch, roll, azimuth]);\r\n            resolve(object);\r\n        });\r\n    }\r\n}\r\n//# sourceMappingURL=AbsoluteOrientationProcessingNode.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __metadata = (this && this.__metadata) || function (k, v) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\r\n};\r\nimport { Acceleration, LinearVelocity, SerializableArrayMember, SerializableMember, SerializableObject, LinearVelocityUnit, Vector3, LengthUnit, ProcessingNode, } from '@openhps/core';\r\nexport class PedometerProcessingNode extends ProcessingNode {\r\n    constructor(options) {\r\n        super(options);\r\n        this.options.windowSize = this.options.windowSize || 1;\r\n        this.options.minPeak = this.options.minPeak || 2;\r\n        this.options.maxPeak = this.options.maxPeak || 8;\r\n        this.options.minStepTime = this.options.minStepTime || 0.3;\r\n        this.options.peakThreshold = this.options.peakThreshold || 0.5;\r\n        this.options.maxStepTime = this.options.maxStepTime || 0.8;\r\n        this.options.meanFilterSize = this.options.meanFilterSize || 1;\r\n        this.options.minConsecutiveSteps = this.options.minConsecutiveSteps || 3;\r\n        this.options.stepSize = this.options.stepSize || 0.7;\r\n    }\r\n    process(frame) {\r\n        return new Promise((resolve, reject) => {\r\n            let pedometerData;\r\n            this.getNodeData(frame.source)\r\n                .then((data) => {\r\n                if (!data) {\r\n                    data = new PedometerData();\r\n                }\r\n                data.add(frame);\r\n                const windowSize = Math.floor(this.options.windowSize * data.frequency);\r\n                if (data.accelerometerData.length > 4 * windowSize) {\r\n                    data.shift();\r\n                }\r\n                pedometerData = data;\r\n                return this.processPedometer(pedometerData);\r\n            })\r\n                .then((steps) => {\r\n                const previousStep = steps.indexOf(pedometerData.lastStepIndex);\r\n                if (previousStep !== -1) {\r\n                    steps = steps.slice(previousStep + 1);\r\n                }\r\n                if (steps.length > 0) {\r\n                    pedometerData.lastStepIndex = steps[steps.length - 1];\r\n                }\r\n                const stepCount = steps.length;\r\n                const distance = this.options.stepSize * stepCount;\r\n                const position = frame.source.getPosition();\r\n                position.timestamp = frame.createdTimestamp;\r\n                position.linearVelocity = new LinearVelocity(distance / this.options.windowSize, 0, 0, LinearVelocityUnit.METER_PER_SECOND);\r\n                const orientation = frame.absoluteOrientation || position.orientation;\r\n                if (orientation) {\r\n                    const relativePosition = Vector3.fromArray([distance / this.options.windowSize, 0, 0]);\r\n                    const eulerOrientation = orientation.toEuler();\r\n                    eulerOrientation.x = 0;\r\n                    eulerOrientation.y = 0;\r\n                    position.fromVector(position.toVector3(LengthUnit.METER).add(relativePosition.applyEuler(eulerOrientation)));\r\n                }\r\n                return this.setNodeData(frame.source, pedometerData);\r\n            })\r\n                .then(() => {\r\n                resolve(frame);\r\n            })\r\n                .catch(reject);\r\n        });\r\n    }\r\n    processPedometer(data) {\r\n        return new Promise((resolve) => {\r\n            const windowSize = Math.floor(this.options.windowSize * data.frequency);\r\n            const taoMin = this.options.minStepTime * data.frequency;\r\n            const taoMax = this.options.maxStepTime * data.frequency;\r\n            const verticalComponent = this._extractVerticalComponents(data.accelerometerData, data.attitudeData);\r\n            if (verticalComponent.length < windowSize) {\r\n                return resolve([]);\r\n            }\r\n            let smoothedVerticalComponent = verticalComponent;\r\n            if (this.options.meanFilterSize > 1) {\r\n                smoothedVerticalComponent = this._meanFilter(verticalComponent, this.options.meanFilterSize);\r\n            }\r\n            const window = verticalComponent.slice(0, windowSize);\r\n            let windowMax = Math.max(this.options.minPeak, Math.min(this.options.maxPeak, Math.max(...window)));\r\n            let windowSum = window.reduce((a, b) => a + b);\r\n            const windowAvg = windowSum / windowSize;\r\n            const offset = Math.ceil(windowSize / 2);\r\n            let steps = [];\r\n            let lastPeak = data.lastStepIndex;\r\n            for (let i = offset; i < verticalComponent.length - offset - 1; i++) {\r\n                if (verticalComponent[i] >\r\n                    Math.max(this.options.minPeak, this.options.peakThreshold * windowMax + windowAvg) &&\r\n                    smoothedVerticalComponent[i] >= smoothedVerticalComponent[i - 1] &&\r\n                    smoothedVerticalComponent[i] > smoothedVerticalComponent[i + 1] &&\r\n                    lastPeak < i - taoMin) {\r\n                    if (verticalComponent[i] < this.options.maxPeak)\r\n                        steps.push(i);\r\n                    lastPeak = i;\r\n                }\r\n                window.push(verticalComponent[i + offset]);\r\n                const removed = window.shift();\r\n                windowSum += verticalComponent[i + offset] - removed;\r\n                if (removed >= windowMax || verticalComponent[i + offset] > windowMax) {\r\n                    windowMax = Math.max(this.options.minPeak, Math.min(this.options.maxPeak, Math.max(...window)));\r\n                }\r\n            }\r\n            if (this.options.minConsecutiveSteps > 1) {\r\n                let consecutivePeaks = 1;\r\n                let i = steps.length;\r\n                while (i--) {\r\n                    if (i === 0 || steps[i] - steps[i - 1] < taoMax) {\r\n                        consecutivePeaks++;\r\n                    }\r\n                    else {\r\n                        if (consecutivePeaks < this.options.minConsecutiveSteps) {\r\n                            steps.splice(i, consecutivePeaks);\r\n                        }\r\n                        consecutivePeaks = 1;\r\n                    }\r\n                }\r\n                if (steps.length < this.options.minConsecutiveSteps) {\r\n                    steps = [];\r\n                }\r\n            }\r\n            resolve(steps);\r\n        });\r\n    }\r\n    _extractVerticalComponents(accelerometerData, attitudeData) {\r\n        return accelerometerData.map((acceleration, i) => {\r\n            const attitude = attitudeData[i].clone();\r\n            attitude.z = 0;\r\n            return acceleration.clone().applyEuler(attitude).getComponent(2);\r\n        });\r\n    }\r\n    _meanFilter(arr, size) {\r\n        const window = [];\r\n        return arr.map((val) => {\r\n            if (window.length >= size)\r\n                window.shift();\r\n            window.push(val);\r\n            return window.reduce((a, b) => a + b) / arr.length;\r\n        });\r\n    }\r\n}\r\nlet PedometerData = class PedometerData {\r\n    constructor() {\r\n        this.accelerometerData = [];\r\n        this.attitudeData = [];\r\n        this.lastStepIndex = -Infinity;\r\n    }\r\n    add(frame) {\r\n        this.accelerometerData.push(frame.linearAcceleration);\r\n        this.attitudeData.push(frame.absoluteOrientation.toEuler('ZYX'));\r\n        this.frequency = frame.frequency;\r\n        return this;\r\n    }\r\n    shift() {\r\n        this.lastStepIndex--;\r\n        this.accelerometerData.shift();\r\n        this.attitudeData.shift();\r\n        return this;\r\n    }\r\n};\r\n__decorate([\r\n    SerializableArrayMember(Acceleration),\r\n    __metadata(\"design:type\", Array)\r\n], PedometerData.prototype, \"accelerometerData\", void 0);\r\n__decorate([\r\n    SerializableArrayMember(Acceleration),\r\n    __metadata(\"design:type\", Array)\r\n], PedometerData.prototype, \"attitudeData\", void 0);\r\n__decorate([\r\n    SerializableMember(),\r\n    __metadata(\"design:type\", Number)\r\n], PedometerData.prototype, \"frequency\", void 0);\r\n__decorate([\r\n    SerializableMember(),\r\n    __metadata(\"design:type\", Object)\r\n], PedometerData.prototype, \"lastStepIndex\", void 0);\r\nPedometerData = __decorate([\r\n    SerializableObject()\r\n], PedometerData);\r\nexport { PedometerData };\r\n//# sourceMappingURL=PedometerProcessingNode.js.map","import { TimeService, TimeUnit, LengthUnit, LinearVelocityUnit, ObjectProcessingNode, LinearVelocity, } from '@openhps/core';\r\nexport class VelocityCalculationNode extends ObjectProcessingNode {\r\n    processObject(object) {\r\n        return new Promise((resolve, reject) => {\r\n            if (object.getPosition()) {\r\n                this.predictVelocity(object).then(resolve).catch(reject);\r\n            }\r\n            else {\r\n                resolve(object);\r\n            }\r\n        });\r\n    }\r\n    predictVelocity(object) {\r\n        return new Promise((resolve) => {\r\n            const service = this.model.findDataService(object);\r\n            const position = object.getPosition();\r\n            service\r\n                .findByUID(object.uid)\r\n                .then((existingObject) => {\r\n                const existingPosition = existingObject.getPosition();\r\n                const difference = position\r\n                    .toVector3(LengthUnit.METER)\r\n                    .sub(existingPosition.toVector3(LengthUnit.METER));\r\n                const timeDifference = TimeService.getUnit().convert(position.timestamp - existingPosition.timestamp, TimeUnit.SECOND);\r\n                difference.divideScalar(timeDifference);\r\n                position.linearVelocity = new LinearVelocity(difference.x, difference.y, difference.z, LinearVelocityUnit.METER_PER_SECOND);\r\n                resolve(object);\r\n            })\r\n                .catch(() => {\r\n                resolve(object);\r\n            });\r\n        });\r\n    }\r\n}\r\n//# sourceMappingURL=VelocityCalculationNode.js.map","import { TimeService, TimeUnit, LengthUnit, AngularVelocity, ObjectProcessingNode, LinearVelocity, Matrix4, Vector3, AxisAngle, Orientation, } from '@openhps/core';\r\nexport class VelocityProcessingNode extends ObjectProcessingNode {\r\n    processObject(object, frame) {\r\n        return new Promise((resolve, reject) => {\r\n            if (object.getPosition()) {\r\n                const lastPosition = object.getPosition();\r\n                if (lastPosition.linearVelocity || lastPosition.angularVelocity) {\r\n                    this.applyVelocity(object, frame).then(resolve).catch(reject);\r\n                }\r\n                else {\r\n                    resolve(object);\r\n                }\r\n            }\r\n            else {\r\n                resolve(object);\r\n            }\r\n        });\r\n    }\r\n    applyVelocity(object, frame) {\r\n        return new Promise((resolve) => {\r\n            const lastPosition = object.getPosition();\r\n            const deltaTime = TimeService.getUnit().convert(frame.createdTimestamp - lastPosition.timestamp, TimeUnit.SECOND);\r\n            if (deltaTime < 0) {\r\n                return resolve(object);\r\n            }\r\n            const linear = lastPosition.linearVelocity || new LinearVelocity();\r\n            const angular = lastPosition.angularVelocity || new AngularVelocity();\r\n            const linearMovement = linear.clone().multiplyScalar(deltaTime);\r\n            const angularMovement = angular.clone().multiplyScalar(deltaTime);\r\n            const relativePosition = Vector3.fromArray([0, 0, 0]);\r\n            if (angular.equals(Vector3.fromArray([0, 0, 0]))) {\r\n                relativePosition.applyMatrix4(new Matrix4().makeTranslation(linearMovement.x, linearMovement.y, linearMovement.z));\r\n            }\r\n            else if (!linear.equals(Vector3.fromArray([0, 0, 0]))) {\r\n                const rX = linear.clone().divideScalar(angular.x === 0 ? 1 : angular.x);\r\n                const rY = linear.clone().divideScalar(angular.y === 0 ? 1 : angular.y);\r\n                const rZ = linear.clone().divideScalar(angular.z === 0 ? 1 : angular.z);\r\n                const rMin = rX.min(rY).min(rZ);\r\n                relativePosition.applyMatrix4(new Matrix4().makeTranslation(-rMin.x, -rMin.y, -rMin.z));\r\n                relativePosition.applyMatrix4(new AxisAngle(angularMovement.x, angularMovement.y, angularMovement.z).toRotationMatrix());\r\n                relativePosition.applyMatrix4(new Matrix4().makeTranslation(rMin.x, rMin.y, rMin.z));\r\n                relativePosition.applyMatrix4(Matrix4.rotationFromAxisAngle(new Vector3(angular.x !== 0 ? 1 : 0, angular.y !== 0 ? 1 : 0, angular.z !== 0 ? 1 : 0), Math.PI / 2));\r\n            }\r\n            const newPosition = lastPosition.clone();\r\n            if (!newPosition.orientation) {\r\n                newPosition.orientation = new Orientation();\r\n            }\r\n            newPosition.timestamp = frame.createdTimestamp;\r\n            newPosition.fromVector(newPosition.toVector3(LengthUnit.METER).add(relativePosition.applyQuaternion(newPosition.orientation)), LengthUnit.METER);\r\n            const newOrientation = newPosition.orientation.toEuler().toVector3().add(angular.multiplyScalar(deltaTime));\r\n            newPosition.orientation = Orientation.fromEuler(newOrientation);\r\n            object.setPosition(newPosition);\r\n            resolve(object);\r\n        });\r\n    }\r\n}\r\n//# sourceMappingURL=VelocityProcessingNode.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __metadata = (this && this.__metadata) || function (k, v) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\r\n};\r\nimport { SerializableObject, SerializableMember, DataFrame, Magnetism, Acceleration, LinearVelocity, AngularVelocity, Orientation, } from '@openhps/core';\r\nlet IMUDataFrame = class IMUDataFrame extends DataFrame {\r\n};\r\n__decorate([\r\n    SerializableMember(),\r\n    __metadata(\"design:type\", Number)\r\n], IMUDataFrame.prototype, \"frequency\", void 0);\r\n__decorate([\r\n    SerializableMember(),\r\n    __metadata(\"design:type\", Magnetism)\r\n], IMUDataFrame.prototype, \"magnetism\", void 0);\r\n__decorate([\r\n    SerializableMember(),\r\n    __metadata(\"design:type\", Acceleration)\r\n], IMUDataFrame.prototype, \"acceleration\", void 0);\r\n__decorate([\r\n    SerializableMember(),\r\n    __metadata(\"design:type\", Acceleration)\r\n], IMUDataFrame.prototype, \"linearAcceleration\", void 0);\r\n__decorate([\r\n    SerializableMember(),\r\n    __metadata(\"design:type\", Acceleration)\r\n], IMUDataFrame.prototype, \"gravity\", void 0);\r\n__decorate([\r\n    SerializableMember(),\r\n    __metadata(\"design:type\", Orientation)\r\n], IMUDataFrame.prototype, \"relativeOrientation\", void 0);\r\n__decorate([\r\n    SerializableMember(),\r\n    __metadata(\"design:type\", Orientation)\r\n], IMUDataFrame.prototype, \"absoluteOrientation\", void 0);\r\n__decorate([\r\n    SerializableMember(),\r\n    __metadata(\"design:type\", LinearVelocity)\r\n], IMUDataFrame.prototype, \"linearVelocity\", void 0);\r\n__decorate([\r\n    SerializableMember(),\r\n    __metadata(\"design:type\", AngularVelocity)\r\n], IMUDataFrame.prototype, \"angularVelocity\", void 0);\r\nIMUDataFrame = __decorate([\r\n    SerializableObject()\r\n], IMUDataFrame);\r\nexport { IMUDataFrame };\r\n//# sourceMappingURL=IMUDataFrame.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __metadata = (this && this.__metadata) || function (k, v) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\r\n};\r\nimport { SerializableObject, SerializableMember, DataObject, Magnetism, Acceleration } from '@openhps/core';\r\nlet IMUSensorObject = class IMUSensorObject extends DataObject {\r\n};\r\n__decorate([\r\n    SerializableMember(),\r\n    __metadata(\"design:type\", Number)\r\n], IMUSensorObject.prototype, \"frequency\", void 0);\r\n__decorate([\r\n    SerializableMember(),\r\n    __metadata(\"design:type\", Magnetism)\r\n], IMUSensorObject.prototype, \"magnetism\", void 0);\r\n__decorate([\r\n    SerializableMember(),\r\n    __metadata(\"design:type\", Acceleration)\r\n], IMUSensorObject.prototype, \"acceleration\", void 0);\r\n__decorate([\r\n    SerializableMember(),\r\n    __metadata(\"design:type\", Acceleration)\r\n], IMUSensorObject.prototype, \"linearAcceleration\", void 0);\r\n__decorate([\r\n    SerializableMember(),\r\n    __metadata(\"design:type\", Acceleration)\r\n], IMUSensorObject.prototype, \"gravity\", void 0);\r\nIMUSensorObject = __decorate([\r\n    SerializableObject()\r\n], IMUSensorObject);\r\nexport { IMUSensorObject };\r\n//# sourceMappingURL=IMUSensorObject.js.map","import { Acceleration, AngularVelocity, Orientation, SourceNode } from '@openhps/core';\r\nimport { IMUDataFrame } from '../../data';\r\nexport class IMUBrowserSource extends SourceNode {\r\n    constructor(options) {\r\n        super(options);\r\n        this.once('build', this._onReady.bind(this));\r\n    }\r\n    _onReady() {\r\n        window.addEventListener('devicemotion', (event) => {\r\n            const dataFrame = new IMUDataFrame();\r\n            dataFrame.acceleration = new Acceleration(event.accelerationIncludingGravity.x, event.accelerationIncludingGravity.y, event.accelerationIncludingGravity.z);\r\n            dataFrame.angularVelocity = new AngularVelocity(event.rotationRate.beta, event.rotationRate.gamma, event.rotationRate.alpha);\r\n            dataFrame.linearAcceleration = new Acceleration(event.acceleration.x, event.acceleration.y, event.acceleration.z);\r\n            const source = this.source;\r\n            source.frequency = 1000 / event.interval;\r\n            source.getPosition().angularVelocity = dataFrame.angularVelocity;\r\n            dataFrame.absoluteOrientation = source.getPosition().orientation;\r\n            dataFrame.source = source;\r\n            dataFrame.frequency = source.frequency;\r\n            this.push(dataFrame);\r\n        }, true);\r\n        window.addEventListener('deviceorientation', (event) => {\r\n            const source = this.source;\r\n            source.getPosition().orientation = Orientation.fromEuler([event.beta, event.gamma, event.alpha]);\r\n        });\r\n        this.logger('debug', {\r\n            message: 'Browser orientation and motion events registered!',\r\n        });\r\n    }\r\n    onPull() {\r\n        return new Promise((resolve) => {\r\n            resolve(undefined);\r\n        });\r\n    }\r\n}\r\n//# sourceMappingURL=IMUBrowserSource.js.map"],"names":["__webpack_require__","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","y","x","d","__WEBPACK_EXTERNAL_MODULE__openhps_core_es_min_js_27733f5f__","Acceleration","AccelerationUnit","AngularVelocity","AxisAngle","DataFrame","DataObject","FilterProcessingNode","LengthUnit","LinearVelocity","LinearVelocityUnit","Magnetism","Matrix4","ObjectProcessingNode","Orientation","ProcessingNode","SerializableArrayMember","SerializableMember","SerializableObject","SourceNode","TimeService","TimeUnit","Vector3","GravityProcessingMethod","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","apply","MagnetometerCalibrationNode","constructor","options","super","processObject","object","frame","this","getNodeData","calibrationData","undefined","xMax","xMin","yMax","yMin","zMax","zMin","count","scaleX","NaN","scaleY","scaleZ","isNaN","Math","max","magnetism","min","z","setNodeData","avgDeltaX","avgDeltaY","avgDeltaZ","avgDelta","catch","AccelerationProcessingNode","initFilter","acceleration","linearAcceleration","Error","alpha","beta","gamma","filter","accl","dt","frequency","linearVelocity","clone","multiplyScalar","toArray","position","getPosition","add","RelativeOrientationProcessingNode","_","angularVelocity","gyro","bias","norm","sqrt","pow","scale","PI","relativeOrientation","GravityProcessingNode","method","LOW_PASS","LINEAR_ACCELERATION","RELATIVE_ORIENTATION","absoluteOrientation","ABSOLUTE_ORIENTATION","_fromLinearAcceleration","_usingLPFilter","_fromAbsoluteOrientation","_fromRelativeOrientation","gravity","sub","multiply","toEuler","toVector3","applyQuaternion","AbsoluteOrientationProcessingNode","mag","pitch","atan2","roll","Xh","cos","sin","Yh","azimuth","__decorate","decorators","target","desc","c","arguments","length","r","getOwnPropertyDescriptor","Reflect","decorate","i","__metadata","k","v","metadata","PedometerProcessingNode","windowSize","minPeak","maxPeak","minStepTime","peakThreshold","maxStepTime","meanFilterSize","minConsecutiveSteps","stepSize","process","pedometerData","source","data","PedometerData","floor","accelerometerData","shift","processPedometer","steps","previousStep","indexOf","lastStepIndex","slice","stepCount","distance","timestamp","createdTimestamp","orientation","relativePosition","eulerOrientation","fromVector","applyEuler","taoMin","taoMax","verticalComponent","_extractVerticalComponents","attitudeData","smoothedVerticalComponent","_meanFilter","window","windowMax","windowSum","reduce","a","b","windowAvg","offset","ceil","lastPeak","push","removed","consecutivePeaks","splice","map","attitude","getComponent","arr","size","val","Infinity","Array","Number","VelocityCalculationNode","predictVelocity","service","model","findDataService","findByUID","uid","existingObject","existingPosition","difference","timeDifference","convert","divideScalar","VelocityProcessingNode","lastPosition","applyVelocity","deltaTime","linear","angular","linearMovement","angularMovement","equals","applyMatrix4","makeTranslation","rX","rY","rZ","rMin","toRotationMatrix","newPosition","newOrientation","setPosition","IMUDataFrame","IMUSensorObject","IMUBrowserSource","once","_onReady","bind","addEventListener","event","dataFrame","accelerationIncludingGravity","rotationRate","interval","logger","message","onPull"],"sourceRoot":""}